[0m13:26:26.567228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796d43ed4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796d44d3e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796d44d3e500>]}


============================== 13:26:26.571077 | 32238258-9d6f-494c-bd78-b0ead9be83d0 ==============================
[0m13:26:26.571077 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:26:26.571800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:26.573552 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/peon/.dbt/profiles.yml
  
[0m13:26:26.575247 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.08151479, "process_in_blocks": "47784", "process_kernel_time": 0.15251, "process_mem_max_rss": "86716", "process_out_blocks": "8", "process_user_time": 1.511237}
[0m13:26:26.576010 [debug] [MainThread]: Command `dbt test` failed at 13:26:26.575873 after 0.08 seconds
[0m13:26:26.576599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796d43ed4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796d44d3ee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x796d44d3e5c0>]}
[0m13:26:26.577265 [debug] [MainThread]: Flushing usage events
[0m13:26:27.584457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:04.654394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec024998df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec02583e4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec02583e440>]}


============================== 13:27:04.657633 | 664bc834-2b11-4321-9ef9-864b8dc07c48 ==============================
[0m13:27:04.657633 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:27:04.658527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:27:04.660349 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt cannot run because no profile was specified for this dbt project.
  To specify a profile for this project, add a line like the this to
  your dbt_project.yml file:
  
  profile: [profile name]
  
  Here, [profile name] should be replaced with a profile name
  defined in your profiles.yml file. You can find profiles.yml here:
  
  /home/peon/.dbt/profiles.yml
  
[0m13:27:04.661663 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.07892448, "process_in_blocks": "0", "process_kernel_time": 0.086973, "process_mem_max_rss": "86656", "process_out_blocks": "16", "process_user_time": 1.468553}
[0m13:27:04.662314 [debug] [MainThread]: Command `dbt test` failed at 13:27:04.662206 after 0.08 seconds
[0m13:27:04.662822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec024998df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec02583ece0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec02583e500>]}
[0m13:27:04.663423 [debug] [MainThread]: Flushing usage events
[0m13:27:05.473718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:39.808088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a798098eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a798f425c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a798f42560>]}


============================== 13:27:39.811360 | 773354cd-f961-4f3f-9837-a6cd9ff65dc2 ==============================
[0m13:27:39.811360 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:27:39.812123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:27:39.816271 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:27:39.817578 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.08105732, "process_in_blocks": "0", "process_kernel_time": 0.087017, "process_mem_max_rss": "86784", "process_out_blocks": "8", "process_user_time": 1.461293}
[0m13:27:39.818440 [debug] [MainThread]: Command `dbt test` failed at 13:27:39.818243 after 0.08 seconds
[0m13:27:39.819086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a798098eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a798f42110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a798f411e0>]}
[0m13:27:39.819761 [debug] [MainThread]: Flushing usage events
[0m13:27:41.010455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:38.244255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75be41298e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75be42142530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75be421424d0>]}


============================== 13:28:38.247770 | b92ffc0a-db26-48b2-a4e1-2e8ecf51fbcd ==============================
[0m13:28:38.247770 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:28:38.248535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:28:38.252731 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:28:38.253998 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.08210393, "process_in_blocks": "0", "process_kernel_time": 0.086982, "process_mem_max_rss": "86708", "process_out_blocks": "16", "process_user_time": 1.460699}
[0m13:28:38.254873 [debug] [MainThread]: Command `dbt test` failed at 13:28:38.254689 after 0.08 seconds
[0m13:28:38.255538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75be41298e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75be42142110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75be421411e0>]}
[0m13:28:38.256212 [debug] [MainThread]: Flushing usage events
[0m13:28:39.066666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:24.353722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764402194e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76440306a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76440306a350>]}


============================== 13:29:24.357011 | d7330d99-9991-4d39-b753-1aa5e94f10c3 ==============================
[0m13:29:24.357011 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:29:24.357914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:29:24.362040 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:29:24.363531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.08229984, "process_in_blocks": "0", "process_kernel_time": 0.090956, "process_mem_max_rss": "86704", "process_out_blocks": "8", "process_user_time": 1.464302}
[0m13:29:24.364401 [debug] [MainThread]: Command `dbt run` failed at 13:29:24.364163 after 0.08 seconds
[0m13:29:24.365105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764402194e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76440306b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7644030691e0>]}
[0m13:29:24.365815 [debug] [MainThread]: Flushing usage events
[0m13:29:25.249108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:27.088363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7741e5c60e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7741e6b363e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7741e6b36380>]}


============================== 13:30:27.091559 | 483c85cd-0e39-4975-bd1e-4e7aac5bc305 ==============================
[0m13:30:27.091559 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:30:27.092367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:30:27.096506 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:30:27.097765 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.081963815, "process_in_blocks": "0", "process_kernel_time": 0.071013, "process_mem_max_rss": "86828", "process_out_blocks": "8", "process_user_time": 1.478282}
[0m13:30:27.098620 [debug] [MainThread]: Command `dbt run` failed at 13:30:27.098432 after 0.08 seconds
[0m13:30:27.099234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7741e5c60e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7741e6b37460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7741e6b351e0>]}
[0m13:30:27.099928 [debug] [MainThread]: Flushing usage events
[0m13:30:28.020700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:41.241493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6a5ed4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6a6d3e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6a6d3e500>]}


============================== 13:31:41.244752 | 239be3b4-b514-4087-a343-8b110969aa2f ==============================
[0m13:31:41.244752 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:31:41.245527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:31:41.249688 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:31:41.250992 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.081348225, "process_in_blocks": "0", "process_kernel_time": 0.097934, "process_mem_max_rss": "86740", "process_out_blocks": "16", "process_user_time": 1.457025}
[0m13:31:41.251780 [debug] [MainThread]: Command `dbt test` failed at 13:31:41.251628 after 0.08 seconds
[0m13:31:41.252489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6a5ed4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6a6d3e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6a6d3d210>]}
[0m13:31:41.253164 [debug] [MainThread]: Flushing usage events
[0m13:31:42.055329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:28.383054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295abdd4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295acc3e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295acc3e560>]}


============================== 13:32:28.386308 | 18960fae-81ea-472c-b7a4-1e9d2c534e5a ==============================
[0m13:32:28.386308 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:32:28.387092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:28.391258 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:32:28.392595 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.080999956, "process_in_blocks": "0", "process_kernel_time": 0.073999, "process_mem_max_rss": "86840", "process_out_blocks": "8", "process_user_time": 1.483986}
[0m13:32:28.393460 [debug] [MainThread]: Command `dbt test` failed at 13:32:28.393257 after 0.08 seconds
[0m13:32:28.394103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295abdd4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295acc3e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7295acc3d1e0>]}
[0m13:32:28.394857 [debug] [MainThread]: Flushing usage events
[0m13:32:29.364628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:37.452815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd92f94ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd93e3e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd93e3e590>]}


============================== 13:33:37.456078 | 4c0f81dd-c35e-4055-bf06-92c68f063d19 ==============================
[0m13:33:37.456078 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:33:37.456990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/.dbt', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:33:37.461120 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:33:37.462600 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.08201804, "process_in_blocks": "0", "process_kernel_time": 0.086006, "process_mem_max_rss": "86836", "process_out_blocks": "16", "process_user_time": 1.48712}
[0m13:33:37.463478 [debug] [MainThread]: Command `dbt test` failed at 13:33:37.463240 after 0.08 seconds
[0m13:33:37.464122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd92f94ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd93e3e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74fd93e3d1e0>]}
[0m13:33:37.464969 [debug] [MainThread]: Flushing usage events
[0m13:33:38.280808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:13.438345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e352dfd4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e352ee3e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e352ee3e500>]}


============================== 13:34:13.441620 | 4a17507a-1d8b-4238-9ac0-c8f8f1185792 ==============================
[0m13:34:13.441620 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:34:13.442449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:34:13.446623 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:34:13.448014 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.081670135, "process_in_blocks": "0", "process_kernel_time": 0.09296, "process_mem_max_rss": "86736", "process_out_blocks": "8", "process_user_time": 1.467375}
[0m13:34:13.448804 [debug] [MainThread]: Command `dbt test` failed at 13:34:13.448655 after 0.08 seconds
[0m13:34:13.449468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e352dfd4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e352ee3e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e352ee3d210>]}
[0m13:34:13.450179 [debug] [MainThread]: Flushing usage events
[0m13:34:14.325007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:20.848474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71563f15ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715640006530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715640006500>]}


============================== 13:35:20.852083 | b23eca45-aecd-4cf8-ac1d-4bb213f7841b ==============================
[0m13:35:20.852083 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:35:20.852965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:35:20.857327 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:35:20.858742 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.0827813, "process_in_blocks": "0", "process_kernel_time": 0.091107, "process_mem_max_rss": "86696", "process_out_blocks": "16", "process_user_time": 1.463729}
[0m13:35:20.859894 [debug] [MainThread]: Command `dbt test` failed at 13:35:20.859669 after 0.08 seconds
[0m13:35:20.860794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71563f15ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715640006110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7156400051e0>]}
[0m13:35:20.861740 [debug] [MainThread]: Flushing usage events
[0m13:35:21.806727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:26.683974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddef98d4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddefa73e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddefa73e500>]}


============================== 13:35:26.687453 | 982daf33-954c-4ff5-bcc5-6f92c2b64a42 ==============================
[0m13:35:26.687453 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:35:26.688210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:26.692119 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'investment_wallet' does not have a target named 'dev'. The valid target names for this profile are:
   - local
[0m13:35:26.693464 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.08278238, "process_in_blocks": "0", "process_kernel_time": 0.082956, "process_mem_max_rss": "86828", "process_out_blocks": "8", "process_user_time": 1.48722}
[0m13:35:26.694247 [debug] [MainThread]: Command `dbt test` failed at 13:35:26.694079 after 0.08 seconds
[0m13:35:26.694911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddef98d4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddefa73e140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ddefa73d210>]}
[0m13:35:26.695574 [debug] [MainThread]: Flushing usage events
[0m13:35:27.540943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:50.647180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b51008ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b510f36560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b510f36500>]}


============================== 13:36:50.650438 | a8f6887e-3fc9-45a1-ac3a-c2c072275824 ==============================
[0m13:36:50.650438 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:36:50.651374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:50.885387 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', '+materialized': 'bronze'}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m13:36:50.886737 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.31110027, "process_in_blocks": "9592", "process_kernel_time": 0.111095, "process_mem_max_rss": "92248", "process_out_blocks": "8", "process_user_time": 1.597375}
[0m13:36:50.887423 [debug] [MainThread]: Command `dbt test` failed at 13:36:50.887296 after 0.31 seconds
[0m13:36:50.887935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b51008ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b510f36ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b50f383be0>]}
[0m13:36:50.888481 [debug] [MainThread]: Flushing usage events
[0m13:36:51.921289 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:08.978568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da295cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da3806470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da3806410>]}


============================== 20:57:08.983108 | 6f6ab0d4-b8ed-435c-b6d6-87b7053f6738 ==============================
[0m20:57:08.983108 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:57:08.984212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:57:09.190057 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', '+materialized': 'bronze'}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m20:57:09.191868 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3179306, "process_in_blocks": "0", "process_kernel_time": 0.124976, "process_mem_max_rss": "92488", "process_out_blocks": "8", "process_user_time": 2.348566}
[0m20:57:09.192832 [debug] [MainThread]: Command `dbt test` failed at 20:57:09.192667 after 0.32 seconds
[0m20:57:09.193599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da295cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da37a6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2da1366c80>]}
[0m20:57:09.194392 [debug] [MainThread]: Flushing usage events
[0m20:57:10.080845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:59:15.957026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71518bed4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71518cd3e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71518cd3e560>]}


============================== 20:59:15.961528 | ab185e5d-1791-4cb5-b7dc-e9296f49c4f4 ==============================
[0m20:59:15.961528 [info ] [MainThread]: Running with dbt=1.9.2
[0m20:59:15.962616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:59:16.167310 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', '+materialized': 'bronze'}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m20:59:16.169092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.31787667, "process_in_blocks": "0", "process_kernel_time": 0.141037, "process_mem_max_rss": "92428", "process_out_blocks": "16", "process_user_time": 2.390629}
[0m20:59:16.170058 [debug] [MainThread]: Command `dbt test` failed at 20:59:16.169888 after 0.32 seconds
[0m20:59:16.170796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71518bed4eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71518b243910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71518cd3ef20>]}
[0m20:59:16.171581 [debug] [MainThread]: Flushing usage events
[0m20:59:17.060407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:27.434787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcef94dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcfe3e470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcfe3e410>]}


============================== 21:31:27.439777 | 1e44893d-6d40-442e-aae3-6fabf732168a ==============================
[0m21:31:27.439777 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:31:27.440867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:27.645770 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', 'config': {'materialized': 'table'}}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m21:31:27.647543 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3175055, "process_in_blocks": "0", "process_kernel_time": 0.130975, "process_mem_max_rss": "92276", "process_out_blocks": "16", "process_user_time": 2.397556}
[0m21:31:27.648479 [debug] [MainThread]: Command `dbt test` failed at 21:31:27.648307 after 0.32 seconds
[0m21:31:27.649228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcef94dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcfdde530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcd96ac80>]}
[0m21:31:27.649986 [debug] [MainThread]: Flushing usage events
[0m21:31:28.461427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:50.058307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a229b5cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a22aa06470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a22aa06410>]}


============================== 21:48:50.063142 | 3578180e-11c3-45ad-922f-df4bf7019571 ==============================
[0m21:48:50.063142 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:48:50.064357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:50.270331 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', 'config': {'materialized': 'table'}}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m21:48:50.272106 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.31952342, "process_in_blocks": "0", "process_kernel_time": 0.141915, "process_mem_max_rss": "92476", "process_out_blocks": "16", "process_user_time": 2.399575}
[0m21:48:50.273059 [debug] [MainThread]: Command `dbt test` failed at 21:48:50.272890 after 0.32 seconds
[0m21:48:50.273808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a229b5cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a22a9a6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72a228562c80>]}
[0m21:48:50.274592 [debug] [MainThread]: Flushing usage events
[0m21:48:51.380637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:09.041490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736bdfed4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736be0d3e530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736be0d3e4d0>]}


============================== 21:50:09.046159 | 5fac1376-ae2c-4fe5-939a-9d03f53e002d ==============================
[0m21:50:09.046159 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:50:09.047241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:50:09.258276 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', 'config': {'materialized': 'table'}}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m21:50:09.260050 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3241347, "process_in_blocks": "0", "process_kernel_time": 0.14293, "process_mem_max_rss": "92340", "process_out_blocks": "8", "process_user_time": 2.392831}
[0m21:50:09.261028 [debug] [MainThread]: Command `dbt test` failed at 21:50:09.260854 after 0.33 seconds
[0m21:50:09.261773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736bdfed4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736be0d5a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x736be0cde590>]}
[0m21:50:09.262549 [debug] [MainThread]: Flushing usage events
[0m21:50:10.127770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:42.882775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797548194eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79754903e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79754903e560>]}


============================== 21:51:42.887766 | 8b51e1dd-4e40-4f9e-b74a-a1ebc0475ff8 ==============================
[0m21:51:42.887766 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:51:42.888924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:51:43.099436 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging', 'description': 'its the staging area for all the data;', 'config': {'materialized': 'table'}}] is not of type 'object'

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m21:51:43.101275 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.32357073, "process_in_blocks": "0", "process_kernel_time": 0.145981, "process_mem_max_rss": "92352", "process_out_blocks": "8", "process_user_time": 2.465683}
[0m21:51:43.102245 [debug] [MainThread]: Command `dbt test` failed at 21:51:43.102081 after 0.32 seconds
[0m21:51:43.102977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797548194eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79754750b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79754903ef20>]}
[0m21:51:43.103754 [debug] [MainThread]: Flushing usage events
[0m21:51:44.131115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:56.372810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7036c21d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7036c303e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7036c303e500>]}


============================== 21:53:56.377346 | 91c56254-fa4e-4964-956c-3f840334fb91 ==============================
[0m21:53:56.377346 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:53:56.378425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:53:56.662400 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['version']: '2' is not valid under any of the given schemas

Error encountered in /home/peon/projects/b3_new/dbt_project.yml
[0m21:53:56.664135 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.3969558, "process_in_blocks": "0", "process_kernel_time": 0.144974, "process_mem_max_rss": "93752", "process_out_blocks": "16", "process_user_time": 2.433571}
[0m21:53:56.665060 [debug] [MainThread]: Command `dbt test` failed at 21:53:56.664895 after 0.40 seconds
[0m21:53:56.665786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7036c21d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7036c0b95c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7036c0b967d0>]}
[0m21:53:56.666549 [debug] [MainThread]: Flushing usage events
[0m21:53:57.558217 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:39.468080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017efa1ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017f0896530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017f08964d0>]}


============================== 21:56:39.472631 | f2637a79-73c3-441f-87fe-293bd986431b ==============================
[0m21:56:39.472631 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:56:39.473703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:39.780201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2637a79-73c3-441f-87fe-293bd986431b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017f08b3220>]}
[0m21:56:39.890496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2637a79-73c3-441f-87fe-293bd986431b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017f08b22c0>]}
[0m21:56:39.894560 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:56:40.099030 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:56:40.100303 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:56:40.101051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2637a79-73c3-441f-87fe-293bd986431b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017ee3044f0>]}
[0m21:56:42.238964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m21:56:42.265433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2637a79-73c3-441f-87fe-293bd986431b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017ee34d240>]}
[0m21:56:42.425099 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m21:56:42.431993 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m21:56:42.486624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2637a79-73c3-441f-87fe-293bd986431b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017edd78f70>]}
[0m21:56:42.487594 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m21:56:42.488298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2637a79-73c3-441f-87fe-293bd986431b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017edcde6b0>]}
[0m21:56:42.490827 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:56:42.491927 [debug] [MainThread]: Command end result
[0m21:56:42.530753 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m21:56:42.533218 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m21:56:42.539062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m21:56:42.540789 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1772673, "process_in_blocks": "4480", "process_kernel_time": 0.262033, "process_mem_max_rss": "105244", "process_out_blocks": "2496", "process_user_time": 5.092645}
[0m21:56:42.541765 [debug] [MainThread]: Command `dbt test` succeeded at 21:56:42.541590 after 3.18 seconds
[0m21:56:42.542520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017efa1ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017f08b3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017ef8dd330>]}
[0m21:56:42.543281 [debug] [MainThread]: Flushing usage events
[0m21:56:43.447379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:59:10.752716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd4e98eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd5d6e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd5d6e350>]}


============================== 21:59:10.757625 | 41bc1089-8e45-4e0a-931a-704032853895 ==============================
[0m21:59:10.757625 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:59:10.758710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:59:11.062312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd41c92a0>]}
[0m21:59:11.172636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd45afac0>]}
[0m21:59:11.174019 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:59:11.366299 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:59:11.585395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:59:11.586155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:59:11.597799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m21:59:11.668349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd3259fc0>]}
[0m21:59:11.827020 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m21:59:11.833226 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m21:59:11.852885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd3899f30>]}
[0m21:59:11.853909 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m21:59:11.854743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd38995d0>]}
[0m21:59:11.857492 [info ] [MainThread]: 
[0m21:59:11.858383 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m21:59:11.859131 [info ] [MainThread]: 
[0m21:59:11.860421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:59:11.862824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m21:59:11.936929 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m21:59:11.937747 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m21:59:11.938623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:11.977542 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m21:59:11.980645 [debug] [ThreadPool]: On list_foo: Close
[0m21:59:11.983082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m21:59:11.995701 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m21:59:11.996529 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m21:59:11.997155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:12.009690 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m21:59:12.010987 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m21:59:12.011820 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:59:12.020944 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m21:59:12.024561 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m21:59:12.025679 [debug] [ThreadPool]: On list_foo_public: Close
[0m21:59:12.035185 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.035995 [debug] [MainThread]: On master: BEGIN
[0m21:59:12.036659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:59:12.049634 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m21:59:12.050802 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.051609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:59:12.058234 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m21:59:12.061428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd326a7a0>]}
[0m21:59:12.062346 [debug] [MainThread]: On master: ROLLBACK
[0m21:59:12.063392 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.064091 [debug] [MainThread]: On master: BEGIN
[0m21:59:12.065352 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m21:59:12.066073 [debug] [MainThread]: On master: COMMIT
[0m21:59:12.066777 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.067428 [debug] [MainThread]: On master: COMMIT
[0m21:59:12.068414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:12.069137 [debug] [MainThread]: On master: Close
[0m21:59:12.073218 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m21:59:12.074380 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m21:59:12.075414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m21:59:12.076204 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m21:59:12.091920 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m21:59:12.093310 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m21:59:12.171643 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m21:59:12.173128 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m21:59:12.173934 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m21:59:12.174669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:12.187332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m21:59:12.188521 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m21:59:12.189406 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
from public.b3_raw_ops
FROM 
source;
  );
[0m21:59:12.190800 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 22: FROM 
         ^

[0m21:59:12.191645 [debug] [Thread-1 (]: On model.b3_new.staging: ROLLBACK
[0m21:59:12.192898 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m21:59:12.202038 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "FROM"
  LINE 22: FROM 
           ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m21:59:12.205421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41bc1089-8e45-4e0a-931a-704032853895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd5172710>]}
[0m21:59:12.206751 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging ............................ [[31mERROR[0m in 0.13s]
[0m21:59:12.207928 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m21:59:12.209053 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "FROM"
  LINE 22: FROM 
           ^
  compiled code at target/run/b3_new/models/staging/staging.sql.
[0m21:59:12.211954 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.212812 [debug] [MainThread]: On master: BEGIN
[0m21:59:12.213800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:59:12.226292 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m21:59:12.227330 [debug] [MainThread]: On master: COMMIT
[0m21:59:12.228279 [debug] [MainThread]: Using postgres connection "master"
[0m21:59:12.228943 [debug] [MainThread]: On master: COMMIT
[0m21:59:12.229934 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:59:12.230677 [debug] [MainThread]: On master: Close
[0m21:59:12.231663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:12.232386 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m21:59:12.233112 [info ] [MainThread]: 
[0m21:59:12.233877 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:59:12.235212 [debug] [MainThread]: Command end result
[0m21:59:12.273618 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m21:59:12.276550 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m21:59:12.288902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m21:59:12.289686 [info ] [MainThread]: 
[0m21:59:12.290595 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:59:12.291411 [info ] [MainThread]: 
[0m21:59:12.292217 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "FROM"
  LINE 22: FROM 
           ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m21:59:12.292907 [info ] [MainThread]: 
[0m21:59:12.293648 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:59:12.295201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6478283, "process_in_blocks": "5896", "process_kernel_time": 0.256855, "process_mem_max_rss": "110508", "process_out_blocks": "1712", "process_user_time": 3.521021}
[0m21:59:12.296303 [debug] [MainThread]: Command `dbt run` failed at 21:59:12.296033 after 1.65 seconds
[0m21:59:12.297221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd4e98eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd45afac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707cd4d5cca0>]}
[0m21:59:12.298058 [debug] [MainThread]: Flushing usage events
[0m21:59:13.157736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:48.735813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49f660dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b4a0536320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b4a05362c0>]}


============================== 22:02:48.740349 | 19a46146-fbfa-4759-87d8-e7348e36b227 ==============================
[0m22:02:48.740349 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:02:48.741451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:02:49.049109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49e3e3580>]}
[0m22:02:49.161138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49ee4cb20>]}
[0m22:02:49.162548 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:02:49.356970 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:02:49.576441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:49.577203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:49.588944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m22:02:49.659256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49d94ded0>]}
[0m22:02:49.818044 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:02:49.823810 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:02:49.841048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49dea7070>]}
[0m22:02:49.842054 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m22:02:49.842789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b4a0536410>]}
[0m22:02:49.845509 [info ] [MainThread]: 
[0m22:02:49.846329 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m22:02:49.847040 [info ] [MainThread]: 
[0m22:02:49.848075 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:02:49.850396 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:02:49.934821 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:02:49.935696 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:02:49.936409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:49.953527 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m22:02:49.956260 [debug] [ThreadPool]: On list_foo: Close
[0m22:02:49.958981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m22:02:49.971420 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:02:49.972220 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m22:02:49.972884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:49.984817 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m22:02:49.986308 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:02:49.987601 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:02:49.991959 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:02:49.995515 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m22:02:49.996514 [debug] [ThreadPool]: On list_foo_public: Close
[0m22:02:50.006121 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:50.007003 [debug] [MainThread]: On master: BEGIN
[0m22:02:50.007759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:50.020257 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:02:50.021177 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:50.021946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:02:50.029125 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m22:02:50.031935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49d94d1e0>]}
[0m22:02:50.032854 [debug] [MainThread]: On master: ROLLBACK
[0m22:02:50.033870 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:50.034591 [debug] [MainThread]: On master: BEGIN
[0m22:02:50.035889 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:02:50.036736 [debug] [MainThread]: On master: COMMIT
[0m22:02:50.037446 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:50.038110 [debug] [MainThread]: On master: COMMIT
[0m22:02:50.039167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:02:50.039930 [debug] [MainThread]: On master: Close
[0m22:02:50.044124 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m22:02:50.045248 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m22:02:50.046383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m22:02:50.047238 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m22:02:50.062934 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m22:02:50.064120 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m22:02:50.141570 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m22:02:50.142889 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:02:50.143698 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m22:02:50.144424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:50.157301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m22:02:50.158187 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:02:50.158976 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
from public.b3_raw_ops
FROM 
source;
  );
[0m22:02:50.160210 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 22: FROM 
         ^

[0m22:02:50.161048 [debug] [Thread-1 (]: On model.b3_new.staging: ROLLBACK
[0m22:02:50.162283 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m22:02:50.165675 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "FROM"
  LINE 22: FROM 
           ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m22:02:50.168960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a46146-fbfa-4759-87d8-e7348e36b227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49e97d690>]}
[0m22:02:50.170273 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging ............................ [[31mERROR[0m in 0.12s]
[0m22:02:50.171592 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m22:02:50.173116 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "FROM"
  LINE 22: FROM 
           ^
  compiled code at target/run/b3_new/models/staging/staging.sql.
[0m22:02:50.177452 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:50.178375 [debug] [MainThread]: On master: BEGIN
[0m22:02:50.179327 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:50.192567 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:02:50.193503 [debug] [MainThread]: On master: COMMIT
[0m22:02:50.194161 [debug] [MainThread]: Using postgres connection "master"
[0m22:02:50.194862 [debug] [MainThread]: On master: COMMIT
[0m22:02:50.195901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:02:50.196651 [debug] [MainThread]: On master: Close
[0m22:02:50.197643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:50.198366 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m22:02:50.199096 [info ] [MainThread]: 
[0m22:02:50.199847 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m22:02:50.201173 [debug] [MainThread]: Command end result
[0m22:02:50.240366 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:02:50.243059 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:02:50.255650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m22:02:50.256642 [info ] [MainThread]: 
[0m22:02:50.257567 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:02:50.258348 [info ] [MainThread]: 
[0m22:02:50.259188 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near "FROM"
  LINE 22: FROM 
           ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m22:02:50.259905 [info ] [MainThread]: 
[0m22:02:50.260675 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:02:50.262251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.631482, "process_in_blocks": "0", "process_kernel_time": 0.241, "process_mem_max_rss": "110536", "process_out_blocks": "1712", "process_user_time": 3.562001}
[0m22:02:50.263365 [debug] [MainThread]: Command `dbt run` failed at 22:02:50.263113 after 1.63 seconds
[0m22:02:50.264383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49f660dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49d963e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b49dea6f80>]}
[0m22:02:50.265238 [debug] [MainThread]: Flushing usage events
[0m22:02:51.396696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:17.110186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6ae98d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6bd6e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6bd6e2f0>]}


============================== 22:05:17.114851 | 619ae214-bcb4-42c9-bee4-743d17370e4b ==============================
[0m22:05:17.114851 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:05:17.115907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:05:17.417082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6992f580>]}
[0m22:05:17.527501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6a238460>]}
[0m22:05:17.528882 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:05:17.720605 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:05:17.939105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:17.940212 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/staging.sql
[0m22:05:18.412889 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m22:05:18.443419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a691d56f0>]}
[0m22:05:18.596290 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:05:18.602105 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:05:18.618727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a691d7370>]}
[0m22:05:18.619712 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m22:05:18.620432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a691d7400>]}
[0m22:05:18.623053 [info ] [MainThread]: 
[0m22:05:18.623870 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m22:05:18.624546 [info ] [MainThread]: 
[0m22:05:18.625529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:18.627761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:05:18.693643 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:05:18.694489 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:05:18.695174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:18.709842 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m22:05:18.712669 [debug] [ThreadPool]: On list_foo: Close
[0m22:05:18.715025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m22:05:18.726872 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:05:18.727698 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m22:05:18.728359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:18.740480 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m22:05:18.741423 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:05:18.742136 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:05:18.746810 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:05:18.750109 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m22:05:18.751281 [debug] [ThreadPool]: On list_foo_public: Close
[0m22:05:18.760326 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:18.761123 [debug] [MainThread]: On master: BEGIN
[0m22:05:18.761767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:18.774739 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:05:18.775566 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:18.776360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:18.783035 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m22:05:18.785966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a68d10c40>]}
[0m22:05:18.786875 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:18.787937 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:18.788657 [debug] [MainThread]: On master: BEGIN
[0m22:05:18.789864 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:05:18.790590 [debug] [MainThread]: On master: COMMIT
[0m22:05:18.791240 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:18.791877 [debug] [MainThread]: On master: COMMIT
[0m22:05:18.792780 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:18.793508 [debug] [MainThread]: On master: Close
[0m22:05:18.797276 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m22:05:18.798450 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m22:05:18.799544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m22:05:18.800409 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m22:05:18.815737 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m22:05:18.816969 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m22:05:18.958064 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m22:05:18.959366 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:05:18.960172 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m22:05:18.960909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:18.973624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m22:05:18.974515 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:05:18.975287 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with source as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM 
source;
  );
[0m22:05:18.976533 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: source;
               ^

[0m22:05:18.977385 [debug] [Thread-1 (]: On model.b3_new.staging: ROLLBACK
[0m22:05:18.978663 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m22:05:18.981931 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: source;
                 ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m22:05:18.985266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '619ae214-bcb4-42c9-bee4-743d17370e4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6919e650>]}
[0m22:05:18.986624 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging ............................ [[31mERROR[0m in 0.18s]
[0m22:05:18.987836 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m22:05:18.989398 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: source;
                 ^
  compiled code at target/run/b3_new/models/staging/staging.sql.
[0m22:05:18.993021 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:18.993956 [debug] [MainThread]: On master: BEGIN
[0m22:05:18.994857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:19.008179 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:05:19.009433 [debug] [MainThread]: On master: COMMIT
[0m22:05:19.010237 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:19.010947 [debug] [MainThread]: On master: COMMIT
[0m22:05:19.011912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:19.012672 [debug] [MainThread]: On master: Close
[0m22:05:19.013687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:19.014410 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m22:05:19.015127 [info ] [MainThread]: 
[0m22:05:19.015897 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m22:05:19.017290 [debug] [MainThread]: Command end result
[0m22:05:19.055955 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:05:19.058730 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:05:19.071221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m22:05:19.072001 [info ] [MainThread]: 
[0m22:05:19.072900 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:19.073765 [info ] [MainThread]: 
[0m22:05:19.074643 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: source;
                 ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m22:05:19.075344 [info ] [MainThread]: 
[0m22:05:19.076129 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:05:19.077752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0737522, "process_in_blocks": "0", "process_kernel_time": 0.257051, "process_mem_max_rss": "113940", "process_out_blocks": "2544", "process_user_time": 3.972797}
[0m22:05:19.078767 [debug] [MainThread]: Command `dbt run` failed at 22:05:19.078540 after 2.07 seconds
[0m22:05:19.079868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6ae98d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a6b4ae5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a696f6ad0>]}
[0m22:05:19.080812 [debug] [MainThread]: Flushing usage events
[0m22:05:20.079102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:41.050866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0c28ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0d162410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0d1623b0>]}


============================== 22:05:41.055380 | c83fc40a-3392-4acc-ae44-6d60436be6bf ==============================
[0m22:05:41.055380 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:05:41.056453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:05:41.359474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0b5c0520>]}
[0m22:05:41.469274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0ba78970>]}
[0m22:05:41.470682 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:05:41.662644 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:05:41.882456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:41.883562 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/staging.sql
[0m22:05:42.353838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m22:05:42.383739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0a4d57b0>]}
[0m22:05:42.547328 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:05:42.553161 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:05:42.569849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0a4d73d0>]}
[0m22:05:42.570852 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m22:05:42.571576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0a4d5a80>]}
[0m22:05:42.574170 [info ] [MainThread]: 
[0m22:05:42.574995 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m22:05:42.575671 [info ] [MainThread]: 
[0m22:05:42.576670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:05:42.578875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:05:42.645015 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:05:42.645834 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:05:42.646488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:42.660782 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m22:05:42.663605 [debug] [ThreadPool]: On list_foo: Close
[0m22:05:42.666010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m22:05:42.677883 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:05:42.678694 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m22:05:42.679348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:42.691752 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m22:05:42.692563 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:05:42.693270 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:05:42.698384 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m22:05:42.701412 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m22:05:42.702517 [debug] [ThreadPool]: On list_foo_public: Close
[0m22:05:42.712746 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:42.713553 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.714183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:42.726943 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:05:42.727751 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:42.728528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:05:42.735379 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m22:05:42.738257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0a558040>]}
[0m22:05:42.739175 [debug] [MainThread]: On master: ROLLBACK
[0m22:05:42.740224 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:42.740946 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.742168 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m22:05:42.742906 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.743576 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:42.744198 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.745107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:42.745843 [debug] [MainThread]: On master: Close
[0m22:05:42.749659 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m22:05:42.750820 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m22:05:42.751883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m22:05:42.752693 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m22:05:42.771566 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m22:05:42.772790 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m22:05:42.912688 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m22:05:42.913992 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:05:42.914826 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m22:05:42.915572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:05:42.928350 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m22:05:42.929242 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:05:42.930022 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM 
final;
  );
[0m22:05:42.931381 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: final;
              ^

[0m22:05:42.932229 [debug] [Thread-1 (]: On model.b3_new.staging: ROLLBACK
[0m22:05:42.933444 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m22:05:42.936779 [debug] [Thread-1 (]: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: final;
                ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m22:05:42.940052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c83fc40a-3392-4acc-ae44-6d60436be6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0c00a3e0>]}
[0m22:05:42.941421 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.staging ............................ [[31mERROR[0m in 0.19s]
[0m22:05:42.942617 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m22:05:42.944182 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: final;
                ^
  compiled code at target/run/b3_new/models/staging/staging.sql.
[0m22:05:42.948142 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:42.949029 [debug] [MainThread]: On master: BEGIN
[0m22:05:42.949800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:05:42.961721 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:05:42.962677 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.963689 [debug] [MainThread]: Using postgres connection "master"
[0m22:05:42.964334 [debug] [MainThread]: On master: COMMIT
[0m22:05:42.965332 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:05:42.966075 [debug] [MainThread]: On master: Close
[0m22:05:42.967091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:42.967864 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m22:05:42.968876 [info ] [MainThread]: 
[0m22:05:42.970055 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m22:05:42.971783 [debug] [MainThread]: Command end result
[0m22:05:43.010308 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:05:43.013245 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:05:43.026296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m22:05:43.027205 [info ] [MainThread]: 
[0m22:05:43.028703 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:05:43.029899 [info ] [MainThread]: 
[0m22:05:43.031172 [error] [MainThread]:   Database Error in model staging (models/staging/staging.sql)
  syntax error at or near ";"
  LINE 22: final;
                ^
  compiled code at target/run/b3_new/models/staging/staging.sql
[0m22:05:43.032248 [info ] [MainThread]: 
[0m22:05:43.033483 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:05:43.036006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0907958, "process_in_blocks": "0", "process_kernel_time": 0.246919, "process_mem_max_rss": "114056", "process_out_blocks": "2536", "process_user_time": 4.017691}
[0m22:05:43.037128 [debug] [MainThread]: Command `dbt run` failed at 22:05:43.036884 after 2.09 seconds
[0m22:05:43.038028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0c28ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0aa61930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744d0aa62c80>]}
[0m22:05:43.038948 [debug] [MainThread]: Flushing usage events
[0m22:05:43.918115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:00.070253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b488ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b57623b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b5762350>]}


============================== 22:06:00.074772 | 5a120fe2-3b8d-44f1-ad55-5ec76b143d36 ==============================
[0m22:06:00.074772 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:06:00.075876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:00.381928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b3b839a0>]}
[0m22:06:00.492658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b5752140>]}
[0m22:06:00.494047 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:06:00.687692 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:06:00.907554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:00.908661 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/staging.sql
[0m22:06:01.386479 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m22:06:01.415783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b2ad9780>]}
[0m22:06:01.572739 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:06:01.578470 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:06:01.595353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b2adb3d0>]}
[0m22:06:01.596343 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m22:06:01.597090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b2adb460>]}
[0m22:06:01.599743 [info ] [MainThread]: 
[0m22:06:01.600561 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m22:06:01.601278 [info ] [MainThread]: 
[0m22:06:01.602372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:01.604459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:06:01.669904 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:06:01.670742 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:06:01.671406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:01.685301 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m22:06:01.687749 [debug] [ThreadPool]: On list_foo: Close
[0m22:06:01.690210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m22:06:01.702438 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:06:01.703244 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m22:06:01.703896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:01.716648 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m22:06:01.717814 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:06:01.718535 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:06:01.722867 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m22:06:01.726402 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m22:06:01.727475 [debug] [ThreadPool]: On list_foo_public: Close
[0m22:06:01.737751 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:01.738589 [debug] [MainThread]: On master: BEGIN
[0m22:06:01.739230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:01.751950 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m22:06:01.753402 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:01.754735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:06:01.760615 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m22:06:01.762818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b2917be0>]}
[0m22:06:01.763875 [debug] [MainThread]: On master: ROLLBACK
[0m22:06:01.764925 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:01.765679 [debug] [MainThread]: On master: BEGIN
[0m22:06:01.767128 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:06:01.768259 [debug] [MainThread]: On master: COMMIT
[0m22:06:01.769065 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:01.769785 [debug] [MainThread]: On master: COMMIT
[0m22:06:01.770798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:01.771538 [debug] [MainThread]: On master: Close
[0m22:06:01.775897 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m22:06:01.777057 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m22:06:01.778088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m22:06:01.778892 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m22:06:01.795025 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m22:06:01.796295 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m22:06:01.950332 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m22:06:01.951694 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:06:01.952542 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m22:06:01.953308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:01.965501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:06:01.966829 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:06:01.967719 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m22:06:01.981759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m22:06:01.994171 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:06:01.995072 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging__dbt_tmp" rename to "staging"
[0m22:06:01.996468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:06:02.025696 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m22:06:02.026614 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:06:02.027364 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m22:06:02.029366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:02.041642 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."staging__dbt_backup"
[0m22:06:02.050503 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:06:02.051441 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
drop view if exists "foo"."public"."staging__dbt_backup" cascade
[0m22:06:02.052660 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:06:02.057374 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m22:06:02.061752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a120fe2-3b8d-44f1-ad55-5ec76b143d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b58b2b00>]}
[0m22:06:02.063533 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.staging ................................ [[32mCREATE VIEW[0m in 0.28s]
[0m22:06:02.064814 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m22:06:02.067400 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:02.068201 [debug] [MainThread]: On master: BEGIN
[0m22:06:02.068911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:02.081514 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:06:02.082553 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.083252 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:02.083935 [debug] [MainThread]: On master: COMMIT
[0m22:06:02.085493 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:02.086984 [debug] [MainThread]: On master: Close
[0m22:06:02.088579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:02.089467 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m22:06:02.090287 [info ] [MainThread]: 
[0m22:06:02.091140 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m22:06:02.092598 [debug] [MainThread]: Command end result
[0m22:06:02.132862 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:06:02.136138 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:06:02.149158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m22:06:02.149947 [info ] [MainThread]: 
[0m22:06:02.150900 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:02.151653 [info ] [MainThread]: 
[0m22:06:02.152457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:06:02.154058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1905165, "process_in_blocks": "0", "process_kernel_time": 0.246218, "process_mem_max_rss": "113860", "process_out_blocks": "2528", "process_user_time": 4.108649}
[0m22:06:02.154982 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:02.154828 after 2.19 seconds
[0m22:06:02.155724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b488ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b4d34c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7250b356cfd0>]}
[0m22:06:02.156507 [debug] [MainThread]: Flushing usage events
[0m22:06:03.169472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:30.907395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fccd78eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcdc1e440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcdc1e3e0>]}


============================== 22:13:30.912354 | 5764bfc8-2cc7-4fee-b83b-c4abeee34a49 ==============================
[0m22:13:30.912354 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:13:30.913450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:13:31.223897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcdbc88e0>]}
[0m22:13:31.335048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcdc0e1d0>]}
[0m22:13:31.336436 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m22:13:31.527804 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m22:13:31.749551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:13:31.750824 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/sources.yml
[0m22:13:31.751603 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/staging.sql
[0m22:13:32.399445 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m22:13:32.425232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcabd4b50>]}
[0m22:13:32.579295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:13:32.585136 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:13:32.602391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcab93a00>]}
[0m22:13:32.603412 [info ] [MainThread]: Found 1 model, 1 source, 431 macros
[0m22:13:32.604135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcab90130>]}
[0m22:13:32.606833 [info ] [MainThread]: 
[0m22:13:32.607680 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m22:13:32.608490 [info ] [MainThread]: 
[0m22:13:32.609763 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:13:32.612024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m22:13:32.744415 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m22:13:32.745262 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m22:13:32.745930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:32.760797 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m22:13:32.763092 [debug] [ThreadPool]: On list_foo: Close
[0m22:13:32.765722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m22:13:32.778022 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:13:32.778856 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m22:13:32.779531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:32.791646 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m22:13:32.792852 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m22:13:32.793575 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:13:32.798819 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m22:13:32.801736 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m22:13:32.802814 [debug] [ThreadPool]: On list_foo_public: Close
[0m22:13:32.813196 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:32.814028 [debug] [MainThread]: On master: BEGIN
[0m22:13:32.814680 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:32.826769 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:13:32.827767 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:32.828547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:13:32.835227 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m22:13:32.838928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcafdb3a0>]}
[0m22:13:32.839815 [debug] [MainThread]: On master: ROLLBACK
[0m22:13:32.840860 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:32.841598 [debug] [MainThread]: On master: BEGIN
[0m22:13:32.842753 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:13:32.843494 [debug] [MainThread]: On master: COMMIT
[0m22:13:32.844183 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:32.844872 [debug] [MainThread]: On master: COMMIT
[0m22:13:32.845831 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:32.846603 [debug] [MainThread]: On master: Close
[0m22:13:32.850287 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m22:13:32.851884 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m22:13:32.852955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m22:13:32.853785 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m22:13:32.870521 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m22:13:32.871720 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m22:13:32.947844 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m22:13:32.949213 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:13:32.950040 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m22:13:32.950762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:32.962675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m22:13:32.963573 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:13:32.964440 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m22:13:32.968634 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:13:32.981192 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:13:32.982107 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging" rename to "staging__dbt_backup"
[0m22:13:32.983745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:13:32.989862 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:13:32.990734 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging__dbt_tmp" rename to "staging"
[0m22:13:32.992281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:13:33.025622 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m22:13:33.026549 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:13:33.027331 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m22:13:33.030619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:13:33.042645 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."staging__dbt_backup"
[0m22:13:33.051262 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m22:13:33.052167 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
drop view if exists "foo"."public"."staging__dbt_backup" cascade
[0m22:13:33.056811 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m22:13:33.061793 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m22:13:33.065384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5764bfc8-2cc7-4fee-b83b-c4abeee34a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcafcbb20>]}
[0m22:13:33.066805 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.staging ................................ [[32mCREATE VIEW[0m in 0.21s]
[0m22:13:33.068135 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m22:13:33.070196 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:33.071030 [debug] [MainThread]: On master: BEGIN
[0m22:13:33.071761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:33.084171 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m22:13:33.085054 [debug] [MainThread]: On master: COMMIT
[0m22:13:33.085845 [debug] [MainThread]: Using postgres connection "master"
[0m22:13:33.086582 [debug] [MainThread]: On master: COMMIT
[0m22:13:33.087603 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:13:33.088427 [debug] [MainThread]: On master: Close
[0m22:13:33.089580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:33.090383 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m22:13:33.091194 [info ] [MainThread]: 
[0m22:13:33.092139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m22:13:33.093720 [debug] [MainThread]: Command end result
[0m22:13:33.136249 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m22:13:33.139036 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m22:13:33.152054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m22:13:33.152958 [info ] [MainThread]: 
[0m22:13:33.153816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:13:33.154533 [info ] [MainThread]: 
[0m22:13:33.155267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:13:33.156854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3553083, "process_in_blocks": "0", "process_kernel_time": 0.27385, "process_mem_max_rss": "114892", "process_out_blocks": "2528", "process_user_time": 4.246679}
[0m22:13:33.157771 [debug] [MainThread]: Command `dbt run` succeeded at 22:13:33.157610 after 2.36 seconds
[0m22:13:33.158518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fccd78eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcbdd0ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1fcbdd22c0>]}
[0m22:13:33.159298 [debug] [MainThread]: Flushing usage events
[0m22:13:34.267824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:18.052771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a652d78e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a653c1e3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a653c1e350>]}


============================== 13:11:18.058283 | 58eb7b6f-212a-40d8-b56d-e918af657625 ==============================
[0m13:11:18.058283 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:11:18.059466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:11:18.363962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a651d939a0>]}
[0m13:11:18.473576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a653c0e140>]}
[0m13:11:18.475007 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:11:18.667833 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:11:18.886858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:11:18.888081 [debug] [MainThread]: Partial parsing: added file: b3_new://models/intermediate/silver.sql
[0m13:11:19.359612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m13:11:19.390796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a650fbdb40>]}
[0m13:11:19.547558 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:11:19.553445 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:11:19.570381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a65101c670>]}
[0m13:11:19.571398 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m13:11:19.572162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a653017700>]}
[0m13:11:19.574891 [info ] [MainThread]: 
[0m13:11:19.575730 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:11:19.576488 [info ] [MainThread]: 
[0m13:11:19.577569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:19.579834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m13:11:19.644633 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m13:11:19.645484 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m13:11:19.646162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:19.660028 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m13:11:19.662928 [debug] [ThreadPool]: On list_foo: Close
[0m13:11:19.673206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m13:11:19.685501 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m13:11:19.686309 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m13:11:19.686948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:19.699649 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:11:19.700464 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m13:11:19.701151 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:11:19.705933 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:11:19.709200 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m13:11:19.710385 [debug] [ThreadPool]: On list_foo_public: Close
[0m13:11:19.720026 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.720856 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.721514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:19.732971 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:11:19.734233 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.735077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:19.741470 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m13:11:19.745527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6540056c0>]}
[0m13:11:19.746438 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:19.747577 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.748370 [debug] [MainThread]: On master: BEGIN
[0m13:11:19.749629 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:11:19.750395 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.751096 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:19.751766 [debug] [MainThread]: On master: COMMIT
[0m13:11:19.752747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:19.753515 [debug] [MainThread]: On master: Close
[0m13:11:19.757646 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m13:11:19.758851 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m13:11:19.759933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m13:11:19.760772 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m13:11:19.778374 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m13:11:19.779579 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m13:11:19.913001 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m13:11:19.914488 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:11:19.915434 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m13:11:19.916249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:19.927940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:11:19.928926 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:11:19.929844 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m13:11:19.932953 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:11:19.945816 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:11:19.946746 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging" rename to "staging__dbt_backup"
[0m13:11:19.948231 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:19.954275 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:11:19.955161 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging__dbt_tmp" rename to "staging"
[0m13:11:19.956466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:19.988749 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m13:11:19.989748 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:11:19.990529 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m13:11:19.993442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:11:20.007262 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."staging__dbt_backup"
[0m13:11:20.016177 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:11:20.017106 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
drop view if exists "foo"."public"."staging__dbt_backup" cascade
[0m13:11:20.020700 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:11:20.025963 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m13:11:20.029479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58eb7b6f-212a-40d8-b56d-e918af657625', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a653d8eb00>]}
[0m13:11:20.030915 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.staging ................................ [[32mCREATE VIEW[0m in 0.27s]
[0m13:11:20.032200 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m13:11:20.034950 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:20.035715 [debug] [MainThread]: On master: BEGIN
[0m13:11:20.036362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:20.048870 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:11:20.049675 [debug] [MainThread]: On master: COMMIT
[0m13:11:20.050407 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:20.051293 [debug] [MainThread]: On master: COMMIT
[0m13:11:20.052510 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:20.053495 [debug] [MainThread]: On master: Close
[0m13:11:20.055003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:20.055892 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m13:11:20.056729 [info ] [MainThread]: 
[0m13:11:20.057591 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m13:11:20.059048 [debug] [MainThread]: Command end result
[0m13:11:20.100886 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:11:20.104314 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:11:20.116773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m13:11:20.117566 [info ] [MainThread]: 
[0m13:11:20.118451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:20.119206 [info ] [MainThread]: 
[0m13:11:20.119945 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:11:20.121507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.176336, "process_in_blocks": "0", "process_kernel_time": 0.228838, "process_mem_max_rss": "113728", "process_out_blocks": "2544", "process_user_time": 4.076116}
[0m13:11:20.122420 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:20.122256 after 2.18 seconds
[0m13:11:20.123193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a652d78e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6520ea140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a6520e9330>]}
[0m13:11:20.123983 [debug] [MainThread]: Flushing usage events
[0m13:11:21.221802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:33.604990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b04a60e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b05936410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b059363b0>]}


============================== 13:12:33.609595 | ad9b8c91-e88b-4504-8756-d986526dc7ea ==============================
[0m13:12:33.609595 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:12:33.611177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:12:33.918561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b03d94580>]}
[0m13:12:34.029373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b0424c970>]}
[0m13:12:34.030746 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:12:34.221102 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:12:34.407443 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:12:34.408343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b0424f010>]}
[0m13:12:36.468990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging.eventos
[0m13:12:36.494612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b0376d210>]}
[0m13:12:36.650206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:12:36.655994 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:12:36.672901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b02d51120>]}
[0m13:12:36.673907 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m13:12:36.674631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b02d538e0>]}
[0m13:12:36.677379 [info ] [MainThread]: 
[0m13:12:36.678193 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:12:36.678868 [info ] [MainThread]: 
[0m13:12:36.680330 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:12:36.682858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m13:12:36.747413 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m13:12:36.748233 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m13:12:36.748906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:36.763738 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m13:12:36.766131 [debug] [ThreadPool]: On list_foo: Close
[0m13:12:36.775373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m13:12:36.787793 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m13:12:36.788589 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m13:12:36.789251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:36.801622 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:12:36.802434 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m13:12:36.803129 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:12:36.807943 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:12:36.811006 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m13:12:36.812195 [debug] [ThreadPool]: On list_foo_public: Close
[0m13:12:36.821502 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:36.822288 [debug] [MainThread]: On master: BEGIN
[0m13:12:36.822939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:36.835695 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:12:36.836517 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:36.837287 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:12:36.843890 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m13:12:36.847255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b03d7e8f0>]}
[0m13:12:36.848143 [debug] [MainThread]: On master: ROLLBACK
[0m13:12:36.849327 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:36.850065 [debug] [MainThread]: On master: BEGIN
[0m13:12:36.851177 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:12:36.851973 [debug] [MainThread]: On master: COMMIT
[0m13:12:36.852641 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:36.853294 [debug] [MainThread]: On master: COMMIT
[0m13:12:36.854311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:12:36.855064 [debug] [MainThread]: On master: Close
[0m13:12:36.858923 [debug] [Thread-1 (]: Began running node model.b3_new.staging
[0m13:12:36.860099 [info ] [Thread-1 (]: 1 of 1 START sql view model public.staging ..................................... [RUN]
[0m13:12:36.861192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.staging)
[0m13:12:36.862003 [debug] [Thread-1 (]: Began compiling node model.b3_new.staging
[0m13:12:36.878060 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.staging"
[0m13:12:36.879256 [debug] [Thread-1 (]: Began executing node model.b3_new.staging
[0m13:12:36.949431 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.staging"
[0m13:12:36.950747 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:12:36.951559 [debug] [Thread-1 (]: On model.b3_new.staging: BEGIN
[0m13:12:36.952315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:36.965174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m13:12:36.966262 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:12:36.967068 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */

  create view "foo"."public"."staging__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m13:12:36.971343 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:12:36.984005 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:12:36.984901 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging" rename to "staging__dbt_backup"
[0m13:12:36.986637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:12:36.992972 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:12:36.993837 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
alter table "foo"."public"."staging__dbt_tmp" rename to "staging"
[0m13:12:36.995435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:12:37.031776 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m13:12:37.032728 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:12:37.033489 [debug] [Thread-1 (]: On model.b3_new.staging: COMMIT
[0m13:12:37.036728 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:12:37.049883 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."staging__dbt_backup"
[0m13:12:37.058505 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.staging"
[0m13:12:37.059429 [debug] [Thread-1 (]: On model.b3_new.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.staging"} */
drop view if exists "foo"."public"."staging__dbt_backup" cascade
[0m13:12:37.063348 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:12:37.068720 [debug] [Thread-1 (]: On model.b3_new.staging: Close
[0m13:12:37.072170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad9b8c91-e88b-4504-8756-d986526dc7ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b0214efe0>]}
[0m13:12:37.073536 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.staging ................................ [[32mCREATE VIEW[0m in 0.21s]
[0m13:12:37.074906 [debug] [Thread-1 (]: Finished running node model.b3_new.staging
[0m13:12:37.077303 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:37.078096 [debug] [MainThread]: On master: BEGIN
[0m13:12:37.078726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:37.091586 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:12:37.092409 [debug] [MainThread]: On master: COMMIT
[0m13:12:37.093095 [debug] [MainThread]: Using postgres connection "master"
[0m13:12:37.093722 [debug] [MainThread]: On master: COMMIT
[0m13:12:37.094641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:12:37.095385 [debug] [MainThread]: On master: Close
[0m13:12:37.096375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:37.097071 [debug] [MainThread]: Connection 'model.b3_new.staging' was properly closed.
[0m13:12:37.097810 [info ] [MainThread]: 
[0m13:12:37.098637 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:12:37.100319 [debug] [MainThread]: Command end result
[0m13:12:37.138620 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:12:37.141325 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:12:37.154339 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m13:12:37.155124 [info ] [MainThread]: 
[0m13:12:37.156078 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:37.156823 [info ] [MainThread]: 
[0m13:12:37.157540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:12:37.159159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.659746, "process_in_blocks": "0", "process_kernel_time": 0.274836, "process_mem_max_rss": "114500", "process_out_blocks": "2552", "process_user_time": 5.573677}
[0m13:12:37.160081 [debug] [MainThread]: Command `dbt run` succeeded at 13:12:37.159918 after 3.66 seconds
[0m13:12:37.160919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b04a60e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b02c46620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775b037bbd00>]}
[0m13:12:37.162118 [debug] [MainThread]: Flushing usage events
[0m13:12:38.041392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:35.748132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abc378e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abd1f2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abd1f2500>]}


============================== 13:15:35.752859 | b63df114-31b6-4a3f-911a-c195563338f2 ==============================
[0m13:15:35.752859 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:15:35.753966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:15:36.060841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b63df114-31b6-4a3f-911a-c195563338f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abd20f250>]}
[0m13:15:36.172926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b63df114-31b6-4a3f-911a-c195563338f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abbb476d0>]}
[0m13:15:36.174371 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:15:36.367410 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:15:36.555299 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:15:36.556203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b63df114-31b6-4a3f-911a-c195563338f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abbb47010>]}
[0m13:15:38.661083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b63df114-31b6-4a3f-911a-c195563338f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709aba69b340>]}
[0m13:15:38.814322 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:15:38.820168 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:15:38.853017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b63df114-31b6-4a3f-911a-c195563338f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709aba6feda0>]}
[0m13:15:38.854051 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m13:15:38.854848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b63df114-31b6-4a3f-911a-c195563338f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abc9d5c30>]}
[0m13:15:38.857383 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:15:38.858502 [debug] [MainThread]: Command end result
[0m13:15:38.897746 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:15:38.900567 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:15:38.906766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m13:15:38.908373 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.2658157, "process_in_blocks": "0", "process_kernel_time": 0.232988, "process_mem_max_rss": "106216", "process_out_blocks": "2504", "process_user_time": 5.240737}
[0m13:15:38.909260 [debug] [MainThread]: Command `dbt test` succeeded at 13:15:38.909105 after 3.27 seconds
[0m13:15:38.910009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abc378e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abd20f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709abc239360>]}
[0m13:15:38.910801 [debug] [MainThread]: Flushing usage events
[0m13:15:39.989329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:47.290887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd595ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd6832410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd68323b0>]}


============================== 13:15:47.296044 | 786afe80-d1a1-483e-a056-fbbcbba3ae05 ==============================
[0m13:15:47.296044 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:15:47.297128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:47.608136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd49ed2a0>]}
[0m13:15:47.718706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd5073a90>]}
[0m13:15:47.720099 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:15:47.911373 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:15:48.132244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:48.133024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:48.209572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd3c46440>]}
[0m13:15:48.369082 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:15:48.375055 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:15:48.393405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd3ddc0d0>]}
[0m13:15:48.394482 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m13:15:48.395320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd3ddc0a0>]}
[0m13:15:48.398160 [info ] [MainThread]: 
[0m13:15:48.399063 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:15:48.399830 [info ] [MainThread]: 
[0m13:15:48.400907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:15:48.403014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m13:15:48.473232 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m13:15:48.474060 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m13:15:48.474709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:48.490877 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m13:15:48.493201 [debug] [ThreadPool]: On list_foo: Close
[0m13:15:48.502723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m13:15:48.514885 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m13:15:48.515672 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m13:15:48.516362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:48.530154 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:15:48.531004 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m13:15:48.531818 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:15:48.536266 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m13:15:48.538741 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m13:15:48.539847 [debug] [ThreadPool]: On list_foo_public: Close
[0m13:15:48.549330 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:48.550148 [debug] [MainThread]: On master: BEGIN
[0m13:15:48.550818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:48.563000 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:15:48.563839 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:48.564644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:15:48.571383 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m13:15:48.575282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd3c47a00>]}
[0m13:15:48.576203 [debug] [MainThread]: On master: ROLLBACK
[0m13:15:48.577252 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:48.578011 [debug] [MainThread]: On master: BEGIN
[0m13:15:48.579160 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:15:48.579923 [debug] [MainThread]: On master: COMMIT
[0m13:15:48.580620 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:48.581338 [debug] [MainThread]: On master: COMMIT
[0m13:15:48.582335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:15:48.583101 [debug] [MainThread]: On master: Close
[0m13:15:48.587743 [debug] [Thread-1 (]: Began running node model.b3_new.bronze
[0m13:15:48.588991 [info ] [Thread-1 (]: 1 of 1 START sql table model public.bronze ..................................... [RUN]
[0m13:15:48.590015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.bronze)
[0m13:15:48.590847 [debug] [Thread-1 (]: Began compiling node model.b3_new.bronze
[0m13:15:48.606636 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.bronze"
[0m13:15:48.608088 [debug] [Thread-1 (]: Began executing node model.b3_new.bronze
[0m13:15:48.686998 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.bronze"
[0m13:15:48.688259 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.bronze"
[0m13:15:48.689066 [debug] [Thread-1 (]: On model.b3_new.bronze: BEGIN
[0m13:15:48.689792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:48.702400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:15:48.703690 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.bronze"
[0m13:15:48.704482 [debug] [Thread-1 (]: On model.b3_new.bronze: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.bronze"} */

  
    

  create  table "foo"."public"."bronze__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m13:15:48.712233 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m13:15:48.724344 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.bronze"
[0m13:15:48.725330 [debug] [Thread-1 (]: On model.b3_new.bronze: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.bronze"} */
alter table "foo"."public"."bronze__dbt_tmp" rename to "bronze"
[0m13:15:48.726803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:48.762541 [debug] [Thread-1 (]: On model.b3_new.bronze: COMMIT
[0m13:15:48.763455 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.bronze"
[0m13:15:48.764233 [debug] [Thread-1 (]: On model.b3_new.bronze: COMMIT
[0m13:15:48.766510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:15:48.778751 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."bronze__dbt_backup"
[0m13:15:48.787863 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.bronze"
[0m13:15:48.788739 [debug] [Thread-1 (]: On model.b3_new.bronze: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.bronze"} */
drop table if exists "foo"."public"."bronze__dbt_backup" cascade
[0m13:15:48.790047 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:15:48.794702 [debug] [Thread-1 (]: On model.b3_new.bronze: Close
[0m13:15:48.798184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '786afe80-d1a1-483e-a056-fbbcbba3ae05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd358ed70>]}
[0m13:15:48.799582 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.bronze ................................ [[32mSELECT 4[0m in 0.21s]
[0m13:15:48.800869 [debug] [Thread-1 (]: Finished running node model.b3_new.bronze
[0m13:15:48.803104 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:48.803906 [debug] [MainThread]: On master: BEGIN
[0m13:15:48.804549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:48.816720 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:15:48.817646 [debug] [MainThread]: On master: COMMIT
[0m13:15:48.818377 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:48.819043 [debug] [MainThread]: On master: COMMIT
[0m13:15:48.820074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:15:48.820857 [debug] [MainThread]: On master: Close
[0m13:15:48.821875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:48.822560 [debug] [MainThread]: Connection 'model.b3_new.bronze' was properly closed.
[0m13:15:48.823273 [info ] [MainThread]: 
[0m13:15:48.824045 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:15:48.825545 [debug] [MainThread]: Command end result
[0m13:15:48.866062 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m13:15:48.869413 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m13:15:48.881902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m13:15:48.882801 [info ] [MainThread]: 
[0m13:15:48.883673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:48.884577 [info ] [MainThread]: 
[0m13:15:48.885508 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:15:48.887155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7015178, "process_in_blocks": "0", "process_kernel_time": 0.222984, "process_mem_max_rss": "110096", "process_out_blocks": "1728", "process_user_time": 3.638741}
[0m13:15:48.888142 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:48.887977 after 1.70 seconds
[0m13:15:48.888923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd595ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd5073a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71afd58208b0>]}
[0m13:15:48.889866 [debug] [MainThread]: Flushing usage events
[0m13:15:49.836458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:47.285732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbad740e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbae5e6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbae5e63b0>]}


============================== 23:31:47.297924 | 4f54fbab-e655-4e6d-9983-b3ff23b267df ==============================
[0m23:31:47.297924 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:31:47.299022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:31:47.763899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbaca452a0>]}
[0m23:31:47.875687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbace33a90>]}
[0m23:31:47.878823 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:31:48.089587 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:31:48.295749 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:31:48.296673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbacf0f040>]}
[0m23:31:50.440159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.b3_new.silver
[0m23:31:50.466772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbac1480d0>]}
[0m23:31:50.625716 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m23:31:50.633678 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m23:31:50.667301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbaba8b130>]}
[0m23:31:50.668378 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m23:31:50.669188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbaba8b670>]}
[0m23:31:50.672140 [info ] [MainThread]: 
[0m23:31:50.673037 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m23:31:50.673845 [info ] [MainThread]: 
[0m23:31:50.675106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:31:50.685002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:31:50.765461 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:31:50.766308 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:31:50.766964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:50.818603 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.052 seconds
[0m23:31:50.820967 [debug] [ThreadPool]: On list_foo: Close
[0m23:31:50.823617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m23:31:50.836139 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m23:31:50.836964 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m23:31:50.837666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:50.849971 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:31:50.850830 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m23:31:50.851574 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:31:50.858702 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m23:31:50.862585 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m23:31:50.863744 [debug] [ThreadPool]: On list_foo_public: Close
[0m23:31:50.874129 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:50.874939 [debug] [MainThread]: On master: BEGIN
[0m23:31:50.875619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:50.887714 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m23:31:50.888702 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:50.889481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:31:50.896137 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m23:31:50.898818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbabaae9b0>]}
[0m23:31:50.899720 [debug] [MainThread]: On master: ROLLBACK
[0m23:31:50.900847 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:50.901774 [debug] [MainThread]: On master: BEGIN
[0m23:31:50.903216 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:31:50.903975 [debug] [MainThread]: On master: COMMIT
[0m23:31:50.904665 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:50.905352 [debug] [MainThread]: On master: COMMIT
[0m23:31:50.906312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:31:50.907067 [debug] [MainThread]: On master: Close
[0m23:31:50.911149 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m23:31:50.912376 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m23:31:50.913453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m23:31:50.914334 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m23:31:50.930548 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m23:31:50.931941 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m23:31:51.010774 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m23:31:51.012214 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:31:51.013033 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m23:31:51.013789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:51.026527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m23:31:51.027893 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:31:51.028724 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."raw_data_table"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m23:31:51.030297 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_data_table.b3_raw_ops" does not exist
LINE 13:     SELECT * FROM "foo"."raw_data_table"."b3_raw_ops"
                           ^

[0m23:31:51.031177 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: ROLLBACK
[0m23:31:51.032460 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m23:31:51.039920 [debug] [Thread-1 (]: Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  relation "raw_data_table.b3_raw_ops" does not exist
  LINE 13:     SELECT * FROM "foo"."raw_data_table"."b3_raw_ops"
                             ^
  compiled code at target/run/b3_new/models/staging/stg_b3_ops.sql
[0m23:31:51.043504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f54fbab-e655-4e6d-9983-b3ff23b267df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbaae52e00>]}
[0m23:31:51.044891 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model public.stg_b3_ops ........................ [[31mERROR[0m in 0.13s]
[0m23:31:51.046173 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m23:31:51.047770 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  relation "raw_data_table.b3_raw_ops" does not exist
  LINE 13:     SELECT * FROM "foo"."raw_data_table"."b3_raw_ops"
                             ^
  compiled code at target/run/b3_new/models/staging/stg_b3_ops.sql.
[0m23:31:51.050579 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m23:31:51.052213 [info ] [Thread-3 (]: 2 of 2 SKIP relation public.int_b3_ops ......................................... [[33mSKIP[0m]
[0m23:31:51.053527 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m23:31:51.056300 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:51.057532 [debug] [MainThread]: On master: BEGIN
[0m23:31:51.058671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:51.071889 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m23:31:51.073007 [debug] [MainThread]: On master: COMMIT
[0m23:31:51.074354 [debug] [MainThread]: Using postgres connection "master"
[0m23:31:51.075732 [debug] [MainThread]: On master: COMMIT
[0m23:31:51.077353 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:31:51.078383 [debug] [MainThread]: On master: Close
[0m23:31:51.079834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:51.080949 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m23:31:51.082224 [info ] [MainThread]: 
[0m23:31:51.083290 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m23:31:51.084919 [debug] [MainThread]: Command end result
[0m23:31:51.125516 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m23:31:51.128444 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m23:31:51.141130 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m23:31:51.142181 [info ] [MainThread]: 
[0m23:31:51.143333 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:31:51.144197 [info ] [MainThread]: 
[0m23:31:51.145122 [error] [MainThread]:   Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  relation "raw_data_table.b3_raw_ops" does not exist
  LINE 13:     SELECT * FROM "foo"."raw_data_table"."b3_raw_ops"
                             ^
  compiled code at target/run/b3_new/models/staging/stg_b3_ops.sql
[0m23:31:51.145908 [info ] [MainThread]: 
[0m23:31:51.146742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m23:31:51.149193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.975536, "process_in_blocks": "93920", "process_kernel_time": 0.452546, "process_mem_max_rss": "114252", "process_out_blocks": "2560", "process_user_time": 5.66083}
[0m23:31:51.150277 [debug] [MainThread]: Command `dbt run` failed at 23:31:51.150028 after 3.98 seconds
[0m23:31:51.151210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbad740e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbace33a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bbacf5b3d0>]}
[0m23:31:51.152220 [debug] [MainThread]: Flushing usage events
[0m23:31:52.170673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:33:17.680459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f756744eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7575f2440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7575f23e0>]}


============================== 23:33:17.684970 | b08eac48-beaf-489f-bcc8-75060ab2b819 ==============================
[0m23:33:17.684970 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:33:17.686133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:33:17.998433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7575c88e0>]}
[0m23:33:18.111933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f75760e1d0>]}
[0m23:33:18.113438 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:33:18.308536 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:33:18.535078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:33:18.536464 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/sources.yml
[0m23:33:19.203662 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.b3_new.silver
[0m23:33:19.230583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7545f1210>]}
[0m23:33:19.387505 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m23:33:19.393405 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m23:33:19.410806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7545f0b80>]}
[0m23:33:19.411848 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m23:33:19.412608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7545f0af0>]}
[0m23:33:19.415401 [info ] [MainThread]: 
[0m23:33:19.416241 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m23:33:19.416931 [info ] [MainThread]: 
[0m23:33:19.418080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:33:19.427699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:33:19.556550 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:33:19.557521 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:33:19.558255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:33:19.573564 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m23:33:19.576387 [debug] [ThreadPool]: On list_foo: Close
[0m23:33:19.579370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m23:33:19.591501 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m23:33:19.592324 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m23:33:19.592969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:33:19.604958 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m23:33:19.605933 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m23:33:19.606943 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:33:19.611765 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m23:33:19.614810 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m23:33:19.615958 [debug] [ThreadPool]: On list_foo_public: Close
[0m23:33:19.626823 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:19.627640 [debug] [MainThread]: On master: BEGIN
[0m23:33:19.628562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:33:19.640946 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m23:33:19.641780 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:19.642610 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:33:19.649439 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m23:33:19.653114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7549bd750>]}
[0m23:33:19.654020 [debug] [MainThread]: On master: ROLLBACK
[0m23:33:19.655161 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:19.655899 [debug] [MainThread]: On master: BEGIN
[0m23:33:19.657240 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:33:19.658001 [debug] [MainThread]: On master: COMMIT
[0m23:33:19.658712 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:19.659390 [debug] [MainThread]: On master: COMMIT
[0m23:33:19.660495 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:33:19.661337 [debug] [MainThread]: On master: Close
[0m23:33:19.665471 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m23:33:19.666705 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m23:33:19.667821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m23:33:19.668729 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m23:33:19.685970 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m23:33:19.687217 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m23:33:19.766005 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m23:33:19.767379 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:33:19.768224 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m23:33:19.769052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:33:19.781347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m23:33:19.782282 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:33:19.783102 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m23:33:19.800470 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.016 seconds
[0m23:33:19.814106 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:33:19.815073 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m23:33:19.816806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:33:19.852578 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m23:33:19.853511 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:33:19.854283 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m23:33:19.857552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m23:33:19.870112 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m23:33:19.878991 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:33:19.879905 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m23:33:19.881338 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m23:33:19.886111 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m23:33:19.889639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f754a5aa40>]}
[0m23:33:19.891039 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.22s]
[0m23:33:19.892375 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m23:33:19.894157 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m23:33:19.895306 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m23:33:19.896458 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m23:33:19.897445 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m23:33:19.903638 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m23:33:19.905175 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m23:33:19.946244 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m23:33:19.947608 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:33:19.948511 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m23:33:19.949302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:33:19.962022 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m23:33:19.963660 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:33:19.964605 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)
select
to_date(order_date, 'DD-MM-YYYY'),
movement,
market,
expire_date,
brokerage_firm,
ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m23:33:19.971490 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m23:33:19.979567 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:33:19.980573 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m23:33:19.982039 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:33:19.985253 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m23:33:19.986158 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:33:19.986930 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m23:33:19.988829 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:33:19.993966 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m23:33:19.999174 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:33:20.000069 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m23:33:20.001373 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m23:33:20.003988 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m23:33:20.005420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b08eac48-beaf-489f-bcc8-75060ab2b819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f754a5aa40>]}
[0m23:33:20.006847 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m23:33:20.008212 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m23:33:20.011128 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.011980 [debug] [MainThread]: On master: BEGIN
[0m23:33:20.012659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:33:20.024961 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m23:33:20.025906 [debug] [MainThread]: On master: COMMIT
[0m23:33:20.026672 [debug] [MainThread]: Using postgres connection "master"
[0m23:33:20.027354 [debug] [MainThread]: On master: COMMIT
[0m23:33:20.028344 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:33:20.029094 [debug] [MainThread]: On master: Close
[0m23:33:20.030270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:33:20.031273 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m23:33:20.032220 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m23:33:20.033191 [info ] [MainThread]: 
[0m23:33:20.034188 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m23:33:20.035988 [debug] [MainThread]: Command end result
[0m23:33:20.075286 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m23:33:20.078480 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m23:33:20.090986 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m23:33:20.091818 [info ] [MainThread]: 
[0m23:33:20.092902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:33:20.093872 [info ] [MainThread]: 
[0m23:33:20.094824 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:33:20.096649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5231738, "process_in_blocks": "0", "process_kernel_time": 0.271797, "process_mem_max_rss": "115888", "process_out_blocks": "2584", "process_user_time": 4.456679}
[0m23:33:20.097603 [debug] [MainThread]: Command `dbt run` succeeded at 23:33:20.097434 after 2.52 seconds
[0m23:33:20.098701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f756744eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f75760e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72f7549d7f70>]}
[0m23:33:20.099702 [debug] [MainThread]: Flushing usage events
[0m23:33:21.150859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:14.533378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba68dd4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba69c6a3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba69c6a350>]}


============================== 08:37:14.538452 | ad4ba9b1-cfb0-4265-ad41-45937c1eb678 ==============================
[0m08:37:14.538452 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:37:14.539685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/projects/b3_new', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:37:14.855420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba67daf9a0>]}
[0m08:37:14.966837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba69c5a140>]}
[0m08:37:14.968250 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:37:15.163777 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:37:15.388711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:37:15.389852 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m08:37:15.901245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.b3_new.silver
[0m08:37:15.932727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba66fd20e0>]}
[0m08:37:16.094347 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m08:37:16.100123 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m08:37:16.117095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba671de1d0>]}
[0m08:37:16.118145 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m08:37:16.118916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba671de230>]}
[0m08:37:16.121722 [info ] [MainThread]: 
[0m08:37:16.122564 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:37:16.123237 [info ] [MainThread]: 
[0m08:37:16.124313 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:37:16.137298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:37:16.201347 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:37:16.202193 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:37:16.202873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:16.218613 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m08:37:16.220991 [debug] [ThreadPool]: On list_foo: Close
[0m08:37:16.223997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m08:37:16.236595 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m08:37:16.237508 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m08:37:16.238186 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:37:16.250145 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m08:37:16.251007 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m08:37:16.251752 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:37:16.256261 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m08:37:16.260036 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m08:37:16.261159 [debug] [ThreadPool]: On list_foo_public: Close
[0m08:37:16.272686 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:16.273517 [debug] [MainThread]: On master: BEGIN
[0m08:37:16.274180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:16.287231 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m08:37:16.288100 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:16.288929 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:37:16.296224 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m08:37:16.300530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba66b1d390>]}
[0m08:37:16.301435 [debug] [MainThread]: On master: ROLLBACK
[0m08:37:16.302565 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:16.303291 [debug] [MainThread]: On master: BEGIN
[0m08:37:16.304569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:37:16.305348 [debug] [MainThread]: On master: COMMIT
[0m08:37:16.306061 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:16.306749 [debug] [MainThread]: On master: COMMIT
[0m08:37:16.307893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:16.308666 [debug] [MainThread]: On master: Close
[0m08:37:16.313104 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m08:37:16.314768 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m08:37:16.315922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m08:37:16.316802 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m08:37:16.333138 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m08:37:16.334372 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m08:37:16.474121 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m08:37:16.475477 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:37:16.476315 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m08:37:16.477077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:16.488767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m08:37:16.489683 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:37:16.490588 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m08:37:16.496264 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m08:37:16.508652 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:37:16.509720 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m08:37:16.511298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:37:16.517493 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:37:16.518386 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m08:37:16.519865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:37:16.559582 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m08:37:16.560651 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:37:16.561557 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m08:37:16.564705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:37:16.577897 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m08:37:16.587088 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:37:16.588040 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m08:37:16.593415 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:37:16.598320 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m08:37:16.602966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba69dbab00>]}
[0m08:37:16.604712 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.28s]
[0m08:37:16.606107 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m08:37:16.607978 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m08:37:16.609090 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m08:37:16.610357 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m08:37:16.611246 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m08:37:16.617864 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m08:37:16.619388 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m08:37:16.660742 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m08:37:16.662078 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:37:16.663087 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m08:37:16.664071 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:37:16.676987 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m08:37:16.677906 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:37:16.678802 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY'),
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY'),
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m08:37:16.682445 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "to_date" specified more than once

[0m08:37:16.683483 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: ROLLBACK
[0m08:37:16.684755 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m08:37:16.688103 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "to_date" specified more than once
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m08:37:16.689290 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad4ba9b1-cfb0-4265-ad41-45937c1eb678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba67059b10>]}
[0m08:37:16.690639 [error] [Thread-3 (]: 2 of 2 ERROR creating sql view model public.int_b3_ops ......................... [[31mERROR[0m in 0.08s]
[0m08:37:16.692160 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m08:37:16.693331 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "to_date" specified more than once
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql.
[0m08:37:16.697268 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:16.698415 [debug] [MainThread]: On master: BEGIN
[0m08:37:16.699271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:37:16.711815 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:37:16.712668 [debug] [MainThread]: On master: COMMIT
[0m08:37:16.713358 [debug] [MainThread]: Using postgres connection "master"
[0m08:37:16.714096 [debug] [MainThread]: On master: COMMIT
[0m08:37:16.715133 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:37:16.715913 [debug] [MainThread]: On master: Close
[0m08:37:16.716965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:16.717704 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m08:37:16.718366 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m08:37:16.719500 [info ] [MainThread]: 
[0m08:37:16.720905 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m08:37:16.722914 [debug] [MainThread]: Command end result
[0m08:37:16.762451 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m08:37:16.765180 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m08:37:16.778401 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m08:37:16.779276 [info ] [MainThread]: 
[0m08:37:16.780149 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:37:16.780966 [info ] [MainThread]: 
[0m08:37:16.781842 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "to_date" specified more than once
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m08:37:16.782594 [info ] [MainThread]: 
[0m08:37:16.783342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:37:16.784984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.362396, "process_in_blocks": "0", "process_kernel_time": 0.271782, "process_mem_max_rss": "114528", "process_out_blocks": "2584", "process_user_time": 4.527375}
[0m08:37:16.786200 [debug] [MainThread]: Command `dbt run` failed at 08:37:16.785862 after 2.36 seconds
[0m08:37:16.787443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba68dd4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba67634e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eba67608fd0>]}
[0m08:37:16.788365 [debug] [MainThread]: Flushing usage events
[0m08:37:17.877713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:54:51.022469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e855d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e8646a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e8646a3b0>]}


============================== 08:54:51.027026 | 47be7c89-1899-4a0c-ae3e-de824787fdc3 ==============================
[0m08:54:51.027026 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:54:51.028136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:54:51.337618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e845e8580>]}
[0m08:54:51.450071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e84dc0970>]}
[0m08:54:51.451516 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:54:51.646653 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:54:51.876567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:54:51.877683 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m08:54:52.361058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.b3_new.silver
[0m08:54:52.391498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e837d2110>]}
[0m08:54:52.550601 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m08:54:52.556677 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m08:54:52.574463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e839dd690>]}
[0m08:54:52.575497 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m08:54:52.576240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e839dfac0>]}
[0m08:54:52.579131 [info ] [MainThread]: 
[0m08:54:52.579990 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:54:52.580724 [info ] [MainThread]: 
[0m08:54:52.582049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:54:52.592847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:54:52.658827 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:54:52.659681 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:54:52.660354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:52.675748 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m08:54:52.678455 [debug] [ThreadPool]: On list_foo: Close
[0m08:54:52.681289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m08:54:52.693559 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m08:54:52.694377 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m08:54:52.695035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:54:52.707934 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m08:54:52.709039 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m08:54:52.709937 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:54:52.715106 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m08:54:52.717666 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m08:54:52.718792 [debug] [ThreadPool]: On list_foo_public: Close
[0m08:54:52.729558 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:52.730530 [debug] [MainThread]: On master: BEGIN
[0m08:54:52.731311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:54:52.743750 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:54:52.744648 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:52.745472 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:54:52.751909 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m08:54:52.754597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e83320d90>]}
[0m08:54:52.755500 [debug] [MainThread]: On master: ROLLBACK
[0m08:54:52.756520 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:52.757229 [debug] [MainThread]: On master: BEGIN
[0m08:54:52.758315 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:54:52.759048 [debug] [MainThread]: On master: COMMIT
[0m08:54:52.759743 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:52.760398 [debug] [MainThread]: On master: COMMIT
[0m08:54:52.761312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:54:52.762105 [debug] [MainThread]: On master: Close
[0m08:54:52.766479 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m08:54:52.767698 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m08:54:52.768771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m08:54:52.769621 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m08:54:52.786018 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m08:54:52.787228 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m08:54:52.929555 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m08:54:52.930957 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:54:52.931973 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m08:54:52.932788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:52.944171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m08:54:52.945113 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:54:52.945929 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m08:54:52.951822 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m08:54:52.964731 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:54:52.965868 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m08:54:52.967254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:54:52.973357 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:54:52.974271 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m08:54:52.975593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:54:53.015866 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m08:54:53.016809 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:54:53.017597 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m08:54:53.020698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:54:53.033185 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m08:54:53.042382 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:54:53.043286 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m08:54:53.047805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:54:53.052782 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m08:54:53.057193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e865bab30>]}
[0m08:54:53.058932 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.29s]
[0m08:54:53.060335 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m08:54:53.061709 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m08:54:53.062811 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m08:54:53.064925 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m08:54:53.066155 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m08:54:53.072564 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m08:54:53.074010 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m08:54:53.115847 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m08:54:53.117336 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:54:53.118214 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m08:54:53.118968 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:54:53.131705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m08:54:53.132622 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:54:53.133423 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m08:54:53.140286 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m08:54:53.146985 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:54:53.147950 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m08:54:53.149713 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:54:53.152850 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m08:54:53.153732 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:54:53.154502 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m08:54:53.156581 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m08:54:53.161736 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m08:54:53.166965 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:54:53.167911 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m08:54:53.169143 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:54:53.171733 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m08:54:53.173108 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47be7c89-1899-4a0c-ae3e-de824787fdc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e83987ca0>]}
[0m08:54:53.174476 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m08:54:53.175798 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m08:54:53.178612 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:53.179440 [debug] [MainThread]: On master: BEGIN
[0m08:54:53.180187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:54:53.192223 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:54:53.193059 [debug] [MainThread]: On master: COMMIT
[0m08:54:53.193760 [debug] [MainThread]: Using postgres connection "master"
[0m08:54:53.194424 [debug] [MainThread]: On master: COMMIT
[0m08:54:53.195465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:54:53.196211 [debug] [MainThread]: On master: Close
[0m08:54:53.197898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:53.198812 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m08:54:53.199813 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m08:54:53.201095 [info ] [MainThread]: 
[0m08:54:53.202100 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m08:54:53.203758 [debug] [MainThread]: Command end result
[0m08:54:53.243578 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m08:54:53.246561 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m08:54:53.259953 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m08:54:53.260767 [info ] [MainThread]: 
[0m08:54:53.261644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:54:53.262375 [info ] [MainThread]: 
[0m08:54:53.263221 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:54:53.265132 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3500724, "process_in_blocks": "0", "process_kernel_time": 0.253161, "process_mem_max_rss": "114432", "process_out_blocks": "2576", "process_user_time": 4.286729}
[0m08:54:53.266099 [debug] [MainThread]: Command `dbt run` succeeded at 08:54:53.265939 after 2.35 seconds
[0m08:54:53.266859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e855d4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e85499a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710e839dfd60>]}
[0m08:54:53.267650 [debug] [MainThread]: Flushing usage events
[0m08:54:54.117831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:43.395263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82fbd4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d830a6a380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d830a6a320>]}


============================== 08:55:43.400071 | a95b74fd-130b-4bf6-9582-b9ca7bcdee49 ==============================
[0m08:55:43.400071 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:55:43.401367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:43.738362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d830bbb7f0>]}
[0m08:55:43.867644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82f3c1990>]}
[0m08:55:43.869550 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:55:44.076938 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:55:44.315332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:55:44.316201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:55:44.329585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.b3_new.silver
[0m08:55:44.407063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82de4e6e0>]}
[0m08:55:44.579098 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m08:55:44.584943 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m08:55:44.603974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82dfdf640>]}
[0m08:55:44.605093 [info ] [MainThread]: Found 2 models, 1 source, 431 macros
[0m08:55:44.606045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82dfde470>]}
[0m08:55:44.608996 [info ] [MainThread]: 
[0m08:55:44.609861 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m08:55:44.610596 [info ] [MainThread]: 
[0m08:55:44.611764 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:55:44.622499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m08:55:44.690674 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m08:55:44.691516 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m08:55:44.692276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:44.708053 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m08:55:44.710468 [debug] [ThreadPool]: On list_foo: Close
[0m08:55:44.713341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m08:55:44.725579 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m08:55:44.726399 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m08:55:44.727075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:44.740108 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m08:55:44.740931 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m08:55:44.741661 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:55:44.746900 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m08:55:44.750377 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m08:55:44.751667 [debug] [ThreadPool]: On list_foo_public: Close
[0m08:55:44.762828 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:44.763660 [debug] [MainThread]: On master: BEGIN
[0m08:55:44.764311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:44.776019 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:55:44.776851 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:44.777840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:55:44.785403 [debug] [MainThread]: SQL status: SELECT 2 in 0.006 seconds
[0m08:55:44.790343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82de96f20>]}
[0m08:55:44.791643 [debug] [MainThread]: On master: ROLLBACK
[0m08:55:44.793089 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:44.793905 [debug] [MainThread]: On master: BEGIN
[0m08:55:44.795123 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:55:44.795883 [debug] [MainThread]: On master: COMMIT
[0m08:55:44.796592 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:44.797231 [debug] [MainThread]: On master: COMMIT
[0m08:55:44.798306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:55:44.799249 [debug] [MainThread]: On master: Close
[0m08:55:44.803472 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m08:55:44.804708 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m08:55:44.805805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m08:55:44.806695 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m08:55:44.824199 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m08:55:44.825510 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m08:55:44.904691 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m08:55:44.906129 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:55:44.906991 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m08:55:44.907795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:44.920900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m08:55:44.921855 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:55:44.922757 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m08:55:44.929310 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m08:55:44.942310 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:55:44.943281 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m08:55:44.944806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:55:44.951871 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:55:44.953144 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m08:55:44.954738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:55:44.996356 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m08:55:44.997336 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:55:44.998404 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m08:55:45.000884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:55:45.013560 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m08:55:45.023839 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m08:55:45.024789 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m08:55:45.029697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:55:45.035310 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m08:55:45.039185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82d7977f0>]}
[0m08:55:45.040736 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.23s]
[0m08:55:45.042288 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m08:55:45.044050 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m08:55:45.045315 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m08:55:45.046756 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m08:55:45.047914 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m08:55:45.058336 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m08:55:45.059588 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m08:55:45.100177 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m08:55:45.101888 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:55:45.102894 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m08:55:45.103677 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:55:45.116527 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m08:55:45.117842 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:55:45.118807 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m08:55:45.125017 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m08:55:45.131945 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:55:45.133150 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m08:55:45.135246 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:55:45.138535 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m08:55:45.139420 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:55:45.140355 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m08:55:45.142606 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m08:55:45.148278 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m08:55:45.153904 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m08:55:45.154817 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m08:55:45.156183 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:55:45.158763 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m08:55:45.160133 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a95b74fd-130b-4bf6-9582-b9ca7bcdee49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82fe90b20>]}
[0m08:55:45.161517 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m08:55:45.162978 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m08:55:45.165197 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:45.166113 [debug] [MainThread]: On master: BEGIN
[0m08:55:45.167056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:55:45.179254 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m08:55:45.180694 [debug] [MainThread]: On master: COMMIT
[0m08:55:45.181798 [debug] [MainThread]: Using postgres connection "master"
[0m08:55:45.183028 [debug] [MainThread]: On master: COMMIT
[0m08:55:45.184410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:55:45.185383 [debug] [MainThread]: On master: Close
[0m08:55:45.186552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:45.187305 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m08:55:45.188062 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m08:55:45.188909 [info ] [MainThread]: 
[0m08:55:45.189762 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m08:55:45.191496 [debug] [MainThread]: Command end result
[0m08:55:45.295489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m08:55:45.298388 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m08:55:45.311983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m08:55:45.312807 [info ] [MainThread]: 
[0m08:55:45.313776 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:55:45.314731 [info ] [MainThread]: 
[0m08:55:45.315728 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:55:45.317744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0351968, "process_in_blocks": "0", "process_kernel_time": 0.275908, "process_mem_max_rss": "111292", "process_out_blocks": "1752", "process_user_time": 4.022659}
[0m08:55:45.319047 [debug] [MainThread]: Command `dbt run` succeeded at 08:55:45.318715 after 2.04 seconds
[0m08:55:45.320419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82fbd4df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d8324635e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77d82e40baf0>]}
[0m08:55:45.321845 [debug] [MainThread]: Flushing usage events
[0m08:55:46.226824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:02.008097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bc8bb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bc90f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bc90f210>]}


============================== 20:25:02.013857 | 377d6358-829a-4f98-8fab-58253270f1e3 ==============================
[0m20:25:02.013857 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:25:02.015045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:25:02.276996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bc8b9c90>]}
[0m20:25:02.371373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bf354210>]}
[0m20:25:02.373911 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:25:02.556605 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:25:02.693248 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:25:02.694088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093beed2c50>]}
[0m20:25:04.409370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.b3_new.int_b3_ops
- models.b3_new.stg_b3_ops
[0m20:25:04.430205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bc215090>]}
[0m20:25:04.548345 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:25:04.553725 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:25:04.597572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bbcc5350>]}
[0m20:25:04.598503 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:25:04.599187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bbd91f50>]}
[0m20:25:04.601955 [info ] [MainThread]: 
[0m20:25:04.602679 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:25:04.603245 [info ] [MainThread]: 
[0m20:25:04.604141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:25:04.611729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:25:04.680700 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:25:04.681411 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:25:04.681995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:04.696449 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m20:25:04.699036 [debug] [ThreadPool]: On list_foo: Close
[0m20:25:04.701773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:25:04.711930 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:25:04.712629 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:25:04.713166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:04.724751 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m20:25:04.725472 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:25:04.726517 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:25:04.738029 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m20:25:04.741029 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:25:04.742191 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:25:04.751283 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:04.751996 [debug] [MainThread]: On master: BEGIN
[0m20:25:04.752542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:04.764936 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:25:04.765731 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:04.766811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:25:04.775301 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m20:25:04.778061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bbc86310>]}
[0m20:25:04.778847 [debug] [MainThread]: On master: ROLLBACK
[0m20:25:04.779824 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:04.780450 [debug] [MainThread]: On master: BEGIN
[0m20:25:04.781625 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:25:04.782268 [debug] [MainThread]: On master: COMMIT
[0m20:25:04.782871 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:04.783422 [debug] [MainThread]: On master: COMMIT
[0m20:25:04.784305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:04.784955 [debug] [MainThread]: On master: Close
[0m20:25:04.789831 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:25:04.790825 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:25:04.791705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:25:04.792424 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:25:04.807417 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:25:04.808748 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:25:04.869122 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:25:04.870325 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:04.870987 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:25:04.871606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:04.884146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:25:04.885111 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:04.886075 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:25:04.899697 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m20:25:04.910541 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:04.911290 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:25:04.912711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:04.917897 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:04.918670 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:25:04.920155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:04.948240 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:25:04.949043 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:04.949691 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:25:04.952805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:04.964084 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:25:04.972926 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:04.973674 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:25:04.979521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m20:25:04.984611 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:25:04.987933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bb191d50>]}
[0m20:25:04.989125 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m20:25:04.990262 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:25:04.991777 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:25:04.993042 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:25:04.994067 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:25:04.994813 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:25:05.005896 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:25:05.007343 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:25:05.014672 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:25:05.016061 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:05.016952 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:25:05.017793 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:25:05.029843 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:25:05.030620 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:05.031283 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:25:05.043705 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:25:05.050205 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:05.050955 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:25:05.052491 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:05.054999 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:25:05.055798 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:05.056521 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:25:05.058706 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:25:05.062886 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:25:05.068176 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:05.068935 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:25:05.070163 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:25:05.072350 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:25:05.073439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377d6358-829a-4f98-8fab-58253270f1e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bb14afd0>]}
[0m20:25:05.074514 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:25:05.075625 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:25:05.078102 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:05.078811 [debug] [MainThread]: On master: BEGIN
[0m20:25:05.079368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:05.093703 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m20:25:05.094638 [debug] [MainThread]: On master: COMMIT
[0m20:25:05.095516 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:05.096087 [debug] [MainThread]: On master: COMMIT
[0m20:25:05.097023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:05.097686 [debug] [MainThread]: On master: Close
[0m20:25:05.098629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:05.099490 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:25:05.100172 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:25:05.101105 [info ] [MainThread]: 
[0m20:25:05.102159 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m20:25:05.103858 [debug] [MainThread]: Command end result
[0m20:25:05.132669 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:25:05.135974 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:25:05.145287 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:25:05.145944 [info ] [MainThread]: 
[0m20:25:05.146637 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:05.147254 [info ] [MainThread]: 
[0m20:25:05.147918 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:25:05.149650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.227956, "process_in_blocks": "51744", "process_kernel_time": 0.54877, "process_mem_max_rss": "121980", "process_out_blocks": "2592", "process_user_time": 4.993013}
[0m20:25:05.150498 [debug] [MainThread]: Command `dbt run` succeeded at 20:25:05.150344 after 3.23 seconds
[0m20:25:05.151137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bcbb7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093bc8abfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7093c0ab5ad0>]}
[0m20:25:05.151877 [debug] [MainThread]: Flushing usage events
[0m20:25:10.617275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:06.509772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac5f0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac5f0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac5f14d0>]}


============================== 20:26:06.514882 | d3eca3e0-668c-4f01-a3fb-b52c8360a5e1 ==============================
[0m20:26:06.514882 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:26:06.515867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:26:06.765507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac632f50>]}
[0m20:26:06.857498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac61c1d0>]}
[0m20:26:06.858790 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:26:07.022792 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:26:07.160861 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:26:07.161677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77accaea50>]}
[0m20:26:08.842823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging.stg_b3_ops
- models.staging.int_b3_ops
[0m20:26:08.862725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77abab2b10>]}
[0m20:26:08.974911 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:26:08.979373 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:26:08.997083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ab97e4d0>]}
[0m20:26:08.997982 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:26:08.998626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77abaea150>]}
[0m20:26:09.001424 [info ] [MainThread]: 
[0m20:26:09.002413 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:26:09.003291 [info ] [MainThread]: 
[0m20:26:09.004433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:09.012915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:26:09.078423 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:26:09.079126 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:26:09.079700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:09.097853 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m20:26:09.100149 [debug] [ThreadPool]: On list_foo: Close
[0m20:26:09.102758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:26:09.112606 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:26:09.113282 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:26:09.113859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:09.126907 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:26:09.127610 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:26:09.128177 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:26:09.132984 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:26:09.135860 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:26:09.137005 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:26:09.146924 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:09.147637 [debug] [MainThread]: On master: BEGIN
[0m20:26:09.148170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:09.159995 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:26:09.160962 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:09.161940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:09.169748 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m20:26:09.173260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77accab590>]}
[0m20:26:09.174103 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:09.175078 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:09.175791 [debug] [MainThread]: On master: BEGIN
[0m20:26:09.176926 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:26:09.177628 [debug] [MainThread]: On master: COMMIT
[0m20:26:09.178218 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:09.178865 [debug] [MainThread]: On master: COMMIT
[0m20:26:09.179964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:26:09.180768 [debug] [MainThread]: On master: Close
[0m20:26:09.185016 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:26:09.186034 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:26:09.186974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:26:09.187712 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:26:09.199933 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:26:09.201382 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:26:09.260543 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:26:09.261731 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:26:09.262421 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:26:09.263038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:09.274482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:26:09.275353 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:26:09.276014 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:26:09.279286 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:26:09.290073 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:26:09.290851 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:26:09.292221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:26:09.297398 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:26:09.298124 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:26:09.299618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:26:09.326426 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:26:09.327201 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:26:09.327838 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:26:09.329942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:26:09.340649 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:26:09.350391 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:26:09.351146 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:26:09.355589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:26:09.359648 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:26:09.362504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77aaf49050>]}
[0m20:26:09.363745 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.17s]
[0m20:26:09.364943 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:26:09.366402 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:26:09.367936 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:26:09.369040 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:26:09.369761 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:26:09.377472 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:26:09.378723 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:26:09.386071 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:26:09.387379 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:26:09.388076 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:26:09.388724 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:26:09.401577 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m20:26:09.402853 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:26:09.403673 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:26:09.408171 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m20:26:09.414688 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:26:09.415535 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:26:09.417174 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:26:09.419783 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:26:09.420536 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:26:09.421170 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:26:09.423148 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:26:09.427904 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:26:09.429383 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:26:09.430069 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:26:09.431294 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:26:09.433513 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:26:09.434611 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3eca3e0-668c-4f01-a3fb-b52c8360a5e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77aaeb4fd0>]}
[0m20:26:09.435716 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:26:09.436833 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:26:09.439191 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:09.439888 [debug] [MainThread]: On master: BEGIN
[0m20:26:09.440454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:09.453737 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:26:09.454502 [debug] [MainThread]: On master: COMMIT
[0m20:26:09.455087 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:09.455682 [debug] [MainThread]: On master: COMMIT
[0m20:26:09.456531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:26:09.457140 [debug] [MainThread]: On master: Close
[0m20:26:09.458111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:09.458949 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:26:09.459710 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:26:09.460671 [info ] [MainThread]: 
[0m20:26:09.461534 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:26:09.463117 [debug] [MainThread]: Command end result
[0m20:26:09.492221 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:26:09.494672 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:26:09.505054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:26:09.505722 [info ] [MainThread]: 
[0m20:26:09.506442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:09.507085 [info ] [MainThread]: 
[0m20:26:09.507775 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:26:09.509292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0833905, "process_in_blocks": "0", "process_kernel_time": 0.508843, "process_mem_max_rss": "122060", "process_out_blocks": "2600", "process_user_time": 4.866935}
[0m20:26:09.510090 [debug] [MainThread]: Command `dbt run` succeeded at 20:26:09.509942 after 3.08 seconds
[0m20:26:09.510828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac611dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77ac7d6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a77b07b5a90>]}
[0m20:26:09.511506 [debug] [MainThread]: Flushing usage events
[0m20:26:11.761734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:43.679742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86a833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86c9e410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86c9e350>]}


============================== 20:27:43.684802 | 0dceaff4-1dfb-4f82-b5dd-7b93b2031618 ==============================
[0m20:27:43.684802 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:27:43.685824 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:27:43.936955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86adf590>]}
[0m20:27:44.029466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86adc1d0>]}
[0m20:27:44.030756 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:27:44.193206 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:27:44.328961 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:27:44.329789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c87172a50>]}
[0m20:27:46.018328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.intermediate.int_b3_ops
- models.staging.stg_b3_ops
[0m20:27:46.039085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c85f51290>]}
[0m20:27:46.155883 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:27:46.160348 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:27:46.177257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c85d548d0>]}
[0m20:27:46.178123 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:27:46.178784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c85e6c450>]}
[0m20:27:46.181664 [info ] [MainThread]: 
[0m20:27:46.182465 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:27:46.183114 [info ] [MainThread]: 
[0m20:27:46.184138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:27:46.191528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:27:46.252150 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:27:46.252861 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:27:46.253452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:46.267881 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m20:27:46.270008 [debug] [ThreadPool]: On list_foo: Close
[0m20:27:46.272915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:27:46.283136 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:27:46.283896 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:27:46.284498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:46.296570 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:27:46.297282 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:27:46.297947 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:27:46.303031 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:27:46.305943 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:27:46.306936 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:27:46.316704 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:46.317403 [debug] [MainThread]: On master: BEGIN
[0m20:27:46.317953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:46.330746 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:27:46.331454 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:46.332129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:27:46.339088 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m20:27:46.343173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c859320d0>]}
[0m20:27:46.343958 [debug] [MainThread]: On master: ROLLBACK
[0m20:27:46.344947 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:46.345604 [debug] [MainThread]: On master: BEGIN
[0m20:27:46.346645 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:27:46.347256 [debug] [MainThread]: On master: COMMIT
[0m20:27:46.347831 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:46.348398 [debug] [MainThread]: On master: COMMIT
[0m20:27:46.349294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:46.349939 [debug] [MainThread]: On master: Close
[0m20:27:46.354574 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:27:46.355607 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:27:46.356527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:27:46.357232 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:27:46.370229 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:27:46.371573 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:27:46.430266 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:27:46.431492 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:27:46.432194 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:27:46.432852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:46.445211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:27:46.446015 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:27:46.446706 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:27:46.449713 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:27:46.460422 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:27:46.461184 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:27:46.462791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:46.467948 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:27:46.468704 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:27:46.470161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:46.497367 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:27:46.498165 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:27:46.498928 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:27:46.501085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:27:46.511486 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:27:46.520420 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:27:46.521172 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:27:46.525558 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:27:46.529649 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:27:46.532690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c85392a50>]}
[0m20:27:46.533875 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.17s]
[0m20:27:46.534948 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:27:46.536799 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:27:46.538460 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:27:46.539621 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:27:46.540428 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:27:46.548624 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:27:46.549998 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:27:46.556538 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:27:46.557649 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:27:46.558334 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:27:46.558976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:27:46.570966 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:27:46.572212 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:27:46.572919 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:27:46.576509 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:27:46.582607 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:27:46.583370 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:27:46.584854 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:46.587546 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:27:46.588246 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:27:46.588905 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:27:46.592039 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:27:46.596982 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:27:46.598652 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:27:46.599391 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:27:46.600563 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:27:46.602733 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:27:46.603837 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dceaff4-1dfb-4f82-b5dd-7b93b2031618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c8528c610>]}
[0m20:27:46.604949 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:27:46.606121 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:27:46.608825 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:46.609601 [debug] [MainThread]: On master: BEGIN
[0m20:27:46.610139 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:46.622888 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:27:46.624060 [debug] [MainThread]: On master: COMMIT
[0m20:27:46.624674 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:46.625333 [debug] [MainThread]: On master: COMMIT
[0m20:27:46.626236 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:46.626928 [debug] [MainThread]: On master: Close
[0m20:27:46.627843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:46.628458 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:27:46.628969 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:27:46.629749 [info ] [MainThread]: 
[0m20:27:46.630461 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:27:46.632144 [debug] [MainThread]: Command end result
[0m20:27:46.662258 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:27:46.665013 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:27:46.675120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:27:46.675784 [info ] [MainThread]: 
[0m20:27:46.676576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:46.677195 [info ] [MainThread]: 
[0m20:27:46.677902 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:27:46.679411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.083323, "process_in_blocks": "0", "process_kernel_time": 0.448682, "process_mem_max_rss": "122108", "process_out_blocks": "2600", "process_user_time": 4.932511}
[0m20:27:46.680164 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:46.680018 after 3.08 seconds
[0m20:27:46.680902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86c9e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86ad7ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714c86a82550>]}
[0m20:27:46.681880 [debug] [MainThread]: Flushing usage events
[0m20:27:48.331000 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:25.374614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114deff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114def7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770116952fd0>]}


============================== 20:28:25.379628 | ea5100e1-f3df-48a4-9290-f9a96a6c3799 ==============================
[0m20:28:25.379628 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:28:25.380901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:28:25.627715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114defe50>]}
[0m20:28:25.720527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770117834810>]}
[0m20:28:25.721809 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:28:25.882602 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:28:26.043737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:26.044427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:26.053650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.intermediate.int_b3_ops
- models.staging.stg_b3_ops
[0m20:28:26.106326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7701145c5850>]}
[0m20:28:26.220757 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:28:26.225048 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:28:26.241742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114bff890>]}
[0m20:28:26.242635 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:28:26.243290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7701146aac10>]}
[0m20:28:26.245953 [info ] [MainThread]: 
[0m20:28:26.246724 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:28:26.247421 [info ] [MainThread]: 
[0m20:28:26.248503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:26.256160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:28:26.319983 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:28:26.320699 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:28:26.321250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:26.335740 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m20:28:26.337832 [debug] [ThreadPool]: On list_foo: Close
[0m20:28:26.340549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:28:26.350512 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:28:26.351202 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:28:26.351767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:26.363904 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:28:26.364601 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:28:26.365181 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:28:26.370372 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:28:26.372743 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:28:26.373725 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:28:26.383833 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:26.384578 [debug] [MainThread]: On master: BEGIN
[0m20:28:26.385192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:26.396919 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:28:26.397627 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:26.398292 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:28:26.405277 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m20:28:26.409294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114b8e750>]}
[0m20:28:26.410129 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:26.411157 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:26.411834 [debug] [MainThread]: On master: BEGIN
[0m20:28:26.413069 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:28:26.413772 [debug] [MainThread]: On master: COMMIT
[0m20:28:26.414369 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:26.414985 [debug] [MainThread]: On master: COMMIT
[0m20:28:26.415973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:26.416694 [debug] [MainThread]: On master: Close
[0m20:28:26.421237 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:28:26.422363 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:28:26.423394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:28:26.424129 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:28:26.437525 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:28:26.438859 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:28:26.498664 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:28:26.499937 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:28:26.500664 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:28:26.501314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:26.513837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:28:26.514613 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:28:26.515286 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:28:26.518398 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:28:26.529288 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:28:26.530069 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:28:26.531907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:26.537076 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:28:26.537806 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:28:26.539415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:26.567050 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:28:26.567992 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:28:26.568708 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:28:26.570490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:26.580700 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:28:26.589540 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:28:26.590296 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:28:26.595428 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:26.600712 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:28:26.603608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114b6f7d0>]}
[0m20:28:26.604841 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:28:26.605985 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:28:26.607445 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:28:26.608381 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:28:26.609388 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:28:26.610066 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:28:26.617517 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:28:26.618735 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:28:26.626065 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:28:26.627214 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:28:26.627953 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:28:26.628589 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:28:26.640976 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:28:26.642214 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:28:26.642898 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:28:26.646799 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:28:26.652489 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:28:26.653224 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:28:26.654829 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:26.657752 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:28:26.658468 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:28:26.659096 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:28:26.662009 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:28:26.666892 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:28:26.668425 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:28:26.669106 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:28:26.670206 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:28:26.672388 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:28:26.673468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea5100e1-f3df-48a4-9290-f9a96a6c3799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77011394d150>]}
[0m20:28:26.674553 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:28:26.675611 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:28:26.677953 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:26.678734 [debug] [MainThread]: On master: BEGIN
[0m20:28:26.679351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:26.692403 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:28:26.693106 [debug] [MainThread]: On master: COMMIT
[0m20:28:26.693759 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:26.694325 [debug] [MainThread]: On master: COMMIT
[0m20:28:26.695158 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:26.695787 [debug] [MainThread]: On master: Close
[0m20:28:26.696775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:26.697762 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:28:26.698649 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:28:26.699696 [info ] [MainThread]: 
[0m20:28:26.700774 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:28:26.702669 [debug] [MainThread]: Command end result
[0m20:28:26.732017 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:28:26.735128 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:28:26.744674 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:28:26.745341 [info ] [MainThread]: 
[0m20:28:26.746031 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:26.746695 [info ] [MainThread]: 
[0m20:28:26.747539 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:28:26.749229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4587767, "process_in_blocks": "0", "process_kernel_time": 0.46842, "process_mem_max_rss": "118616", "process_out_blocks": "1760", "process_user_time": 3.264992}
[0m20:28:26.750064 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:26.749881 after 1.46 seconds
[0m20:28:26.750815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114def510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770114ba9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770118fb6510>]}
[0m20:28:26.751624 [debug] [MainThread]: Flushing usage events
[0m20:28:28.469556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:09.560011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbac1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbcd6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbcd6350>]}


============================== 20:30:09.564896 | 7412747d-c831-4dba-803e-c3e35891e726 ==============================
[0m20:30:09.564896 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:30:09.566122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:30:09.816082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbb0ed10>]}
[0m20:30:09.912591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fe518750>]}
[0m20:30:09.913962 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:30:10.081262 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:30:10.241860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:30:10.242562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:30:10.251858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging.stg_b3_ops
- models.intermediate.int_b3_ops
[0m20:30:10.306654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fafef110>]}
[0m20:30:10.422710 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:30:10.427015 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:30:10.443115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fb593a10>]}
[0m20:30:10.443992 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:30:10.444626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440faf89690>]}
[0m20:30:10.447180 [info ] [MainThread]: 
[0m20:30:10.447903 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:30:10.448512 [info ] [MainThread]: 
[0m20:30:10.449421 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:30:10.459126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:30:10.523894 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:30:10.524616 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:30:10.525207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:30:10.543661 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m20:30:10.546039 [debug] [ThreadPool]: On list_foo: Close
[0m20:30:10.549461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:30:10.559902 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:30:10.560613 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:30:10.561162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:30:10.574010 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:30:10.574774 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:30:10.575381 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:30:10.580253 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:30:10.583873 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:30:10.585046 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:30:10.594553 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.595272 [debug] [MainThread]: On master: BEGIN
[0m20:30:10.595861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:10.608512 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:30:10.609537 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.610256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:30:10.618519 [debug] [MainThread]: SQL status: SELECT 3 in 0.007 seconds
[0m20:30:10.622696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbaf3890>]}
[0m20:30:10.623494 [debug] [MainThread]: On master: ROLLBACK
[0m20:30:10.624481 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.625106 [debug] [MainThread]: On master: BEGIN
[0m20:30:10.626286 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:30:10.626953 [debug] [MainThread]: On master: COMMIT
[0m20:30:10.627550 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.628109 [debug] [MainThread]: On master: COMMIT
[0m20:30:10.628977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:30:10.629634 [debug] [MainThread]: On master: Close
[0m20:30:10.633803 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:30:10.634864 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:30:10.635826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:30:10.636554 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:30:10.649003 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:30:10.650502 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:30:10.709859 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:30:10.711139 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:30:10.711864 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:30:10.712515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:30:10.725965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m20:30:10.726788 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:30:10.727490 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:30:10.731024 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:30:10.742035 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:30:10.742818 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:30:10.744206 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:10.749421 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:30:10.750132 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:30:10.751664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:10.779395 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:30:10.780193 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:30:10.780842 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:30:10.783844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:30:10.794477 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:30:10.803494 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:30:10.804256 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:30:10.809207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:30:10.813478 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:30:10.816429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fa7936d0>]}
[0m20:30:10.817633 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:30:10.818726 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:30:10.820340 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:30:10.821272 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:30:10.822493 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:30:10.823187 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:30:10.830761 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:30:10.832152 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:30:10.839053 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:30:10.840213 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:30:10.840902 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:30:10.841539 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:30:10.853796 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:30:10.854569 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:30:10.855221 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:30:10.859666 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:30:10.865050 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:30:10.865810 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:30:10.867414 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:30:10.870444 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:30:10.871162 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:30:10.871794 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:30:10.873663 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:30:10.878319 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:30:10.880006 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:30:10.880763 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:30:10.881938 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:30:10.884115 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:30:10.885201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7412747d-c831-4dba-803e-c3e35891e726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fa7378d0>]}
[0m20:30:10.886282 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:30:10.887366 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:30:10.889883 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.890595 [debug] [MainThread]: On master: BEGIN
[0m20:30:10.891127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:30:10.902125 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:30:10.902882 [debug] [MainThread]: On master: COMMIT
[0m20:30:10.903569 [debug] [MainThread]: Using postgres connection "master"
[0m20:30:10.904512 [debug] [MainThread]: On master: COMMIT
[0m20:30:10.905639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:30:10.906389 [debug] [MainThread]: On master: Close
[0m20:30:10.907569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:30:10.908411 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:30:10.909178 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:30:10.910103 [info ] [MainThread]: 
[0m20:30:10.910937 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:30:10.912601 [debug] [MainThread]: Command end result
[0m20:30:10.947916 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:30:10.951073 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:30:10.961210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:30:10.961911 [info ] [MainThread]: 
[0m20:30:10.962734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:30:10.963554 [info ] [MainThread]: 
[0m20:30:10.964342 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:30:10.965874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4970212, "process_in_blocks": "0", "process_kernel_time": 0.493598, "process_mem_max_rss": "118268", "process_out_blocks": "1760", "process_user_time": 3.314588}
[0m20:30:10.966763 [debug] [MainThread]: Command `dbt run` succeeded at 20:30:10.966559 after 1.50 seconds
[0m20:30:10.967533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbcd6410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440fbcd6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7440ffcb5ad0>]}
[0m20:30:10.968291 [debug] [MainThread]: Flushing usage events
[0m20:30:12.407466 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:30:39.474239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff8e50b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff8e5092d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff8e509710>]}


============================== 20:30:39.479405 | 08facc77-d7d4-4f7e-aef7-77981120ba89 ==============================
[0m20:30:39.479405 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:30:39.480465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'profiles_dir': '/home/peon/projects/b3_new', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:30:39.500982 [info ] [MainThread]: dbt version: 1.9.4
[0m20:30:39.501808 [info ] [MainThread]: python version: 3.11.5
[0m20:30:39.502517 [info ] [MainThread]: python path: /home/peon/.pyenv/versions/3.11.5/envs/carteira/bin/python3.11
[0m20:30:39.503150 [info ] [MainThread]: os info: Linux-6.9.3-76060903-generic-x86_64-with-glibc2.35
[0m20:30:39.587102 [info ] [MainThread]: Using profiles dir at /home/peon/projects/b3_new
[0m20:30:39.587925 [info ] [MainThread]: Using profiles.yml file at /home/peon/projects/b3_new/profiles.yml
[0m20:30:39.588615 [info ] [MainThread]: Using dbt_project.yml file at /home/peon/projects/b3_new/dbt_project.yml
[0m20:30:39.589505 [info ] [MainThread]: adapter type: postgres
[0m20:30:39.590130 [info ] [MainThread]: adapter version: 1.9.0
[0m20:30:39.745752 [info ] [MainThread]: Configuration:
[0m20:30:39.746549 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:30:39.747202 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:30:39.747837 [info ] [MainThread]: Required dependencies:
[0m20:30:39.748514 [debug] [MainThread]: Executing "git --help"
[0m20:30:39.753435 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:30:39.754245 [debug] [MainThread]: STDERR: "b''"
[0m20:30:39.754843 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:30:39.755645 [info ] [MainThread]: Connection:
[0m20:30:39.756420 [info ] [MainThread]:   host: localhost
[0m20:30:39.757123 [info ] [MainThread]:   port: 5432
[0m20:30:39.757849 [info ] [MainThread]:   user: foo
[0m20:30:39.758687 [info ] [MainThread]:   database: foo
[0m20:30:39.759454 [info ] [MainThread]:   schema: public
[0m20:30:39.760134 [info ] [MainThread]:   connect_timeout: 10
[0m20:30:39.760842 [info ] [MainThread]:   role: None
[0m20:30:39.761669 [info ] [MainThread]:   search_path: None
[0m20:30:39.762723 [info ] [MainThread]:   keepalives_idle: 0
[0m20:30:39.763580 [info ] [MainThread]:   sslmode: None
[0m20:30:39.764422 [info ] [MainThread]:   sslcert: None
[0m20:30:39.765161 [info ] [MainThread]:   sslkey: None
[0m20:30:39.765899 [info ] [MainThread]:   sslrootcert: None
[0m20:30:39.766605 [info ] [MainThread]:   application_name: dbt
[0m20:30:39.767435 [info ] [MainThread]:   retries: 1
[0m20:30:39.768330 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:30:39.920919 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:30:39.962559 [debug] [MainThread]: Using postgres connection "debug"
[0m20:30:39.963253 [debug] [MainThread]: On debug: select 1 as id
[0m20:30:39.963815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:30:39.977210 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m20:30:39.979232 [debug] [MainThread]: On debug: Close
[0m20:30:39.980002 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:30:39.980629 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:30:39.982111 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5915219, "process_in_blocks": "104", "process_kernel_time": 0.424311, "process_mem_max_rss": "111860", "process_out_blocks": "24", "process_user_time": 2.559813}
[0m20:30:39.982936 [debug] [MainThread]: Command `dbt debug` succeeded at 20:30:39.982780 after 0.59 seconds
[0m20:30:39.983539 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:30:39.984135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff8e6d2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff8e50a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff8d72c0d0>]}
[0m20:30:39.984835 [debug] [MainThread]: Flushing usage events
[0m20:30:41.284738 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:20.178003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9181ad550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9181ad410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9181ad2d0>]}


============================== 20:31:20.182694 | 4b7fd6b0-0578-4759-8ca2-ac070fd2794e ==============================
[0m20:31:20.182694 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:31:20.183699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'debug': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:31:20.432145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9181fbad0>]}
[0m20:31:20.523978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae91ac0c3d0>]}
[0m20:31:20.525259 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:31:20.689797 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:31:20.851565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:20.852292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:20.861527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging.stg_b3_ops
- models.intermediate.int_b3_ops
[0m20:31:20.913616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae917b9a810>]}
[0m20:31:21.029158 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:31:21.033508 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:31:21.049791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9175ac410>]}
[0m20:31:21.050668 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:31:21.051318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9181ad810>]}
[0m20:31:21.053923 [info ] [MainThread]: 
[0m20:31:21.054664 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:31:21.055246 [info ] [MainThread]: 
[0m20:31:21.056211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:21.063987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:31:21.126189 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:31:21.126895 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:31:21.127499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:21.142731 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m20:31:21.144852 [debug] [ThreadPool]: On list_foo: Close
[0m20:31:21.147481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:31:21.157485 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:31:21.158171 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:31:21.158725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:21.170485 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:31:21.171269 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:31:21.171961 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:31:21.176719 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:31:21.179611 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:31:21.180631 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:31:21.189299 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.189996 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.190541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:21.202914 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:31:21.203618 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.204290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:31:21.211385 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m20:31:21.215132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae916ebce50>]}
[0m20:31:21.215902 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:21.216897 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.217525 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.218726 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:31:21.219443 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.220017 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.220580 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.221479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:21.222104 [debug] [MainThread]: On master: Close
[0m20:31:21.226897 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:31:21.227865 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:31:21.228718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:31:21.229434 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:31:21.242576 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:31:21.243648 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:31:21.303445 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:31:21.304629 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:31:21.305330 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:31:21.305952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:21.317177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:31:21.318460 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:31:21.319124 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:31:21.321981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:31:21.333148 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:31:21.333955 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:31:21.335539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:21.340634 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:31:21.341366 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:31:21.342885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:21.370598 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:31:21.371455 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:31:21.372186 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:31:21.374323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:31:21.384565 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:31:21.393370 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:31:21.394118 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:31:21.399183 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:31:21.404203 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:31:21.407093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae916d13fd0>]}
[0m20:31:21.408294 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:31:21.409587 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:31:21.411254 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:31:21.412325 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:31:21.413273 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:31:21.413957 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:31:21.422850 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:31:21.423912 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:31:21.430860 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:31:21.432428 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:31:21.433470 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:31:21.434351 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:31:21.446059 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:31:21.446984 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:31:21.447708 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:31:21.451194 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:31:21.456319 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:31:21.457031 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:31:21.458357 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:21.461246 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:31:21.461975 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:31:21.462761 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:31:21.465711 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:21.470095 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:31:21.471596 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:31:21.472254 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:31:21.473368 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:31:21.475564 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:31:21.476644 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b7fd6b0-0578-4759-8ca2-ac070fd2794e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae916e43e10>]}
[0m20:31:21.477748 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:31:21.478849 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:31:21.481132 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.481831 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.482385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:21.495559 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:31:21.496454 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.497172 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.497927 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.499182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:21.500001 [debug] [MainThread]: On master: Close
[0m20:31:21.501020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:21.501798 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:31:21.502344 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:31:21.503111 [info ] [MainThread]: 
[0m20:31:21.503787 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:31:21.505199 [debug] [MainThread]: Command end result
[0m20:31:21.534196 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:31:21.536690 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:31:21.546456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:31:21.547186 [info ] [MainThread]: 
[0m20:31:21.547935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:21.548607 [info ] [MainThread]: 
[0m20:31:21.549324 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:31:21.550973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4565853, "process_in_blocks": "0", "process_kernel_time": 0.502712, "process_mem_max_rss": "118316", "process_out_blocks": "1752", "process_user_time": 3.190483}
[0m20:31:21.551784 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:21.551635 after 1.46 seconds
[0m20:31:21.552426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae9184d8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae91c3b6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ae91c3b6650>]}
[0m20:31:21.553073 [debug] [MainThread]: Flushing usage events
[0m20:31:23.371462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:51.562840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad229c5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad238a1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad229f06d0>]}


============================== 20:33:51.567665 | b055c1c1-9db9-4b6e-beae-d45cd028550e ==============================
[0m20:33:51.567665 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:33:51.568687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:33:51.816775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad223f1b10>]}
[0m20:33:51.908903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad25450250>]}
[0m20:33:51.910175 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:33:52.072680 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:33:52.209030 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:33:52.209863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad237b0610>]}
[0m20:33:53.904654 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.intermediate
- models.staging
[0m20:33:53.924453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21e9d350>]}
[0m20:33:54.040206 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:33:54.044796 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:33:54.061411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21d87e90>]}
[0m20:33:54.062377 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:33:54.063034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21efbc50>]}
[0m20:33:54.065781 [info ] [MainThread]: 
[0m20:33:54.066500 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:33:54.067084 [info ] [MainThread]: 
[0m20:33:54.067998 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:54.075618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:33:54.136702 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:33:54.137449 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:33:54.138037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:54.154778 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m20:33:54.156964 [debug] [ThreadPool]: On list_foo: Close
[0m20:33:54.159539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:33:54.169515 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:33:54.170279 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:33:54.171022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:54.183958 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m20:33:54.184764 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:33:54.185406 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:33:54.189683 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:33:54.192001 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:33:54.192999 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:33:54.202906 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:54.203628 [debug] [MainThread]: On master: BEGIN
[0m20:33:54.204232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:54.215864 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:33:54.216574 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:54.217222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:33:54.223779 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m20:33:54.226743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21efaed0>]}
[0m20:33:54.227580 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:54.228470 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:54.229058 [debug] [MainThread]: On master: BEGIN
[0m20:33:54.230000 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:33:54.230611 [debug] [MainThread]: On master: COMMIT
[0m20:33:54.231162 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:54.231718 [debug] [MainThread]: On master: COMMIT
[0m20:33:54.232539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:54.233141 [debug] [MainThread]: On master: Close
[0m20:33:54.238327 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:33:54.239333 [info ] [Thread-1 (]: 1 of 2 START sql view model public.stg_b3_ops .................................. [RUN]
[0m20:33:54.240637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:33:54.241349 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:33:54.256264 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:33:54.257475 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:33:54.318240 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:33:54.319428 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:33:54.320107 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:33:54.320729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:54.334569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m20:33:54.335461 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:33:54.336114 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  create view "foo"."public"."stg_b3_ops__dbt_tmp"
    
    
  as (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
[0m20:33:54.339644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:33:54.350231 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:33:54.350999 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:33:54.352547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:33:54.357665 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:33:54.358392 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:33:54.359915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:33:54.387932 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:33:54.388809 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:33:54.389458 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:33:54.391760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:33:54.402555 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:33:54.411669 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:33:54.412507 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:33:54.416222 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:33:54.420985 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:33:54.423904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad21edaa10>]}
[0m20:33:54.425054 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.stg_b3_ops ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m20:33:54.426127 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:33:54.427825 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:33:54.428775 [info ] [Thread-3 (]: 2 of 2 START sql view model public.int_b3_ops .................................. [RUN]
[0m20:33:54.429732 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:33:54.430405 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:33:54.438071 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:33:54.439674 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:33:54.446835 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:33:54.448282 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:33:54.449215 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:33:54.450035 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:54.462726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m20:33:54.463564 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:33:54.464229 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  create view "foo"."public"."int_b3_ops__dbt_tmp"
    
    
  as (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
[0m20:33:54.468000 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:33:54.473119 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:33:54.473849 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:33:54.475139 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:33:54.477759 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:33:54.478634 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:33:54.479285 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:33:54.482152 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:33:54.486424 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:33:54.487885 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:33:54.488587 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop view if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:33:54.489688 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:33:54.491865 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:33:54.493090 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b055c1c1-9db9-4b6e-beae-d45cd028550e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad212a7810>]}
[0m20:33:54.494647 [info ] [Thread-3 (]: 2 of 2 OK created sql view model public.int_b3_ops ............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:33:54.496022 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:33:54.498543 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:54.499224 [debug] [MainThread]: On master: BEGIN
[0m20:33:54.499800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:54.511318 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:33:54.512197 [debug] [MainThread]: On master: COMMIT
[0m20:33:54.512901 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:54.513678 [debug] [MainThread]: On master: COMMIT
[0m20:33:54.514961 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:54.515817 [debug] [MainThread]: On master: Close
[0m20:33:54.516766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:54.517390 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:33:54.517929 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:33:54.518636 [info ] [MainThread]: 
[0m20:33:54.519289 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m20:33:54.520861 [debug] [MainThread]: Command end result
[0m20:33:54.550333 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:33:54.552765 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:33:54.562446 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:33:54.563148 [info ] [MainThread]: 
[0m20:33:54.563943 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:54.564820 [info ] [MainThread]: 
[0m20:33:54.565700 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:33:54.567294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0880697, "process_in_blocks": "0", "process_kernel_time": 0.506796, "process_mem_max_rss": "122288", "process_out_blocks": "2600", "process_user_time": 4.834054}
[0m20:33:54.568074 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:54.567929 after 3.09 seconds
[0m20:33:54.568723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad26bb6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad26bb6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad26bb6510>]}
[0m20:33:54.569378 [debug] [MainThread]: Flushing usage events
[0m20:33:55.263646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:49.051412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8060afddd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8060bacd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a806199ffd0>]}


============================== 20:35:49.056420 | 035601fd-1a8c-4a0e-80ed-6483b415df4c ==============================
[0m20:35:49.056420 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:35:49.057436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:35:49.302663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80630d2510>]}
[0m20:35:49.394577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8063550610>]}
[0m20:35:49.395859 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:35:49.554868 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:35:49.689927 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:35:49.690749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a80611aab10>]}
[0m20:35:51.400762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a805fd9c110>]}
[0m20:35:51.511626 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:35:51.516040 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:35:51.532572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a805fd3b8d0>]}
[0m20:35:51.533450 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:35:51.534075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a806049b350>]}
[0m20:35:51.537170 [info ] [MainThread]: 
[0m20:35:51.537900 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:35:51.538519 [info ] [MainThread]: 
[0m20:35:51.539499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:51.546624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:35:51.607867 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:35:51.608585 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:35:51.609143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:51.623852 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m20:35:51.625999 [debug] [ThreadPool]: On list_foo: Close
[0m20:35:51.628678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:35:51.638874 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:35:51.639575 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:35:51.640111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:51.652230 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:35:51.653121 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:35:51.653711 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:51.658401 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m20:35:51.662161 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:35:51.663174 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:35:51.672349 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:51.673032 [debug] [MainThread]: On master: BEGIN
[0m20:35:51.673762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:51.685920 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:35:51.686673 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:51.687349 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:51.694650 [debug] [MainThread]: SQL status: SELECT 3 in 0.006 seconds
[0m20:35:51.698081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a805f975150>]}
[0m20:35:51.698857 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:51.699832 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:51.700451 [debug] [MainThread]: On master: BEGIN
[0m20:35:51.701634 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:35:51.702243 [debug] [MainThread]: On master: COMMIT
[0m20:35:51.702818 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:51.703358 [debug] [MainThread]: On master: COMMIT
[0m20:35:51.704234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:51.704861 [debug] [MainThread]: On master: Close
[0m20:35:51.709592 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:35:51.710614 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:35:51.711554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:35:51.712240 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:35:51.724940 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:35:51.726140 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:35:51.791322 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:35:51.792511 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:35:51.793181 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:35:51.793836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:51.805912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:35:51.806708 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:35:51.807359 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m20:35:51.815673 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m20:35:51.832405 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:35:51.833165 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:35:51.834719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:51.839785 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:35:51.840494 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:35:51.841853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:51.868969 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:35:51.869761 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:35:51.870398 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:35:51.872460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:35:51.882725 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:35:51.891643 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:35:51.892408 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop view if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:35:51.897343 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:35:51.902156 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:35:51.905017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a805fd95f10>]}
[0m20:35:51.906184 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.19s]
[0m20:35:51.907258 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:35:51.908783 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:35:51.909962 [info ] [Thread-3 (]: 2 of 2 START sql table model public.int_b3_ops ................................. [RUN]
[0m20:35:51.910953 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:35:51.911658 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:35:51.920639 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:35:51.922164 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:35:51.929588 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:35:51.931059 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:35:51.931915 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:35:51.932613 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:35:51.944857 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:35:51.945744 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:35:51.946461 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m20:35:51.960088 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.013 seconds
[0m20:35:51.966530 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:35:51.967295 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m20:35:51.968700 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:51.971230 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:35:51.971957 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:35:51.972608 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:35:51.974692 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:35:51.979007 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m20:35:51.984427 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:35:51.985200 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m20:35:51.986466 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:35:51.988672 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:35:51.989775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '035601fd-1a8c-4a0e-80ed-6483b415df4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a805f2d1fd0>]}
[0m20:35:51.990909 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.08s]
[0m20:35:51.992030 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:35:51.994442 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:51.995121 [debug] [MainThread]: On master: BEGIN
[0m20:35:51.995666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:52.007823 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:35:52.008538 [debug] [MainThread]: On master: COMMIT
[0m20:35:52.009094 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:52.009639 [debug] [MainThread]: On master: COMMIT
[0m20:35:52.010511 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:52.011430 [debug] [MainThread]: On master: Close
[0m20:35:52.012611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:52.013572 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:35:52.014419 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:35:52.015264 [info ] [MainThread]: 
[0m20:35:52.015946 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m20:35:52.017390 [debug] [MainThread]: Command end result
[0m20:35:52.048668 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m20:35:52.051195 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m20:35:52.060469 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m20:35:52.061223 [info ] [MainThread]: 
[0m20:35:52.062102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:52.062751 [info ] [MainThread]: 
[0m20:35:52.063385 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:35:52.064971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1023393, "process_in_blocks": "0", "process_kernel_time": 0.499887, "process_mem_max_rss": "122428", "process_out_blocks": "2600", "process_user_time": 4.866174}
[0m20:35:52.065811 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:52.065653 after 3.10 seconds
[0m20:35:52.066454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8060db7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8060cd2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8064cb5a90>]}
[0m20:35:52.067089 [debug] [MainThread]: Flushing usage events
[0m20:35:53.022122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:01.440428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a4fc33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a5016450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a51da810>]}


============================== 16:24:01.444870 | ae467b54-d36b-401e-8605-3772332301f3 ==============================
[0m16:24:01.444870 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:24:01.445691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:24:01.633498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a492a290>]}
[0m16:24:01.702309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a7a09ad0>]}
[0m16:24:01.703806 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:24:01.837868 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:24:01.964260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:24:01.965128 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_b3_ops.sql
[0m16:24:01.965718 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m16:24:02.250719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a4271d50>]}
[0m16:24:02.323768 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:24:02.326864 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:24:02.367070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a41a54d0>]}
[0m16:24:02.367718 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m16:24:02.368172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a4148c90>]}
[0m16:24:02.369995 [info ] [MainThread]: 
[0m16:24:02.370509 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:24:02.370955 [info ] [MainThread]: 
[0m16:24:02.371591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:02.377337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m16:24:02.447027 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m16:24:02.447540 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m16:24:02.447974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:02.457782 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m16:24:02.459313 [debug] [ThreadPool]: On list_foo: Close
[0m16:24:02.461497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m16:24:02.468977 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:24:02.469473 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m16:24:02.469856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:02.478480 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:24:02.479007 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:24:02.479392 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:24:02.486739 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m16:24:02.489216 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m16:24:02.489953 [debug] [ThreadPool]: On list_foo_public: Close
[0m16:24:02.496342 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:02.496851 [debug] [MainThread]: On master: BEGIN
[0m16:24:02.497205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:02.506332 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:24:02.506902 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:02.507408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:02.512132 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:24:02.514205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a7a2c390>]}
[0m16:24:02.514772 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:02.515481 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:02.515910 [debug] [MainThread]: On master: BEGIN
[0m16:24:02.516763 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:24:02.517191 [debug] [MainThread]: On master: COMMIT
[0m16:24:02.517575 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:02.517939 [debug] [MainThread]: On master: COMMIT
[0m16:24:02.518510 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:24:02.518960 [debug] [MainThread]: On master: Close
[0m16:24:02.522646 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m16:24:02.523388 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m16:24:02.524010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m16:24:02.524467 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m16:24:02.533674 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m16:24:02.534538 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m16:24:02.580781 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m16:24:02.581923 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:24:02.582453 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m16:24:02.582883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:24:02.591733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:24:02.592284 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:24:02.592760 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m16:24:02.597954 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m16:24:02.608879 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:24:02.609420 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m16:24:02.610786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:02.614358 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:24:02.614881 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m16:24:02.615928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:02.634225 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:24:02.634801 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:24:02.635212 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:24:02.637376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:24:02.644647 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m16:24:02.650988 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:24:02.651513 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m16:24:02.655654 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:24:02.659375 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m16:24:02.661925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a3bbb750>]}
[0m16:24:02.662862 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.14s]
[0m16:24:02.663628 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m16:24:02.664513 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m16:24:02.665285 [info ] [Thread-3 (]: 2 of 2 START sql table model public.int_b3_ops ................................. [RUN]
[0m16:24:02.666168 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m16:24:02.666653 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m16:24:02.670405 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m16:24:02.671305 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m16:24:02.676591 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m16:24:02.677489 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:24:02.678139 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m16:24:02.679047 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:24:02.688178 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:24:02.688762 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:24:02.689212 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m16:24:02.694081 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:24:02.698057 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:24:02.698707 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m16:24:02.700185 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:02.706039 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:24:02.706614 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m16:24:02.707630 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:24:02.709618 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:24:02.710115 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:24:02.710518 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:24:02.712237 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:24:02.777676 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m16:24:02.778764 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:24:02.779207 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m16:24:02.783527 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:24:02.785201 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m16:24:02.786305 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae467b54-d36b-401e-8605-3772332301f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a53e3cd0>]}
[0m16:24:02.787529 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.12s]
[0m16:24:02.788517 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m16:24:02.790310 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:02.790802 [debug] [MainThread]: On master: BEGIN
[0m16:24:02.791147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:02.799577 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:24:02.800143 [debug] [MainThread]: On master: COMMIT
[0m16:24:02.800632 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:02.801066 [debug] [MainThread]: On master: COMMIT
[0m16:24:02.801767 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:24:02.802251 [debug] [MainThread]: On master: Close
[0m16:24:02.803017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:02.803751 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m16:24:02.804452 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m16:24:02.805298 [info ] [MainThread]: 
[0m16:24:02.806066 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:24:02.807165 [debug] [MainThread]: Command end result
[0m16:24:02.826805 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:24:02.828640 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:24:02.835864 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m16:24:02.836491 [info ] [MainThread]: 
[0m16:24:02.837015 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:02.837412 [info ] [MainThread]: 
[0m16:24:02.837826 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:24:02.838959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.45501, "process_in_blocks": "53368", "process_kernel_time": 0.413916, "process_mem_max_rss": "121696", "process_out_blocks": "2592", "process_user_time": 2.607472}
[0m16:24:02.839618 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:02.839460 after 1.46 seconds
[0m16:24:02.840134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a91b6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a91b5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7581a49674d0>]}
[0m16:24:02.840679 [debug] [MainThread]: Flushing usage events
[0m16:24:03.946869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:24.134357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a960bb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a962d6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a962d6410>]}


============================== 16:57:24.138164 | fb8b49b2-7a90-4177-aa21-4a2a1b35f3db ==============================
[0m16:57:24.138164 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:57:24.138904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:57:24.306341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb8b49b2-7a90-4177-aa21-4a2a1b35f3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a95a26950>]}
[0m16:57:24.367697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb8b49b2-7a90-4177-aa21-4a2a1b35f3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a98b54250>]}
[0m16:57:24.368659 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:57:24.477034 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:57:24.569709 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:57:24.570318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb8b49b2-7a90-4177-aa21-4a2a1b35f3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a967aaa10>]}
[0m16:57:25.708920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb8b49b2-7a90-4177-aa21-4a2a1b35f3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a959be510>]}
[0m16:57:25.784983 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:57:25.788176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:57:25.847630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb8b49b2-7a90-4177-aa21-4a2a1b35f3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a95388f10>]}
[0m16:57:25.848262 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:57:25.848728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb8b49b2-7a90-4177-aa21-4a2a1b35f3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a95461a90>]}
[0m16:57:25.850576 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:57:25.851346 [debug] [MainThread]: Command end result
[0m16:57:25.870143 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:57:25.872606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:57:25.876585 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m16:57:25.877806 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.799602, "process_in_blocks": "2064", "process_kernel_time": 0.329557, "process_mem_max_rss": "114560", "process_out_blocks": "2544", "process_user_time": 3.006966}
[0m16:57:25.878417 [debug] [MainThread]: Command `dbt test` succeeded at 16:57:25.878303 after 1.80 seconds
[0m16:57:25.878978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a954d2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a9a2b6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5a9a2b5ad0>]}
[0m16:57:25.879513 [debug] [MainThread]: Flushing usage events
[0m16:57:26.682128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:30.450789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48cbda5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48ccbfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48ca178d0>]}


============================== 16:57:30.454157 | 5a7d9862-07af-47cb-967c-96c4c7a86fbd ==============================
[0m16:57:30.454157 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:57:30.454976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:57:30.622900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48c912990>]}
[0m16:57:30.686741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48f441e90>]}
[0m16:57:30.687725 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:57:30.797617 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:57:30.912554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:30.913086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:30.953168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48c14d1d0>]}
[0m16:57:31.031480 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:57:31.034593 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:57:31.046890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48c933e50>]}
[0m16:57:31.047527 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:57:31.048031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48c105fd0>]}
[0m16:57:31.050089 [info ] [MainThread]: 
[0m16:57:31.050653 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:57:31.051083 [info ] [MainThread]: 
[0m16:57:31.051816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:57:31.057226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m16:57:31.102959 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m16:57:31.103471 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m16:57:31.103865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:31.113524 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.010 seconds
[0m16:57:31.115045 [debug] [ThreadPool]: On list_foo: Close
[0m16:57:31.117314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m16:57:31.124237 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:57:31.124747 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m16:57:31.125111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:31.134168 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:57:31.134765 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:57:31.135175 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:57:31.138318 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m16:57:31.140555 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m16:57:31.141331 [debug] [ThreadPool]: On list_foo_public: Close
[0m16:57:31.147967 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:31.148461 [debug] [MainThread]: On master: BEGIN
[0m16:57:31.148868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:31.158123 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:57:31.158649 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:31.159115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:57:31.163967 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:57:31.165958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48bc62010>]}
[0m16:57:31.166523 [debug] [MainThread]: On master: ROLLBACK
[0m16:57:31.167242 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:31.167683 [debug] [MainThread]: On master: BEGIN
[0m16:57:31.168511 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:57:31.168972 [debug] [MainThread]: On master: COMMIT
[0m16:57:31.169364 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:31.169758 [debug] [MainThread]: On master: COMMIT
[0m16:57:31.170346 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:57:31.170841 [debug] [MainThread]: On master: Close
[0m16:57:31.174496 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m16:57:31.175126 [debug] [Thread-2 (]: Began running node model.b3_new.stg_wallet
[0m16:57:31.175723 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_b3_ops ................................. [RUN]
[0m16:57:31.176433 [info ] [Thread-2 (]: 2 of 3 START sql table model public.stg_wallet ................................. [RUN]
[0m16:57:31.177139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m16:57:31.177998 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.b3_new.stg_wallet'
[0m16:57:31.178486 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m16:57:31.178989 [debug] [Thread-2 (]: Began compiling node model.b3_new.stg_wallet
[0m16:57:31.195725 [debug] [Thread-2 (]: Writing injected SQL for node "model.b3_new.stg_wallet"
[0m16:57:31.197028 [debug] [Thread-2 (]: Began executing node model.b3_new.stg_wallet
[0m16:57:31.191605 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m16:57:31.221889 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m16:57:31.284879 [debug] [Thread-2 (]: Writing runtime sql for node "model.b3_new.stg_wallet"
[0m16:57:31.285906 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m16:57:31.287310 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m16:57:31.287922 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: BEGIN
[0m16:57:31.288442 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:57:31.288930 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:57:31.289382 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m16:57:31.290043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:31.299652 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m16:57:31.300184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:57:31.300671 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m16:57:31.301135 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:57:31.301614 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_wallet"} */

  
    

  create  table "foo"."public"."stg_wallet__dbt_tmp"
  
  
    as
  
  (
    CREATE TABLE 
wallet
(   
    "date" date,
    id int,
    asset varchar(64)
    quantity numeric,
    pu numeric,
    value numeric
)
  );
  
[0m16:57:31.302110 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m16:57:31.303065 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 12:     CREATE TABLE 
             ^

[0m16:57:31.303646 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: ROLLBACK
[0m16:57:31.304790 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: Close
[0m16:57:31.309750 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m16:57:31.322786 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:57:31.323385 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m16:57:31.324353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:57:31.328027 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:57:31.328710 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m16:57:31.329936 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:57:31.349401 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:57:31.350040 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:57:31.350461 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:57:31.352403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:57:31.360085 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m16:57:31.366314 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:57:31.366979 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m16:57:31.370241 [debug] [Thread-2 (]: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m16:57:31.371000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:57:31.373742 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48b552850>]}
[0m16:57:31.377363 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m16:57:31.378890 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.stg_wallet ........................ [[31mERROR[0m in 0.19s]
[0m16:57:31.379804 [debug] [Thread-2 (]: Finished running node model.b3_new.stg_wallet
[0m16:57:31.380693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48bc5fed0>]}
[0m16:57:31.381599 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_wallet' to be skipped because of status 'error'.  Reason: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql.
[0m16:57:31.382507 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.20s]
[0m16:57:31.384585 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m16:57:31.385996 [debug] [Thread-4 (]: Began running node model.b3_new.int_b3_ops
[0m16:57:31.386697 [info ] [Thread-4 (]: 3 of 3 START sql table model public.int_b3_ops ................................. [RUN]
[0m16:57:31.387361 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m16:57:31.387887 [debug] [Thread-4 (]: Began compiling node model.b3_new.int_b3_ops
[0m16:57:31.392544 [debug] [Thread-4 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m16:57:31.393665 [debug] [Thread-4 (]: Began executing node model.b3_new.int_b3_ops
[0m16:57:31.399061 [debug] [Thread-4 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m16:57:31.399986 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:57:31.400441 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: BEGIN
[0m16:57:31.400857 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:57:31.410000 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:57:31.410809 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:57:31.411498 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m16:57:31.416369 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:57:31.420553 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:57:31.421099 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m16:57:31.422593 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:57:31.427163 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:57:31.427686 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m16:57:31.428705 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:57:31.430710 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:57:31.431256 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:57:31.431789 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:57:31.433524 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:57:31.436571 [debug] [Thread-4 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m16:57:31.437686 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:57:31.438246 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m16:57:31.441236 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:57:31.443661 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: Close
[0m16:57:31.444643 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7d9862-07af-47cb-967c-96c4c7a86fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48bddfd50>]}
[0m16:57:31.445471 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.06s]
[0m16:57:31.446332 [debug] [Thread-4 (]: Finished running node model.b3_new.int_b3_ops
[0m16:57:31.448171 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:31.448683 [debug] [MainThread]: On master: BEGIN
[0m16:57:31.449053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:31.458290 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m16:57:31.458855 [debug] [MainThread]: On master: COMMIT
[0m16:57:31.459259 [debug] [MainThread]: Using postgres connection "master"
[0m16:57:31.459638 [debug] [MainThread]: On master: COMMIT
[0m16:57:31.460241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:57:31.460670 [debug] [MainThread]: On master: Close
[0m16:57:31.461330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:31.461792 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m16:57:31.462173 [debug] [MainThread]: Connection 'model.b3_new.stg_wallet' was properly closed.
[0m16:57:31.462534 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m16:57:31.463058 [info ] [MainThread]: 
[0m16:57:31.463528 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m16:57:31.464775 [debug] [MainThread]: Command end result
[0m16:57:31.487960 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:57:31.490897 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:57:31.497623 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m16:57:31.498086 [info ] [MainThread]: 
[0m16:57:31.498589 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:31.499092 [info ] [MainThread]: 
[0m16:57:31.499828 [error] [MainThread]:   Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m16:57:31.500313 [info ] [MainThread]: 
[0m16:57:31.500801 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:57:31.501940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1083058, "process_in_blocks": "440", "process_kernel_time": 0.331772, "process_mem_max_rss": "119516", "process_out_blocks": "1800", "process_user_time": 2.297501}
[0m16:57:31.502488 [debug] [MainThread]: Command `dbt run` failed at 16:57:31.502385 after 1.11 seconds
[0m16:57:31.502955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48ca16ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db490bb6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db48b6de810>]}
[0m16:57:31.503393 [debug] [MainThread]: Flushing usage events
[0m16:57:32.417002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:07.037711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2b0c04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2b1aec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2b10f8d0>]}


============================== 16:58:07.041003 | cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a ==============================
[0m16:58:07.041003 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:58:07.041727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:07.212876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2aa5dc10>]}
[0m16:58:07.274768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2db1c1d0>]}
[0m16:58:07.275729 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:58:07.384884 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:58:07.492968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:58:07.493891 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_wallet.sql
[0m16:58:07.774326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2aa71290>]}
[0m16:58:07.847728 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:58:07.850822 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:58:07.862498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba29f4b110>]}
[0m16:58:07.863138 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:58:07.863574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2a3fc550>]}
[0m16:58:07.865641 [info ] [MainThread]: 
[0m16:58:07.866183 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:58:07.866601 [info ] [MainThread]: 
[0m16:58:07.867238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:58:07.872235 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m16:58:07.916170 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m16:58:07.916703 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m16:58:07.917073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:07.928183 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m16:58:07.929696 [debug] [ThreadPool]: On list_foo: Close
[0m16:58:07.932092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m16:58:07.939356 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:58:07.939879 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m16:58:07.940236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:07.949062 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:58:07.949586 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:58:07.950067 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:58:07.953256 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m16:58:07.955239 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m16:58:07.955948 [debug] [ThreadPool]: On list_foo_public: Close
[0m16:58:07.963203 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:07.963715 [debug] [MainThread]: On master: BEGIN
[0m16:58:07.964073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:07.972330 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:58:07.972861 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:07.973734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:58:07.978519 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:58:07.980112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2b114910>]}
[0m16:58:07.980684 [debug] [MainThread]: On master: ROLLBACK
[0m16:58:07.981394 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:07.981828 [debug] [MainThread]: On master: BEGIN
[0m16:58:07.982663 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:58:07.983094 [debug] [MainThread]: On master: COMMIT
[0m16:58:07.983464 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:07.983823 [debug] [MainThread]: On master: COMMIT
[0m16:58:07.984400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:58:07.984880 [debug] [MainThread]: On master: Close
[0m16:58:07.988496 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m16:58:07.989129 [debug] [Thread-2 (]: Began running node model.b3_new.stg_wallet
[0m16:58:07.989739 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_b3_ops ................................. [RUN]
[0m16:58:07.990402 [info ] [Thread-2 (]: 2 of 3 START sql table model public.stg_wallet ................................. [RUN]
[0m16:58:07.991091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m16:58:07.991748 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.b3_new.stg_wallet'
[0m16:58:07.992253 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m16:58:07.992748 [debug] [Thread-2 (]: Began compiling node model.b3_new.stg_wallet
[0m16:58:08.003534 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m16:58:08.007518 [debug] [Thread-2 (]: Writing injected SQL for node "model.b3_new.stg_wallet"
[0m16:58:08.008540 [debug] [Thread-2 (]: Began executing node model.b3_new.stg_wallet
[0m16:58:08.009150 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m16:58:08.083149 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m16:58:08.083711 [debug] [Thread-2 (]: Writing runtime sql for node "model.b3_new.stg_wallet"
[0m16:58:08.084688 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m16:58:08.085233 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:58:08.085678 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: BEGIN
[0m16:58:08.086133 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m16:58:08.086613 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:58:08.087053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:08.095145 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:58:08.095743 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m16:58:08.096174 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_wallet"} */

  
    

  create  table "foo"."public"."stg_wallet__dbt_tmp"
  
  
    as
  
  (
    CREATE TABLE wallet IF NOT EXISTS

(   
    "date" date,
    id int,
    asset varchar(64)
    quantity numeric,
    pu numeric,
    value numeric
)
  );
  
[0m16:58:08.096668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m16:58:08.097213 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 12:     CREATE TABLE wallet IF NOT EXISTS
             ^

[0m16:58:08.097703 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:58:08.098196 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: ROLLBACK
[0m16:58:08.098716 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m16:58:08.099662 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: Close
[0m16:58:08.103909 [debug] [Thread-2 (]: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE wallet IF NOT EXISTS
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m16:58:08.105969 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m16:58:08.106545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2a38b310>]}
[0m16:58:08.117626 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:58:08.118956 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.stg_wallet ........................ [[31mERROR[0m in 0.11s]
[0m16:58:08.119757 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m16:58:08.120494 [debug] [Thread-2 (]: Finished running node model.b3_new.stg_wallet
[0m16:58:08.121321 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_wallet' to be skipped because of status 'error'.  Reason: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE wallet IF NOT EXISTS
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql.
[0m16:58:08.122050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:08.127434 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:58:08.128057 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m16:58:08.129081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:58:08.148647 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:58:08.149221 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:58:08.149657 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:58:08.151309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:58:08.160646 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m16:58:08.166647 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:58:08.167179 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m16:58:08.171280 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:58:08.174701 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m16:58:08.175611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2a39c890>]}
[0m16:58:08.176686 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.18s]
[0m16:58:08.177759 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m16:58:08.178932 [debug] [Thread-4 (]: Began running node model.b3_new.int_b3_ops
[0m16:58:08.179678 [info ] [Thread-4 (]: 3 of 3 START sql table model public.int_b3_ops ................................. [RUN]
[0m16:58:08.180348 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m16:58:08.180905 [debug] [Thread-4 (]: Began compiling node model.b3_new.int_b3_ops
[0m16:58:08.186401 [debug] [Thread-4 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m16:58:08.187212 [debug] [Thread-4 (]: Began executing node model.b3_new.int_b3_ops
[0m16:58:08.251843 [debug] [Thread-4 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m16:58:08.252721 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:58:08.253212 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: BEGIN
[0m16:58:08.253642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:58:08.262439 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:58:08.263019 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:58:08.263465 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m16:58:08.268151 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:58:08.272360 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:58:08.272882 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m16:58:08.273942 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:08.277602 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:58:08.278111 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m16:58:08.279215 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:08.281397 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:58:08.281942 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:58:08.282354 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:58:08.283987 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:58:08.286969 [debug] [Thread-4 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m16:58:08.288080 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:58:08.288537 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m16:58:08.291254 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:58:08.293392 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: Close
[0m16:58:08.294636 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb6c505f-fa1c-40d8-b8e1-fb6711a76c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2a586e50>]}
[0m16:58:08.295476 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.11s]
[0m16:58:08.296240 [debug] [Thread-4 (]: Finished running node model.b3_new.int_b3_ops
[0m16:58:08.298222 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:08.298732 [debug] [MainThread]: On master: BEGIN
[0m16:58:08.299090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:08.308786 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m16:58:08.309307 [debug] [MainThread]: On master: COMMIT
[0m16:58:08.309717 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:08.310074 [debug] [MainThread]: On master: COMMIT
[0m16:58:08.310679 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:58:08.311120 [debug] [MainThread]: On master: Close
[0m16:58:08.311841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:08.312431 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m16:58:08.312952 [debug] [MainThread]: Connection 'model.b3_new.stg_wallet' was properly closed.
[0m16:58:08.313433 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m16:58:08.314104 [info ] [MainThread]: 
[0m16:58:08.314860 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:58:08.316217 [debug] [MainThread]: Command end result
[0m16:58:08.336723 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:58:08.339195 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:58:08.346578 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m16:58:08.347050 [info ] [MainThread]: 
[0m16:58:08.347496 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:58:08.347939 [info ] [MainThread]: 
[0m16:58:08.348388 [error] [MainThread]:   Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE wallet IF NOT EXISTS
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m16:58:08.348801 [info ] [MainThread]: 
[0m16:58:08.349201 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:58:08.350225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3704166, "process_in_blocks": "0", "process_kernel_time": 0.328338, "process_mem_max_rss": "122872", "process_out_blocks": "2648", "process_user_time": 2.573976}
[0m16:58:08.350778 [debug] [MainThread]: Command `dbt run` failed at 16:58:08.350675 after 1.37 seconds
[0m16:58:08.351235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2be4bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2b7c5290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ba2f2b5ad0>]}
[0m16:58:08.351681 [debug] [MainThread]: Flushing usage events
[0m16:58:09.177650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:48.013717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bd1ba610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bd278710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bcfa2b50>]}


============================== 16:59:48.017533 | bd82167c-19cf-429a-b79e-62f90714d052 ==============================
[0m16:59:48.017533 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:59:48.018332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/peon/projects/b3_new', 'log_path': '/home/peon/projects/b3_new/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:59:48.188925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bd016b10>]}
[0m16:59:48.250813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bfa43bd0>]}
[0m16:59:48.251780 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:59:48.359487 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:59:48.467183 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:48.467889 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_wallet.sql
[0m16:59:48.742714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bc8d19d0>]}
[0m16:59:48.819312 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:59:48.822434 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:59:48.834172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bc137010>]}
[0m16:59:48.834821 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m16:59:48.835264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bc3c8710>]}
[0m16:59:48.837365 [info ] [MainThread]: 
[0m16:59:48.837925 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:59:48.838356 [info ] [MainThread]: 
[0m16:59:48.839049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:48.844379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m16:59:48.887051 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m16:59:48.887574 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m16:59:48.887962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:48.900928 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m16:59:48.902460 [debug] [ThreadPool]: On list_foo: Close
[0m16:59:48.904402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m16:59:48.911286 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:59:48.911798 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m16:59:48.912175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:48.921320 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:59:48.921842 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m16:59:48.922247 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:59:48.925815 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m16:59:48.927885 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m16:59:48.928620 [debug] [ThreadPool]: On list_foo_public: Close
[0m16:59:48.935350 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:48.935882 [debug] [MainThread]: On master: BEGIN
[0m16:59:48.936239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:48.944712 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:59:48.945218 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:48.945663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:59:48.950737 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:59:48.952637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bfa64790>]}
[0m16:59:48.953234 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:48.953950 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:48.954387 [debug] [MainThread]: On master: BEGIN
[0m16:59:48.955143 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:59:48.955612 [debug] [MainThread]: On master: COMMIT
[0m16:59:48.956015 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:48.956384 [debug] [MainThread]: On master: COMMIT
[0m16:59:48.957010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:48.957472 [debug] [MainThread]: On master: Close
[0m16:59:48.961167 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m16:59:48.961726 [debug] [Thread-2 (]: Began running node model.b3_new.stg_wallet
[0m16:59:48.962393 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_b3_ops ................................. [RUN]
[0m16:59:48.963337 [info ] [Thread-2 (]: 2 of 3 START sql table model public.stg_wallet ................................. [RUN]
[0m16:59:48.964295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m16:59:48.964950 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.b3_new.stg_wallet'
[0m16:59:48.965440 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m16:59:48.965923 [debug] [Thread-2 (]: Began compiling node model.b3_new.stg_wallet
[0m16:59:48.978313 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m16:59:48.981366 [debug] [Thread-2 (]: Writing injected SQL for node "model.b3_new.stg_wallet"
[0m16:59:48.982622 [debug] [Thread-2 (]: Began executing node model.b3_new.stg_wallet
[0m16:59:48.983610 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m16:59:49.055510 [debug] [Thread-2 (]: Writing runtime sql for node "model.b3_new.stg_wallet"
[0m16:59:49.059838 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m16:59:49.061074 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:59:49.061621 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m16:59:49.062095 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m16:59:49.062591 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: BEGIN
[0m16:59:49.063066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:49.063515 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:59:49.071956 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m16:59:49.072534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m16:59:49.073013 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m16:59:49.073486 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:59:49.073981 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_wallet"} */

  
    

  create  table "foo"."public"."stg_wallet__dbt_tmp"
  
  
    as
  
  (
    CREATE TABLE IF NOT exists wallet 

(   
    "date" date,
    id int,
    asset varchar(64),
    quantity numeric(12,8),
    pu numeric(12,8),
    value numeric(15,8)
)
  );
  
[0m16:59:49.074480 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m16:59:49.075519 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 12:     CREATE TABLE IF NOT exists wallet 
             ^

[0m16:59:49.076308 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: ROLLBACK
[0m16:59:49.077435 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: Close
[0m16:59:49.079349 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:59:49.090464 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:59:49.091312 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m16:59:49.093008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:49.096666 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:59:49.097506 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m16:59:49.098693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:49.117731 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:59:49.118575 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:59:49.120755 [debug] [Thread-2 (]: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE IF NOT exists wallet 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m16:59:49.121343 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m16:59:49.124047 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bbc9b5d0>]}
[0m16:59:49.124988 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.stg_wallet ........................ [[31mERROR[0m in 0.16s]
[0m16:59:49.125926 [debug] [Thread-2 (]: Finished running node model.b3_new.stg_wallet
[0m16:59:49.126549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:59:49.127504 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_wallet' to be skipped because of status 'error'.  Reason: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE IF NOT exists wallet 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql.
[0m16:59:49.135452 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m16:59:49.144184 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m16:59:49.144756 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m16:59:49.148491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:59:49.151440 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m16:59:49.152378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bb700090>]}
[0m16:59:49.153197 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.19s]
[0m16:59:49.153972 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m16:59:49.155116 [debug] [Thread-4 (]: Began running node model.b3_new.int_b3_ops
[0m16:59:49.155949 [info ] [Thread-4 (]: 3 of 3 START sql table model public.int_b3_ops ................................. [RUN]
[0m16:59:49.156969 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m16:59:49.157685 [debug] [Thread-4 (]: Began compiling node model.b3_new.int_b3_ops
[0m16:59:49.163834 [debug] [Thread-4 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m16:59:49.164615 [debug] [Thread-4 (]: Began executing node model.b3_new.int_b3_ops
[0m16:59:49.228457 [debug] [Thread-4 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m16:59:49.229312 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:59:49.229778 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: BEGIN
[0m16:59:49.230177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:59:49.238994 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:59:49.239546 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:59:49.240037 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m16:59:49.245179 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:59:49.250056 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:59:49.250611 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m16:59:49.251646 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:59:49.255090 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:59:49.255752 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m16:59:49.256765 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:49.258774 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:59:49.259249 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:59:49.259665 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m16:59:49.262323 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:49.265265 [debug] [Thread-4 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m16:59:49.266279 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m16:59:49.266739 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m16:59:49.269219 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:59:49.270985 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: Close
[0m16:59:49.271803 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd82167c-19cf-429a-b79e-62f90714d052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bc713cd0>]}
[0m16:59:49.272719 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.12s]
[0m16:59:49.273498 [debug] [Thread-4 (]: Finished running node model.b3_new.int_b3_ops
[0m16:59:49.275312 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:49.275829 [debug] [MainThread]: On master: BEGIN
[0m16:59:49.276188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:49.284495 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:59:49.285066 [debug] [MainThread]: On master: COMMIT
[0m16:59:49.285468 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:49.285873 [debug] [MainThread]: On master: COMMIT
[0m16:59:49.286491 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:49.286940 [debug] [MainThread]: On master: Close
[0m16:59:49.287668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:49.288269 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m16:59:49.288893 [debug] [MainThread]: Connection 'model.b3_new.stg_wallet' was properly closed.
[0m16:59:49.289517 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m16:59:49.290376 [info ] [MainThread]: 
[0m16:59:49.291344 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:59:49.292832 [debug] [MainThread]: Command end result
[0m16:59:49.313090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m16:59:49.315025 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m16:59:49.321771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m16:59:49.322320 [info ] [MainThread]: 
[0m16:59:49.322997 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:59:49.323881 [info ] [MainThread]: 
[0m16:59:49.324902 [error] [MainThread]:   Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE IF NOT exists wallet 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m16:59:49.325584 [info ] [MainThread]: 
[0m16:59:49.326195 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m16:59:49.327326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3708543, "process_in_blocks": "0", "process_kernel_time": 0.345476, "process_mem_max_rss": "123064", "process_out_blocks": "2648", "process_user_time": 2.555729}
[0m16:59:49.327897 [debug] [MainThread]: Command `dbt run` failed at 16:59:49.327777 after 1.37 seconds
[0m16:59:49.328532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791c11b6650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791c11b6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791bcfa2650>]}
[0m16:59:49.329097 [debug] [MainThread]: Flushing usage events
[0m16:59:50.143338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:05.357262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b87a13d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b879f4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b879f4110>]}


============================== 17:00:05.360509 | 930caf24-ae0b-4f3c-8b87-9fc3efc654b6 ==============================
[0m17:00:05.360509 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:00:05.361301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/peon/projects/b3_new', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/peon/projects/b3_new/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:00:05.527957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b87a32b50>]}
[0m17:00:05.588830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b8a450790>]}
[0m17:00:05.589777 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:00:05.697719 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:00:05.805686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:05.806180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:05.844656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b871e7110>]}
[0m17:00:05.920859 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m17:00:05.923982 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m17:00:05.935589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b86ddd450>]}
[0m17:00:05.936233 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m17:00:05.936687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b872e9210>]}
[0m17:00:05.938734 [info ] [MainThread]: 
[0m17:00:05.939295 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m17:00:05.939712 [info ] [MainThread]: 
[0m17:00:05.940338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:05.945416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m17:00:05.989801 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m17:00:05.990306 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m17:00:05.990746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:06.001547 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m17:00:06.003081 [debug] [ThreadPool]: On list_foo: Close
[0m17:00:06.005755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m17:00:06.012737 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m17:00:06.013254 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m17:00:06.013657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:00:06.023371 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:00:06.023902 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m17:00:06.024326 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:00:06.027963 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.003 seconds
[0m17:00:06.029867 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m17:00:06.030556 [debug] [ThreadPool]: On list_foo_public: Close
[0m17:00:06.036648 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:06.037145 [debug] [MainThread]: On master: BEGIN
[0m17:00:06.037487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:06.046613 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:00:06.047119 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:06.047550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:06.052608 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m17:00:06.054016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b866d5d50>]}
[0m17:00:06.054593 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:06.055327 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:06.055763 [debug] [MainThread]: On master: BEGIN
[0m17:00:06.056636 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:00:06.057089 [debug] [MainThread]: On master: COMMIT
[0m17:00:06.057460 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:06.057826 [debug] [MainThread]: On master: COMMIT
[0m17:00:06.058407 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:06.058846 [debug] [MainThread]: On master: Close
[0m17:00:06.062266 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m17:00:06.062894 [debug] [Thread-2 (]: Began running node model.b3_new.stg_wallet
[0m17:00:06.063507 [info ] [Thread-1 (]: 1 of 3 START sql table model public.stg_b3_ops ................................. [RUN]
[0m17:00:06.064210 [info ] [Thread-2 (]: 2 of 3 START sql table model public.stg_wallet ................................. [RUN]
[0m17:00:06.064925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m17:00:06.065562 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.b3_new.stg_wallet'
[0m17:00:06.066074 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m17:00:06.066538 [debug] [Thread-2 (]: Began compiling node model.b3_new.stg_wallet
[0m17:00:06.075119 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m17:00:06.078370 [debug] [Thread-2 (]: Writing injected SQL for node "model.b3_new.stg_wallet"
[0m17:00:06.079498 [debug] [Thread-2 (]: Began executing node model.b3_new.stg_wallet
[0m17:00:06.080013 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m17:00:06.155105 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m17:00:06.155884 [debug] [Thread-2 (]: Writing runtime sql for node "model.b3_new.stg_wallet"
[0m17:00:06.157045 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m17:00:06.157633 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m17:00:06.158093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:06.158728 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m17:00:06.159235 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: BEGIN
[0m17:00:06.159673 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:00:06.167727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:00:06.168421 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m17:00:06.168944 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m17:00:06.169430 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m17:00:06.169919 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.stg_wallet"
[0m17:00:06.170463 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_wallet"} */

  
    

  create  table "foo"."public"."stg_wallet__dbt_tmp"
  
  
    as
  
  (
    CREATE TABLE IF NOT exists wallet 

(   
    "date" date,
    id int,
    asset varchar(64),
    quantity numeric(12,8),
    pu numeric(12,8),
    value numeric(15,8)
)
  );
  
[0m17:00:06.171381 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 12:     CREATE TABLE IF NOT exists wallet 
             ^

[0m17:00:06.171989 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: ROLLBACK
[0m17:00:06.172927 [debug] [Thread-2 (]: On model.b3_new.stg_wallet: Close
[0m17:00:06.174704 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:00:06.187891 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m17:00:06.188486 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m17:00:06.189896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:06.193754 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m17:00:06.194640 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m17:00:06.195745 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:06.197591 [debug] [Thread-2 (]: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE IF NOT exists wallet 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m17:00:06.217068 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m17:00:06.219783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b8665ae90>]}
[0m17:00:06.220302 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m17:00:06.221116 [error] [Thread-2 (]: 2 of 3 ERROR creating sql table model public.stg_wallet ........................ [[31mERROR[0m in 0.15s]
[0m17:00:06.222057 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m17:00:06.222924 [debug] [Thread-2 (]: Finished running node model.b3_new.stg_wallet
[0m17:00:06.223863 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_wallet' to be skipped because of status 'error'.  Reason: Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE IF NOT exists wallet 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql.
[0m17:00:06.225147 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:00:06.233949 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m17:00:06.241298 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m17:00:06.242075 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m17:00:06.246453 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:00:06.250177 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m17:00:06.251118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b86678250>]}
[0m17:00:06.251970 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.19s]
[0m17:00:06.252829 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m17:00:06.253804 [debug] [Thread-4 (]: Began running node model.b3_new.int_b3_ops
[0m17:00:06.254648 [info ] [Thread-4 (]: 3 of 3 START sql table model public.int_b3_ops ................................. [RUN]
[0m17:00:06.255430 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m17:00:06.256088 [debug] [Thread-4 (]: Began compiling node model.b3_new.int_b3_ops
[0m17:00:06.260305 [debug] [Thread-4 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m17:00:06.261218 [debug] [Thread-4 (]: Began executing node model.b3_new.int_b3_ops
[0m17:00:06.266083 [debug] [Thread-4 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m17:00:06.266955 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m17:00:06.267425 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: BEGIN
[0m17:00:06.267852 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:00:06.277142 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m17:00:06.277725 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m17:00:06.278183 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m17:00:06.283122 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:00:06.287532 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m17:00:06.288061 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m17:00:06.289276 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:06.293622 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m17:00:06.294140 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m17:00:06.295154 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:00:06.297158 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m17:00:06.297645 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m17:00:06.298060 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m17:00:06.299724 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m17:00:06.302648 [debug] [Thread-4 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m17:00:06.303758 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m17:00:06.304227 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m17:00:06.307118 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:00:06.310090 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: Close
[0m17:00:06.310957 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '930caf24-ae0b-4f3c-8b87-9fc3efc654b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b86c635d0>]}
[0m17:00:06.311787 [info ] [Thread-4 (]: 3 of 3 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.06s]
[0m17:00:06.312573 [debug] [Thread-4 (]: Finished running node model.b3_new.int_b3_ops
[0m17:00:06.314633 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:06.315123 [debug] [MainThread]: On master: BEGIN
[0m17:00:06.315490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:06.325640 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:00:06.326152 [debug] [MainThread]: On master: COMMIT
[0m17:00:06.326521 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:06.326895 [debug] [MainThread]: On master: COMMIT
[0m17:00:06.327519 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:00:06.327965 [debug] [MainThread]: On master: Close
[0m17:00:06.328586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:06.328999 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m17:00:06.329336 [debug] [MainThread]: Connection 'model.b3_new.stg_wallet' was properly closed.
[0m17:00:06.329703 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m17:00:06.330168 [info ] [MainThread]: 
[0m17:00:06.330604 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m17:00:06.331754 [debug] [MainThread]: Command end result
[0m17:00:06.354147 [debug] [MainThread]: Wrote artifact WritableManifest to /home/peon/projects/b3_new/target/manifest.json
[0m17:00:06.356331 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/peon/projects/b3_new/target/semantic_manifest.json
[0m17:00:06.363732 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/peon/projects/b3_new/target/run_results.json
[0m17:00:06.364198 [info ] [MainThread]: 
[0m17:00:06.364649 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:00:06.365053 [info ] [MainThread]: 
[0m17:00:06.365511 [error] [MainThread]:   Database Error in model stg_wallet (models/staging/stg_wallet.sql)
  syntax error at or near "CREATE"
  LINE 12:     CREATE TABLE IF NOT exists wallet 
               ^
  compiled code at target/run/b3_new/models/staging/stg_wallet.sql
[0m17:00:06.365931 [info ] [MainThread]: 
[0m17:00:06.366339 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:00:06.367393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0656149, "process_in_blocks": "0", "process_kernel_time": 0.322925, "process_mem_max_rss": "119688", "process_out_blocks": "1808", "process_user_time": 2.253498}
[0m17:00:06.367952 [debug] [MainThread]: Command `dbt run` failed at 17:00:06.367852 after 1.07 seconds
[0m17:00:06.368397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b87a18cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b87c94890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741b8bbb6510>]}
[0m17:00:06.368839 [debug] [MainThread]: Flushing usage events
[0m17:00:07.141879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:33.458047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458adaff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458adae910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458adeb790>]}


============================== 15:49:33.462729 | 94644ba1-ec68-4dcb-9b43-47d57df42952 ==============================
[0m15:49:33.462729 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:49:33.463674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:33.544371 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key '+materialized' in "<unicode string>", line 14, column 7 in file
`/home/syco/projects/InvestingR2D2/dbt_project.yml`
[0m15:49:33.545647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458ae22dd0>]}
[0m15:49:33.685883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458a7a4c50>]}
[0m15:49:33.759240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458d634150>]}
[0m15:49:33.760531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:49:33.844535 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:49:33.937657 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:49:33.938397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458bb3c9d0>]}
[0m15:49:35.113345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458b4bd950>]}
[0m15:49:35.188489 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:49:35.192115 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:49:35.209934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458a7f5890>]}
[0m15:49:35.210930 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m15:49:35.211573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4589f8a710>]}
[0m15:49:35.214247 [info ] [MainThread]: 
[0m15:49:35.215030 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:49:35.215725 [info ] [MainThread]: 
[0m15:49:35.216932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:35.224305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:49:35.265493 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:49:35.266195 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:49:35.266672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:35.287018 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m15:49:35.288895 [debug] [ThreadPool]: On list_foo: Close
[0m15:49:35.293240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m15:49:35.301368 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:49:35.302113 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m15:49:35.302559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:35.311796 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:49:35.312515 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:49:35.313054 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:49:35.317172 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:49:35.319517 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m15:49:35.320746 [debug] [ThreadPool]: On list_foo_public: Close
[0m15:49:35.326302 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:35.327047 [debug] [MainThread]: On master: BEGIN
[0m15:49:35.327757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:35.337156 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:49:35.337756 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:35.338279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:35.344103 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:49:35.346746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458b30e110>]}
[0m15:49:35.348061 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:35.348836 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:35.349257 [debug] [MainThread]: On master: BEGIN
[0m15:49:35.349843 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:49:35.350266 [debug] [MainThread]: On master: COMMIT
[0m15:49:35.350629 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:35.350993 [debug] [MainThread]: On master: COMMIT
[0m15:49:35.351462 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:35.352074 [debug] [MainThread]: On master: Close
[0m15:49:35.368795 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m15:49:35.370934 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m15:49:35.372159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m15:49:35.373540 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m15:49:35.390134 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m15:49:35.392204 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m15:49:35.468844 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m15:49:35.470183 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:49:35.470826 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m15:49:35.471414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:35.478185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:49:35.478823 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:49:35.479273 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m15:49:35.486216 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m15:49:35.497146 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:49:35.497794 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m15:49:35.500736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:49:35.518106 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:49:35.518777 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:49:35.519246 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:49:35.521189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:49:35.529195 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m15:49:35.535466 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:49:35.536261 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m15:49:35.537074 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:49:35.539823 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m15:49:35.545296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458822ddd0>]}
[0m15:49:35.546317 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.17s]
[0m15:49:35.547501 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m15:49:35.549173 [debug] [Thread-4 (]: Began running node model.b3_new.int_b3_ops
[0m15:49:35.549946 [info ] [Thread-4 (]: 2 of 2 START sql table model public.int_b3_ops ................................. [RUN]
[0m15:49:35.551164 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m15:49:35.552783 [debug] [Thread-4 (]: Began compiling node model.b3_new.int_b3_ops
[0m15:49:35.557764 [debug] [Thread-4 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m15:49:35.559526 [debug] [Thread-4 (]: Began executing node model.b3_new.int_b3_ops
[0m15:49:35.580309 [debug] [Thread-4 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m15:49:35.581682 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:49:35.582261 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: BEGIN
[0m15:49:35.582740 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:49:35.592254 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m15:49:35.592915 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:49:35.593532 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m15:49:35.599463 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.005 seconds
[0m15:49:35.605659 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:49:35.606563 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m15:49:35.609011 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:49:35.611742 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m15:49:35.612655 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:49:35.613171 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: COMMIT
[0m15:49:35.614803 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:49:35.618641 [debug] [Thread-4 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m15:49:35.620300 [debug] [Thread-4 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:49:35.621215 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m15:49:35.622584 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:49:35.625111 [debug] [Thread-4 (]: On model.b3_new.int_b3_ops: Close
[0m15:49:35.628383 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94644ba1-ec68-4dcb-9b43-47d57df42952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458837d7d0>]}
[0m15:49:35.629277 [info ] [Thread-4 (]: 2 of 2 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.08s]
[0m15:49:35.630555 [debug] [Thread-4 (]: Finished running node model.b3_new.int_b3_ops
[0m15:49:35.633449 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:35.634107 [debug] [MainThread]: On master: BEGIN
[0m15:49:35.634453 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:35.641166 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:49:35.642290 [debug] [MainThread]: On master: COMMIT
[0m15:49:35.642874 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:35.643336 [debug] [MainThread]: On master: COMMIT
[0m15:49:35.644803 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:35.645431 [debug] [MainThread]: On master: Close
[0m15:49:35.655917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:35.656837 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m15:49:35.657276 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m15:49:35.657665 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m15:49:35.658227 [info ] [MainThread]: 
[0m15:49:35.659251 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m15:49:35.660944 [debug] [MainThread]: Command end result
[0m15:49:35.711418 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:49:35.714480 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:49:35.745852 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m15:49:35.746969 [info ] [MainThread]: 
[0m15:49:35.748261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:35.749385 [info ] [MainThread]: 
[0m15:49:35.750255 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:49:35.751345 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:49:35.764152 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3680522, "process_in_blocks": "1280", "process_kernel_time": 0.30057, "process_mem_max_rss": "125876", "process_out_blocks": "2600", "process_user_time": 3.409102}
[0m15:49:35.765354 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:35.765110 after 2.37 seconds
[0m15:49:35.767615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458ae0e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458ae1a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458ada2e10>]}
[0m15:49:35.768442 [debug] [MainThread]: Flushing usage events
[0m15:49:40.335205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:50.624335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfa43e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfa942d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfd3b810>]}


============================== 15:52:50.628266 | 6c62a3e8-4769-44e3-993c-7a3735284d46 ==============================
[0m15:52:50.628266 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:52:50.629198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:52:50.842052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfaaf650>]}
[0m15:52:50.912915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf9869d0>]}
[0m15:52:50.913993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:50.990133 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:52:51.096361 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:52:51.097306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c015b110>]}
[0m15:52:52.324412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf94f5d0>]}
[0m15:52:52.397335 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:52:52.402095 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:52:52.419867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46be3dcb90>]}
[0m15:52:52.420690 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m15:52:52.421299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bf9bff90>]}
[0m15:52:52.423719 [info ] [MainThread]: 
[0m15:52:52.424416 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:52:52.424995 [info ] [MainThread]: 
[0m15:52:52.425857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:52:52.437334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:52:52.490633 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:52:52.491284 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:52:52.491965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:52.500318 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m15:52:52.501915 [debug] [ThreadPool]: On list_foo: Close
[0m15:52:52.507049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m15:52:52.514467 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:52:52.515072 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m15:52:52.515671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:52.522324 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:52:52.522927 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:52:52.523389 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:52:52.526968 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m15:52:52.528796 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m15:52:52.529593 [debug] [ThreadPool]: On list_foo_public: Close
[0m15:52:52.537774 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:52.538395 [debug] [MainThread]: On master: BEGIN
[0m15:52:52.538796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:52.547434 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:52:52.548159 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:52.548660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:52.554027 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:52:52.556399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46c2447750>]}
[0m15:52:52.557136 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:52.558206 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:52.558731 [debug] [MainThread]: On master: BEGIN
[0m15:52:52.560593 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:52:52.561181 [debug] [MainThread]: On master: COMMIT
[0m15:52:52.561630 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:52.561992 [debug] [MainThread]: On master: COMMIT
[0m15:52:52.562879 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:52.563434 [debug] [MainThread]: On master: Close
[0m15:52:52.569063 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m15:52:52.570494 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m15:52:52.571165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m15:52:52.572127 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m15:52:52.612918 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m15:52:52.614640 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m15:52:52.662933 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m15:52:52.664452 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:52:52.665062 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m15:52:52.665556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:52.675841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:52:52.676499 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:52:52.676994 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m15:52:52.682396 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m15:52:52.698928 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:52:52.699752 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m15:52:52.700784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:52.704649 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:52:52.705563 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m15:52:52.706593 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:52.728248 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:52:52.729044 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:52:52.729531 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:52:52.732134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:52:52.739015 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m15:52:52.745663 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:52:52.746325 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m15:52:52.749468 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:52:52.752967 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m15:52:52.757555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bc6c2990>]}
[0m15:52:52.758534 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.19s]
[0m15:52:52.760028 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m15:52:52.761279 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m15:52:52.762042 [info ] [Thread-3 (]: 2 of 2 START sql table model public.int_b3_ops ................................. [RUN]
[0m15:52:52.763327 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m15:52:52.768765 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m15:52:52.782442 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m15:52:52.786435 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m15:52:52.802933 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m15:52:52.808263 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:52:52.811346 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m15:52:52.812540 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:52:52.819690 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m15:52:52.820597 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:52:52.821188 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
case
	when expire_date = '-' then '31-12-2099'
	else expire_date
	end, 
	'DD-MM-YYYY') as date_expiration,
brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m15:52:52.826700 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.005 seconds
[0m15:52:52.839494 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:52:52.840567 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m15:52:52.841463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:52.848633 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:52:52.849837 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m15:52:52.850962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:52.853265 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m15:52:52.854245 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:52:52.854775 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m15:52:52.856624 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:52:52.861110 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m15:52:52.863669 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:52:52.864619 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m15:52:52.868695 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:52:52.870531 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m15:52:52.873810 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c62a3e8-4769-44e3-993c-7a3735284d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bc51a1d0>]}
[0m15:52:52.874793 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.11s]
[0m15:52:52.875610 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m15:52:52.880573 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:52.881328 [debug] [MainThread]: On master: BEGIN
[0m15:52:52.881944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:52.888711 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:52:52.889565 [debug] [MainThread]: On master: COMMIT
[0m15:52:52.889967 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:52.890354 [debug] [MainThread]: On master: COMMIT
[0m15:52:52.891330 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:52.892248 [debug] [MainThread]: On master: Close
[0m15:52:52.894647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:52.895249 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m15:52:52.895595 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m15:52:52.896393 [info ] [MainThread]: 
[0m15:52:52.897195 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:52:52.898435 [debug] [MainThread]: Command end result
[0m15:52:52.945351 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:52:52.948656 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:52:52.971090 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m15:52:52.974174 [info ] [MainThread]: 
[0m15:52:52.978990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:52.980710 [info ] [MainThread]: 
[0m15:52:52.982793 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:52:52.985390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.421856, "process_in_blocks": "0", "process_kernel_time": 0.357739, "process_mem_max_rss": "127224", "process_out_blocks": "2600", "process_user_time": 3.410453}
[0m15:52:52.987567 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:52.987347 after 2.42 seconds
[0m15:52:52.988460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfcbdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfa4fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bfa4e190>]}
[0m15:52:52.990845 [debug] [MainThread]: Flushing usage events
[0m15:52:55.510869 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:57.901561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909f590590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909f5fbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a034b210>]}


============================== 18:50:57.908763 | 0f2b903b-4566-4c8b-9412-2706649c238b ==============================
[0m18:50:57.908763 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:50:57.910212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:58.211713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a0f85910>]}
[0m18:50:58.280102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a1e48410>]}
[0m18:50:58.283538 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:50:58.393669 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:50:58.620533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:50:58.621313 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m18:50:58.926454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909dfadf10>]}
[0m18:50:59.007036 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:50:59.011073 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:50:59.058686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909d734390>]}
[0m18:50:59.059426 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m18:50:59.060390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909d72b710>]}
[0m18:50:59.064016 [info ] [MainThread]: 
[0m18:50:59.065671 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:50:59.068056 [info ] [MainThread]: 
[0m18:50:59.069864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:50:59.094002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m18:50:59.202214 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m18:50:59.203374 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m18:50:59.204111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:59.228964 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m18:50:59.230864 [debug] [ThreadPool]: On list_foo: Close
[0m18:50:59.236614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m18:50:59.243515 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:50:59.244126 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m18:50:59.244506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:59.252910 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:50:59.253485 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:50:59.253876 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:50:59.264771 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m18:50:59.267472 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m18:50:59.269165 [debug] [ThreadPool]: On list_foo_public: Close
[0m18:50:59.275888 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:59.276534 [debug] [MainThread]: On master: BEGIN
[0m18:50:59.277025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:59.285709 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m18:50:59.286439 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:59.287273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:50:59.293294 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m18:50:59.295520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909dfcf410>]}
[0m18:50:59.296410 [debug] [MainThread]: On master: ROLLBACK
[0m18:50:59.297638 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:59.298354 [debug] [MainThread]: On master: BEGIN
[0m18:50:59.300124 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:50:59.301128 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.301758 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:59.302299 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.303484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:59.304071 [debug] [MainThread]: On master: Close
[0m18:50:59.310395 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m18:50:59.311253 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m18:50:59.312452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m18:50:59.313415 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m18:50:59.327266 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m18:50:59.328795 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m18:50:59.389639 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m18:50:59.391815 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:50:59.392753 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m18:50:59.393502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:50:59.407025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:50:59.407936 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:50:59.408787 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m18:50:59.437576 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.028 seconds
[0m18:50:59.447327 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:50:59.447994 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m18:50:59.449730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:59.454086 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:50:59.454784 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m18:50:59.456059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:59.481975 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m18:50:59.483065 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:50:59.484100 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m18:50:59.486643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:50:59.493976 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m18:50:59.502881 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:50:59.503576 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m18:50:59.508426 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m18:50:59.511352 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m18:50:59.514647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909e74d0d0>]}
[0m18:50:59.516049 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.20s]
[0m18:50:59.517989 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m18:50:59.519679 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m18:50:59.520357 [info ] [Thread-3 (]: 2 of 2 START sql table model public.int_b3_ops ................................. [RUN]
[0m18:50:59.521668 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m18:50:59.522062 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m18:50:59.529739 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m18:50:59.531496 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m18:50:59.544031 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m18:50:59.546244 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:50:59.548088 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m18:50:59.550441 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:50:59.578940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m18:50:59.579576 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:50:59.580125 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

  
    

  create  table "foo"."public"."int_b3_ops__dbt_tmp"
  
  
    as
  
  (
    WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops
  );
  
[0m18:50:59.588913 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.008 seconds
[0m18:50:59.593458 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:50:59.594059 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops" rename to "int_b3_ops__dbt_backup"
[0m18:50:59.595553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:59.601704 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:50:59.602839 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
alter table "foo"."public"."int_b3_ops__dbt_tmp" rename to "int_b3_ops"
[0m18:50:59.604807 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:50:59.606989 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m18:50:59.607566 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:50:59.607928 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m18:50:59.609829 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:50:59.612919 [debug] [Thread-3 (]: Applying DROP to: "foo"."public"."int_b3_ops__dbt_backup"
[0m18:50:59.614776 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:50:59.615692 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */
drop table if exists "foo"."public"."int_b3_ops__dbt_backup" cascade
[0m18:50:59.619280 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:50:59.620994 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m18:50:59.622021 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f2b903b-4566-4c8b-9412-2706649c238b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f909c20e550>]}
[0m18:50:59.623131 [info ] [Thread-3 (]: 2 of 2 OK created sql table model public.int_b3_ops ............................ [[32mSELECT 4[0m in 0.10s]
[0m18:50:59.624429 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m18:50:59.627142 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:59.627857 [debug] [MainThread]: On master: BEGIN
[0m18:50:59.628287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:59.636650 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:50:59.637768 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.639042 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:59.640020 [debug] [MainThread]: On master: COMMIT
[0m18:50:59.640869 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:50:59.641577 [debug] [MainThread]: On master: Close
[0m18:50:59.649465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:59.652180 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m18:50:59.663362 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m18:50:59.669012 [info ] [MainThread]: 
[0m18:50:59.674696 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m18:50:59.680724 [debug] [MainThread]: Command end result
[0m18:50:59.848227 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:50:59.852576 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:50:59.860712 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m18:50:59.861221 [info ] [MainThread]: 
[0m18:50:59.862053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:59.863008 [info ] [MainThread]: 
[0m18:50:59.863934 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:50:59.868509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0306077, "process_in_blocks": "74536", "process_kernel_time": 0.808964, "process_mem_max_rss": "127388", "process_out_blocks": "2600", "process_user_time": 3.026948}
[0m18:50:59.869511 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:59.869268 after 2.03 seconds
[0m18:50:59.870210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a35ba250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a35b9990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a189c450>]}
[0m18:50:59.871129 [debug] [MainThread]: Flushing usage events
[0m18:51:02.571112 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:53.137215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa030a15c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa030a162d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa030a4a9d0>]}


============================== 19:29:53.141524 | f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5 ==============================
[0m19:29:53.141524 [info ] [MainThread]: Running with dbt=1.10.1
[0m19:29:53.142881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:29:53.397528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa030356050>]}
[0m19:29:53.480705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0332c85d0>]}
[0m19:29:53.482605 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:29:53.587898 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m19:29:53.696274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:29:53.697238 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m19:29:54.048664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0303c8150>]}
[0m19:29:54.149904 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m19:29:54.155366 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m19:29:54.172555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02efc5910>]}
[0m19:29:54.174071 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m19:29:54.175083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02ef24210>]}
[0m19:29:54.177273 [info ] [MainThread]: 
[0m19:29:54.178141 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m19:29:54.179167 [info ] [MainThread]: 
[0m19:29:54.180738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:54.189177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m19:29:54.296285 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m19:29:54.297019 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m19:29:54.297973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:54.309479 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m19:29:54.312156 [debug] [ThreadPool]: On list_foo: Close
[0m19:29:54.318824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m19:29:54.329751 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m19:29:54.331080 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m19:29:54.333477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:54.345194 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m19:29:54.345989 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m19:29:54.347106 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:29:54.355300 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m19:29:54.359717 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m19:29:54.360860 [debug] [ThreadPool]: On list_foo_public: Close
[0m19:29:54.374256 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:54.376597 [debug] [MainThread]: On master: BEGIN
[0m19:29:54.377869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:54.384250 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m19:29:54.385248 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:54.388966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:29:54.393866 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m19:29:54.395409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02da91a90>]}
[0m19:29:54.396049 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:54.396823 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:54.397249 [debug] [MainThread]: On master: BEGIN
[0m19:29:54.398276 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:29:54.399769 [debug] [MainThread]: On master: COMMIT
[0m19:29:54.400633 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:54.401358 [debug] [MainThread]: On master: COMMIT
[0m19:29:54.402583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:54.404587 [debug] [MainThread]: On master: Close
[0m19:29:54.411023 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m19:29:54.411782 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m19:29:54.413004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m19:29:54.413631 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m19:29:54.432229 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m19:29:54.440114 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m19:29:54.513627 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m19:29:54.515042 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m19:29:54.515677 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m19:29:54.516269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:54.525044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:29:54.525801 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m19:29:54.526521 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as ticker,
"Quantidade" as quantity, 
"Preço" as price,
"Valor" as value 
FROM final
  );
  
[0m19:29:54.531580 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m19:29:54.545450 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m19:29:54.546213 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m19:29:54.547941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:29:54.555996 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m19:29:54.556979 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m19:29:54.558205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:29:54.578367 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m19:29:54.579182 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m19:29:54.579681 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m19:29:54.581043 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:29:54.592066 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m19:29:54.600093 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m19:29:54.603655 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m19:29:54.609374 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:29:54.615510 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m19:29:54.622138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02f319ed0>]}
[0m19:29:54.623946 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.20s]
[0m19:29:54.625540 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m19:29:54.627440 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m19:29:54.628301 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m19:29:54.629185 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m19:29:54.630400 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m19:29:54.663341 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m19:29:54.675832 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m19:29:54.721407 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.722301 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp192954711758"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(ticker, 1, length(ticker)-1)
	else ticker
	END	as ticker,
quantity::numeric,
price::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m19:29:54.723457 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:29:54.743421 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.020 seconds
[0m19:29:54.758734 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.759353 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m19:29:54.760243 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m19:29:54.761015 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.761962 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp192954711758'
        
      order by ordinal_position

  
[0m19:29:54.777699 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.015 seconds
[0m19:29:54.783464 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.784626 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:29:54.790693 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.005 seconds
[0m19:29:54.798629 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.799259 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:29:54.803775 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m19:29:54.819662 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m19:29:54.826676 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.827289 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value"
        from "int_b3_ops__dbt_tmp192954711758"
    )


  
[0m19:29:54.828913 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m19:29:54.830796 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m19:29:54.831339 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m19:29:54.831748 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m19:29:54.833638 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m19:29:54.835493 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m19:29:54.836594 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f741e70d-8ac9-4ec6-ad04-b1e8d27c78d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02d96ffd0>]}
[0m19:29:54.837744 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mINSERT 0 0[0m in 0.21s]
[0m19:29:54.839440 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m19:29:54.843325 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:54.843920 [debug] [MainThread]: On master: BEGIN
[0m19:29:54.844468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:54.859940 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m19:29:54.860683 [debug] [MainThread]: On master: COMMIT
[0m19:29:54.861175 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:54.862028 [debug] [MainThread]: On master: COMMIT
[0m19:29:54.863746 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m19:29:54.864810 [debug] [MainThread]: On master: Close
[0m19:29:54.867109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:54.868572 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m19:29:54.870546 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m19:29:54.872426 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m19:29:54.874872 [info ] [MainThread]: 
[0m19:29:54.876644 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m19:29:54.880500 [debug] [MainThread]: Command end result
[0m19:29:55.065287 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m19:29:55.069153 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m19:29:55.077318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m19:29:55.077901 [info ] [MainThread]: 
[0m19:29:55.079059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:55.080053 [info ] [MainThread]: 
[0m19:29:55.081095 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m19:29:55.083411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0102587, "process_in_blocks": "0", "process_kernel_time": 0.344177, "process_mem_max_rss": "126768", "process_out_blocks": "2608", "process_user_time": 3.105421}
[0m19:29:55.084462 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:55.084242 after 2.01 seconds
[0m19:29:55.087322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0349ba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0349ba3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0349ba250>]}
[0m19:29:55.089143 [debug] [MainThread]: Flushing usage events
[0m19:29:55.751430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:11.561099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60de5bf510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60df292550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e087fb50>]}


============================== 20:16:11.568528 | 68a9afce-f1e1-40f8-8a29-c484d79ffd36 ==============================
[0m20:16:11.568528 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:16:11.569526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'fail_fast': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:16:11.798938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ddf47fd0>]}
[0m20:16:11.868055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ddf360d0>]}
[0m20:16:11.869578 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:16:11.964515 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:16:12.092754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m20:16:12.093673 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m20:16:12.094832 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_b3_ops.sql
[0m20:16:12.419529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60ddf36c10>]}
[0m20:16:12.501025 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:16:12.505828 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:16:12.542331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc71e890>]}
[0m20:16:12.543231 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:16:12.543944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dcb4b550>]}
[0m20:16:12.547510 [info ] [MainThread]: 
[0m20:16:12.548872 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:16:12.549786 [info ] [MainThread]: 
[0m20:16:12.551915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:16:12.559368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:16:12.665119 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:16:12.665900 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:16:12.666888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:12.686943 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.020 seconds
[0m20:16:12.688413 [debug] [ThreadPool]: On list_foo: Close
[0m20:16:12.690663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m20:16:12.697871 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:16:12.698497 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:16:12.698982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:12.706234 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:16:12.706771 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:16:12.707102 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:16:12.717639 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m20:16:12.719719 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:16:12.720906 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:16:12.727573 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:12.728101 [debug] [MainThread]: On master: BEGIN
[0m20:16:12.728407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:12.736218 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:16:12.736726 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:12.737135 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:12.745017 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:16:12.748085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dcfe5ed0>]}
[0m20:16:12.749170 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:12.750777 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:12.751628 [debug] [MainThread]: On master: BEGIN
[0m20:16:12.753269 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:16:12.754033 [debug] [MainThread]: On master: COMMIT
[0m20:16:12.754592 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:12.755045 [debug] [MainThread]: On master: COMMIT
[0m20:16:12.756003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:16:12.756616 [debug] [MainThread]: On master: Close
[0m20:16:12.761052 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:16:12.762297 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:16:12.764148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:16:12.765054 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:16:12.797744 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:16:12.804548 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:16:12.859612 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:16:12.860935 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:12.861720 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:16:12.862578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:12.869660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:16:12.870438 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:12.871394 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:16:12.888793 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.017 seconds
[0m20:16:12.900031 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:12.900795 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:16:12.903032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:16:12.907896 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:12.908478 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:16:12.910127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:16:12.928165 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:16:12.928763 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:12.929407 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:16:12.931846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:16:12.940114 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:16:12.949336 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:12.950271 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:16:12.960310 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m20:16:12.964602 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:16:12.968303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dcb586d0>]}
[0m20:16:12.969441 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.20s]
[0m20:16:12.970685 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:16:12.972294 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:16:12.973017 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:16:12.974348 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:16:12.974971 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:16:12.984304 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:16:12.987752 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:16:13.054480 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:13.055151 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp201613047200"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m20:16:13.055718 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:16:13.071028 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m20:16:13.086045 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:13.086660 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:16:13.087692 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m20:16:13.088304 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:13.088820 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp201613047200'
        
      order by ordinal_position

  
[0m20:16:13.099817 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.010 seconds
[0m20:16:13.105601 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:13.106437 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:16:13.110836 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.004 seconds
[0m20:16:13.121179 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:13.122432 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:16:13.125874 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m20:16:13.139331 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:16:13.140687 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:13.141332 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value"
        from "int_b3_ops__dbt_tmp201613047200"
    )


  
[0m20:16:13.143184 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "brokerage_firm" does not exist
LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                             ^
HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.

[0m20:16:13.143840 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: ROLLBACK
[0m20:16:13.144805 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:16:13.163321 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:16:13.164909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a9afce-f1e1-40f8-8a29-c484d79ffd36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60db221190>]}
[0m20:16:13.166602 [error] [Thread-3 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.19s]
[0m20:16:13.168174 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:16:13.169399 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql.
[0m20:16:13.172830 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:13.173432 [debug] [MainThread]: On master: BEGIN
[0m20:16:13.173771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:16:13.187141 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:16:13.187851 [debug] [MainThread]: On master: COMMIT
[0m20:16:13.188539 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:13.189131 [debug] [MainThread]: On master: COMMIT
[0m20:16:13.189882 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:16:13.191370 [debug] [MainThread]: On master: Close
[0m20:16:13.194045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:13.194757 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m20:16:13.195080 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:16:13.195505 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:16:13.196503 [info ] [MainThread]: 
[0m20:16:13.198196 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m20:16:13.200155 [debug] [MainThread]: Command end result
[0m20:16:13.357101 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:16:13.359536 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:16:13.366946 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:16:13.367829 [info ] [MainThread]: 
[0m20:16:13.369377 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:16:13.370707 [info ] [MainThread]: 
[0m20:16:13.371592 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m20:16:13.372792 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:16:13.376801 [info ] [MainThread]: 
[0m20:16:13.377548 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m20:16:13.378394 [info ] [MainThread]: 
[0m20:16:13.379621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:16:13.383318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9008193, "process_in_blocks": "440", "process_kernel_time": 0.665647, "process_mem_max_rss": "127620", "process_out_blocks": "2616", "process_user_time": 2.909714}
[0m20:16:13.385031 [debug] [MainThread]: Command `dbt run` failed at 20:16:13.384572 after 1.90 seconds
[0m20:16:13.386428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e25ba190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60db250c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dcfa5750>]}
[0m20:16:13.387229 [debug] [MainThread]: Flushing usage events
[0m20:16:14.126005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:16:58.959389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25ca7f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25ca7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f261f3810>]}


============================== 20:16:58.963444 | 851f3551-5217-4732-85d9-a5731c6c16db ==============================
[0m20:16:58.963444 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:16:58.964849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:59.162882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25d11350>]}
[0m20:16:59.236204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f28549810>]}
[0m20:16:59.237168 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:16:59.317347 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:16:59.433929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:59.434743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:59.472678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f255d48d0>]}
[0m20:16:59.543859 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:16:59.548007 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:16:59.561677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25544a10>]}
[0m20:16:59.562599 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:16:59.563741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25be41d0>]}
[0m20:16:59.566239 [info ] [MainThread]: 
[0m20:16:59.566862 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:16:59.567379 [info ] [MainThread]: 
[0m20:16:59.568281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:16:59.591510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:16:59.630941 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:16:59.632946 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:16:59.634346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:59.644966 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.011 seconds
[0m20:16:59.647580 [debug] [ThreadPool]: On list_foo: Close
[0m20:16:59.652590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:16:59.658726 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:16:59.659302 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:16:59.659920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:59.669143 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:16:59.670435 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:16:59.671371 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:16:59.675690 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m20:16:59.677249 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:16:59.678528 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:16:59.688606 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:59.689214 [debug] [MainThread]: On master: BEGIN
[0m20:16:59.689852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:16:59.700268 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:16:59.701424 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:59.702577 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:16:59.707388 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:16:59.709320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f255b5e50>]}
[0m20:16:59.710775 [debug] [MainThread]: On master: ROLLBACK
[0m20:16:59.712190 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:59.712906 [debug] [MainThread]: On master: BEGIN
[0m20:16:59.714752 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:16:59.715435 [debug] [MainThread]: On master: COMMIT
[0m20:16:59.716033 [debug] [MainThread]: Using postgres connection "master"
[0m20:16:59.716552 [debug] [MainThread]: On master: COMMIT
[0m20:16:59.717604 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:16:59.718804 [debug] [MainThread]: On master: Close
[0m20:16:59.734875 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:16:59.735553 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:16:59.736572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:16:59.737201 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:16:59.749123 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:16:59.751220 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:16:59.801002 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:16:59.802892 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:59.803491 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:16:59.803983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:59.809436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:16:59.810288 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:59.810927 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:16:59.816272 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:16:59.827781 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:59.828544 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:16:59.831340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:16:59.836826 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:59.837405 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:16:59.838805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:16:59.857652 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:16:59.858457 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:59.859206 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:16:59.861694 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:16:59.870891 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:16:59.876904 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:16:59.877477 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:16:59.880138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:16:59.884101 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:16:59.887925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f25c11910>]}
[0m20:16:59.890776 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.15s]
[0m20:16:59.894299 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:16:59.897082 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:16:59.900225 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:16:59.902376 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:16:59.903223 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:16:59.915462 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:16:59.917222 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:16:59.960264 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:16:59.961259 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp201659952339"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m20:16:59.963099 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:16:59.982890 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.021 seconds
[0m20:17:00.007162 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:17:00.008591 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:17:00.011613 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m20:17:00.012324 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:17:00.012911 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp201659952339'
        
      order by ordinal_position

  
[0m20:17:00.020743 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.007 seconds
[0m20:17:00.028242 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:17:00.029180 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:17:00.035569 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.005 seconds
[0m20:17:00.044799 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:17:00.045745 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:17:00.051309 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.004 seconds
[0m20:17:00.067136 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:17:00.068653 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:17:00.069253 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value"
        from "int_b3_ops__dbt_tmp201659952339"
    )


  
[0m20:17:00.070822 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "brokerage_firm" does not exist
LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                             ^
HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.

[0m20:17:00.071501 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: ROLLBACK
[0m20:17:00.072831 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:17:00.076367 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:17:00.077145 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '851f3551-5217-4732-85d9-a5731c6c16db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f20443310>]}
[0m20:17:00.078411 [error] [Thread-3 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.18s]
[0m20:17:00.079534 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:17:00.081463 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql.
[0m20:17:00.084842 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:00.085746 [debug] [MainThread]: On master: BEGIN
[0m20:17:00.087375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:00.094658 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:17:00.095205 [debug] [MainThread]: On master: COMMIT
[0m20:17:00.096340 [debug] [MainThread]: Using postgres connection "master"
[0m20:17:00.098168 [debug] [MainThread]: On master: COMMIT
[0m20:17:00.099170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:17:00.100033 [debug] [MainThread]: On master: Close
[0m20:17:00.106212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:00.106770 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:17:00.107161 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:17:00.107548 [info ] [MainThread]: 
[0m20:17:00.108099 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m20:17:00.119562 [debug] [MainThread]: Command end result
[0m20:17:00.188267 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:17:00.191609 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:17:00.206701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:17:00.207391 [info ] [MainThread]: 
[0m20:17:00.208144 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:17:00.208833 [info ] [MainThread]: 
[0m20:17:00.210995 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m20:17:00.213191 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:17:00.215214 [info ] [MainThread]: 
[0m20:17:00.216247 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m20:17:00.218948 [info ] [MainThread]: 
[0m20:17:00.220412 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:17:00.222161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3287746, "process_in_blocks": "0", "process_kernel_time": 0.365078, "process_mem_max_rss": "123360", "process_out_blocks": "1784", "process_user_time": 2.345234}
[0m20:17:00.223770 [debug] [MainThread]: Command `dbt run` failed at 20:17:00.223569 after 1.33 seconds
[0m20:17:00.224706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f26986850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f29cb5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f24d8df90>]}
[0m20:17:00.225401 [debug] [MainThread]: Flushing usage events
[0m20:17:00.759376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:30.267796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1b9bfd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1bbf9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1b9bf7d0>]}


============================== 20:18:30.271401 | 4d098600-c08f-4b2c-b903-a81452d5cb9f ==============================
[0m20:18:30.271401 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:18:30.272382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:18:30.597311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d098600-c08f-4b2c-b903-a81452d5cb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1c0dbc90>]}
[0m20:18:30.628796 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.42606807, "process_in_blocks": "16", "process_kernel_time": 0.260094, "process_mem_max_rss": "101552", "process_out_blocks": "16", "process_user_time": 1.619678}
[0m20:18:30.631004 [debug] [MainThread]: Command `dbt clean` succeeded at 20:18:30.630050 after 0.43 seconds
[0m20:18:30.632045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1bbf9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1bbfa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d1f9b5850>]}
[0m20:18:30.632732 [debug] [MainThread]: Flushing usage events
[0m20:18:31.289270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:35.980513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f5b3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f5b36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f5b3ed0>]}


============================== 20:18:35.985637 | 94dc97df-73b3-4047-94ce-997c400d6f9e ==============================
[0m20:18:35.985637 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:18:35.986633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:18:36.210473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0ef88e90>]}
[0m20:18:36.286258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0efe60d0>]}
[0m20:18:36.287187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:18:36.389583 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:18:36.390677 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:18:36.391352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f623c50>]}
[0m20:18:37.670832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0e3dcb10>]}
[0m20:18:37.747549 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:18:37.750831 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:18:37.764578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0ef9ab50>]}
[0m20:18:37.765376 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:18:37.766308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0eff6910>]}
[0m20:18:37.769004 [info ] [MainThread]: 
[0m20:18:37.769818 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:18:37.770292 [info ] [MainThread]: 
[0m20:18:37.770957 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:37.776964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:18:37.840901 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:18:37.841610 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:18:37.842498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:37.852506 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m20:18:37.854704 [debug] [ThreadPool]: On list_foo: Close
[0m20:18:37.864748 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:18:37.876196 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:18:37.877551 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:18:37.878673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:37.890735 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m20:18:37.892172 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:18:37.893157 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:18:37.900484 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m20:18:37.906640 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:18:37.907686 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:18:37.919899 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:37.920549 [debug] [MainThread]: On master: BEGIN
[0m20:18:37.920968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:37.932340 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m20:18:37.933117 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:37.934636 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:37.940430 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:18:37.942380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d11a58290>]}
[0m20:18:37.943167 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:37.944262 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:37.945159 [debug] [MainThread]: On master: BEGIN
[0m20:18:37.947271 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:18:37.947892 [debug] [MainThread]: On master: COMMIT
[0m20:18:37.949089 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:37.950054 [debug] [MainThread]: On master: COMMIT
[0m20:18:37.951205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:37.951774 [debug] [MainThread]: On master: Close
[0m20:18:37.958766 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:18:37.959662 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:18:37.960409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:18:37.960982 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:18:37.971356 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:18:37.972631 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:18:38.036989 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:18:38.038489 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:38.039127 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:18:38.039838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:38.047705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:18:38.048452 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:38.049136 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:18:38.053611 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m20:18:38.067101 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:38.067810 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:18:38.069183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:18:38.073303 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:38.074161 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:18:38.075331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:18:38.094341 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:18:38.095228 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:38.096085 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:18:38.098352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:18:38.107936 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:18:38.115744 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:38.116543 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:18:38.120430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:18:38.123447 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:18:38.125956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d1025a2d0>]}
[0m20:18:38.129791 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.16s]
[0m20:18:38.132756 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:18:38.136322 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:18:38.139626 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:18:38.142504 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:18:38.143151 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:18:38.191734 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:18:38.199430 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:18:38.260858 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:38.261637 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp201838252894"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m20:18:38.263118 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:38.273992 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m20:18:38.293389 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:38.294138 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:18:38.295066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m20:18:38.295728 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:38.296745 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp201838252894'
        
      order by ordinal_position

  
[0m20:18:38.303973 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.006 seconds
[0m20:18:38.311658 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:38.312314 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:18:38.316623 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m20:18:38.324491 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:38.325127 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:18:38.328690 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m20:18:38.343968 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:18:38.344875 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:38.345498 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value"
        from "int_b3_ops__dbt_tmp201838252894"
    )


  
[0m20:18:38.348316 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "brokerage_firm" does not exist
LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                             ^
HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.

[0m20:18:38.349717 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: ROLLBACK
[0m20:18:38.350993 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:18:38.356596 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:18:38.357514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94dc97df-73b3-4047-94ce-997c400d6f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0d3ee110>]}
[0m20:18:38.359670 [error] [Thread-3 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.22s]
[0m20:18:38.362505 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:18:38.364694 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql.
[0m20:18:38.370423 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:38.370889 [debug] [MainThread]: On master: BEGIN
[0m20:18:38.371154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:38.378272 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:18:38.379840 [debug] [MainThread]: On master: COMMIT
[0m20:18:38.382193 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:38.383419 [debug] [MainThread]: On master: COMMIT
[0m20:18:38.385233 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:18:38.387021 [debug] [MainThread]: On master: Close
[0m20:18:38.390076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:38.391135 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:18:38.391904 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:18:38.402734 [info ] [MainThread]: 
[0m20:18:38.414137 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m20:18:38.417170 [debug] [MainThread]: Command end result
[0m20:18:38.477133 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:18:38.482401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:18:38.490198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:18:38.491197 [info ] [MainThread]: 
[0m20:18:38.496349 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:18:38.500311 [info ] [MainThread]: 
[0m20:18:38.504348 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m20:18:38.506767 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "brokerage_firm" does not exist
  LINE 5: ...", "id", "movement", "market", "date_expiration", "brokerage...
                                                               ^
  HINT:  There is a column named "brokerage_firm" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:18:38.508139 [info ] [MainThread]: 
[0m20:18:38.509506 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m20:18:38.520248 [info ] [MainThread]: 
[0m20:18:38.524770 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:18:38.526935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.609557, "process_in_blocks": "152", "process_kernel_time": 0.38555, "process_mem_max_rss": "128272", "process_out_blocks": "2616", "process_user_time": 3.561376}
[0m20:18:38.527636 [debug] [MainThread]: Command `dbt run` failed at 20:18:38.527511 after 2.61 seconds
[0m20:18:38.528341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f622f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f7fa410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d0f5c8e10>]}
[0m20:18:38.532288 [debug] [MainThread]: Flushing usage events
[0m20:18:39.190491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:18:54.978238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353c3f9dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353cb03a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353c3f8f10>]}


============================== 20:18:54.982882 | 32dcd6dc-3b89-48e0-ae53-778d2c14e531 ==============================
[0m20:18:54.982882 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:18:54.984336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:18:55.221243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353c3bf590>]}
[0m20:18:55.303447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353eca9e50>]}
[0m20:18:55.304689 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:18:55.391148 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:18:55.492301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:55.493151 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m20:18:55.821697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353c24be10>]}
[0m20:18:55.899902 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:18:55.903217 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:18:55.919679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353a516290>]}
[0m20:18:55.920356 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:18:55.920966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353a941650>]}
[0m20:18:55.923400 [info ] [MainThread]: 
[0m20:18:55.924792 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:18:55.925479 [info ] [MainThread]: 
[0m20:18:55.927039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:18:55.956339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:18:56.011762 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:18:56.012407 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:18:56.013229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:56.025384 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m20:18:56.027963 [debug] [ThreadPool]: On list_foo: Close
[0m20:18:56.036193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:18:56.048772 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:18:56.049768 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:18:56.050722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:18:56.057663 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:18:56.058588 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:18:56.059191 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:18:56.063817 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m20:18:56.066173 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:18:56.067355 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:18:56.074724 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:56.075248 [debug] [MainThread]: On master: BEGIN
[0m20:18:56.075607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:56.083162 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:18:56.084798 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:56.085399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:18:56.090506 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m20:18:56.091913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353b5a5d90>]}
[0m20:18:56.092685 [debug] [MainThread]: On master: ROLLBACK
[0m20:18:56.093705 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:56.094455 [debug] [MainThread]: On master: BEGIN
[0m20:18:56.095988 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:18:56.097081 [debug] [MainThread]: On master: COMMIT
[0m20:18:56.098012 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:56.098712 [debug] [MainThread]: On master: COMMIT
[0m20:18:56.099952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:56.100982 [debug] [MainThread]: On master: Close
[0m20:18:56.117310 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:18:56.118656 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:18:56.119960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:18:56.121165 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:18:56.138706 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:18:56.139902 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:18:56.192557 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:18:56.194072 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:56.194660 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:18:56.195182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:56.204018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:18:56.204601 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:56.205068 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:18:56.210183 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:18:56.222523 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:56.223395 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m20:18:56.224727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:18:56.232057 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:56.232692 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:18:56.233986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:18:56.252961 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:18:56.253667 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:56.254156 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:18:56.255833 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:18:56.262394 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:18:56.270322 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:18:56.270875 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:18:56.273161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:18:56.276705 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:18:56.282904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353b51ad10>]}
[0m20:18:56.284355 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.16s]
[0m20:18:56.286956 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:18:56.289658 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:18:56.291781 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:18:56.297892 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:18:56.299371 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:18:56.340593 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:18:56.342742 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:18:56.400822 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:56.401628 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp201856393214"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m20:18:56.402191 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:56.410937 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.009 seconds
[0m20:18:56.426369 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:56.426992 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:18:56.427993 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m20:18:56.428534 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:56.429128 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp201856393214'
        
      order by ordinal_position

  
[0m20:18:56.436034 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.006 seconds
[0m20:18:56.441606 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:56.442503 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:18:56.447092 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.004 seconds
[0m20:18:56.454695 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:56.455269 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:18:56.458917 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m20:18:56.473922 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:18:56.475277 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:18:56.475842 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm", "ticker", "quantity", "price", "value"
        from "int_b3_ops__dbt_tmp201856393214"
    )


  
[0m20:18:56.478187 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "ticker" does not exist
LINE 5: ...", "market", "date_expiration", "brokerage_firm", "ticker", ...
                                                             ^
HINT:  There is a column named "ticker" in table "int_b3_ops", but it cannot be referenced from this part of the query.

[0m20:18:56.479163 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: ROLLBACK
[0m20:18:56.481169 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:18:56.486539 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "ticker" does not exist
  LINE 5: ...", "market", "date_expiration", "brokerage_firm", "ticker", ...
                                                               ^
  HINT:  There is a column named "ticker" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:18:56.487387 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32dcd6dc-3b89-48e0-ae53-778d2c14e531', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35393820d0>]}
[0m20:18:56.488266 [error] [Thread-3 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.19s]
[0m20:18:56.489618 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:18:56.490816 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "ticker" does not exist
  LINE 5: ...", "market", "date_expiration", "brokerage_firm", "ticker", ...
                                                               ^
  HINT:  There is a column named "ticker" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql.
[0m20:18:56.494486 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:56.496554 [debug] [MainThread]: On master: BEGIN
[0m20:18:56.497278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:18:56.505410 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:18:56.506159 [debug] [MainThread]: On master: COMMIT
[0m20:18:56.506675 [debug] [MainThread]: Using postgres connection "master"
[0m20:18:56.520052 [debug] [MainThread]: On master: COMMIT
[0m20:18:56.520782 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:18:56.521951 [debug] [MainThread]: On master: Close
[0m20:18:56.524799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:56.525332 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:18:56.525729 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:18:56.526477 [info ] [MainThread]: 
[0m20:18:56.527953 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m20:18:56.531438 [debug] [MainThread]: Command end result
[0m20:18:56.684101 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:18:56.687230 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:18:56.694398 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:18:56.695055 [info ] [MainThread]: 
[0m20:18:56.695751 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:18:56.696849 [info ] [MainThread]: 
[0m20:18:56.697776 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m20:18:56.698936 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "ticker" does not exist
  LINE 5: ...", "market", "date_expiration", "brokerage_firm", "ticker", ...
                                                               ^
  HINT:  There is a column named "ticker" in table "int_b3_ops", but it cannot be referenced from this part of the query.
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:18:56.699745 [info ] [MainThread]: 
[0m20:18:56.700513 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m20:18:56.701770 [info ] [MainThread]: 
[0m20:18:56.703309 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:18:56.704647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.8036153, "process_in_blocks": "0", "process_kernel_time": 0.4476, "process_mem_max_rss": "126976", "process_out_blocks": "2608", "process_user_time": 2.901549}
[0m20:18:56.705883 [debug] [MainThread]: Command `dbt run` failed at 20:18:56.705484 after 1.80 seconds
[0m20:18:56.706600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f353d45bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35403b6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35403b6790>]}
[0m20:18:56.708252 [debug] [MainThread]: Flushing usage events
[0m20:18:57.381074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:34.307441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f08d7090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f08d7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f08a77d0>]}


============================== 20:20:34.314639 | 66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb ==============================
[0m20:20:34.314639 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:20:34.316187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:34.507518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f07403d0>]}
[0m20:20:34.583849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0811c10>]}
[0m20:20:34.584922 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:20:34.673576 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:20:34.772474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:34.773027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:34.807650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7efd17090>]}
[0m20:20:34.898775 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:20:34.902388 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:20:34.916673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ef140d90>]}
[0m20:20:34.917605 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:20:34.918354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ef91a150>]}
[0m20:20:34.920675 [info ] [MainThread]: 
[0m20:20:34.921370 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:20:34.921959 [info ] [MainThread]: 
[0m20:20:34.923008 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:34.955190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:20:34.993032 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:20:34.993644 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:20:34.994406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:35.004813 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m20:20:35.006660 [debug] [ThreadPool]: On list_foo: Close
[0m20:20:35.009592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m20:20:35.017819 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:20:35.018422 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:20:35.018815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:35.024402 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:20:35.024915 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:20:35.025299 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:20:35.028882 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m20:20:35.030820 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:20:35.031687 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:20:35.038841 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:35.039371 [debug] [MainThread]: On master: BEGIN
[0m20:20:35.039672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:35.048330 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:20:35.048895 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:35.049621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:35.054167 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m20:20:35.055504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ee9fa0d0>]}
[0m20:20:35.056156 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:35.057282 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:35.058179 [debug] [MainThread]: On master: BEGIN
[0m20:20:35.059576 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:20:35.060137 [debug] [MainThread]: On master: COMMIT
[0m20:20:35.061011 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:35.061532 [debug] [MainThread]: On master: COMMIT
[0m20:20:35.063319 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:20:35.064150 [debug] [MainThread]: On master: Close
[0m20:20:35.084966 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:20:35.085940 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:20:35.087949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:20:35.089191 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:20:35.103655 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:20:35.105285 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:20:35.173328 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:20:35.174924 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:20:35.175496 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:20:35.175894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:35.187801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m20:20:35.188371 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:20:35.188808 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:20:35.200001 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m20:20:35.215023 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:20:35.215692 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:20:35.217388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:35.233316 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:20:35.236802 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:20:35.237435 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:20:35.240110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:35.248498 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:20:35.254502 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:20:35.255663 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:20:35.256831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:20:35.260228 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:20:35.263565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ed90dad0>]}
[0m20:20:35.264636 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.17s]
[0m20:20:35.265695 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:20:35.267823 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:20:35.268682 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:20:35.269575 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:20:35.270495 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:20:35.282265 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:20:35.283585 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:20:35.325408 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:20:35.326962 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:20:35.327782 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:20:35.328597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:20:35.338162 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m20:20:35.338975 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:20:35.339881 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      
  
    

  create  table "foo"."public"."int_b3_ops"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

  );
  
  
[0m20:20:35.347941 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.007 seconds
[0m20:20:35.350854 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:20:35.351995 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:20:35.352962 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:20:35.355255 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:20:35.356824 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:20:35.358355 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66ae4ad2-97a5-4f1e-beb9-cecd4f252cbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7ef91d010>]}
[0m20:20:35.359481 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mSELECT 4[0m in 0.09s]
[0m20:20:35.361555 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:20:35.367236 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:35.368474 [debug] [MainThread]: On master: BEGIN
[0m20:20:35.369111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:35.389883 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m20:20:35.390594 [debug] [MainThread]: On master: COMMIT
[0m20:20:35.391190 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:35.393173 [debug] [MainThread]: On master: COMMIT
[0m20:20:35.398662 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:20:35.399488 [debug] [MainThread]: On master: Close
[0m20:20:35.403255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:35.407384 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m20:20:35.411002 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:20:35.415344 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:20:35.416914 [info ] [MainThread]: 
[0m20:20:35.422952 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m20:20:35.440073 [debug] [MainThread]: Command end result
[0m20:20:35.511930 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:20:35.516971 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:20:35.526131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:20:35.526879 [info ] [MainThread]: 
[0m20:20:35.527648 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:35.528441 [info ] [MainThread]: 
[0m20:20:35.530022 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:20:35.531704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.284553, "process_in_blocks": "0", "process_kernel_time": 0.411195, "process_mem_max_rss": "122884", "process_out_blocks": "1768", "process_user_time": 2.332745}
[0m20:20:35.532415 [debug] [MainThread]: Command `dbt run` succeeded at 20:20:35.532282 after 1.29 seconds
[0m20:20:35.533174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0912cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f09129d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7f0b93590>]}
[0m20:20:35.535646 [debug] [MainThread]: Flushing usage events
[0m20:20:36.070518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:22:07.137460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80215b1e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80218d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80215fc610>]}


============================== 20:22:07.141735 | 7d8c4934-8ba7-430d-b119-9b5c87ab61b8 ==============================
[0m20:22:07.141735 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:22:07.142762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:22:07.350210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80217d3490>]}
[0m20:22:07.435401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8023e48810>]}
[0m20:22:07.436693 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:22:07.548786 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:22:07.744010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:22:07.745539 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m20:22:08.288709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8020384b90>]}
[0m20:22:08.401913 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:22:08.406709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:22:08.439882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f801f730350>]}
[0m20:22:08.440677 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:22:08.441532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80207cdc50>]}
[0m20:22:08.447962 [info ] [MainThread]: 
[0m20:22:08.448797 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:22:08.449647 [info ] [MainThread]: 
[0m20:22:08.450836 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:22:08.458913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:22:08.523392 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:22:08.524309 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:22:08.524907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:22:08.540499 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m20:22:08.542269 [debug] [ThreadPool]: On list_foo: Close
[0m20:22:08.547875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:22:08.557601 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:22:08.558385 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:22:08.558739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:22:08.567806 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m20:22:08.568444 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:22:08.568947 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:22:08.573545 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m20:22:08.575529 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:22:08.576649 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:22:08.587489 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:08.588087 [debug] [MainThread]: On master: BEGIN
[0m20:22:08.588539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:22:08.594618 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:22:08.595632 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:08.596647 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:22:08.602521 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m20:22:08.603802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802160b710>]}
[0m20:22:08.604391 [debug] [MainThread]: On master: ROLLBACK
[0m20:22:08.606002 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:08.607220 [debug] [MainThread]: On master: BEGIN
[0m20:22:08.608619 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:22:08.609225 [debug] [MainThread]: On master: COMMIT
[0m20:22:08.609837 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:08.610900 [debug] [MainThread]: On master: COMMIT
[0m20:22:08.614319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:08.615018 [debug] [MainThread]: On master: Close
[0m20:22:08.623171 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:22:08.623829 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:22:08.625007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:22:08.625579 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:22:08.638965 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:22:08.640278 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:22:08.700767 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:22:08.702447 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:22:08.703017 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:22:08.703788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:08.711212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:22:08.712435 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:22:08.713242 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as order_date,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:22:08.719902 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:22:08.740895 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:22:08.741845 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:22:08.745981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:22:08.771439 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:22:08.772355 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:22:08.773015 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:22:08.774844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:22:08.785826 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:22:08.793131 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:22:08.794061 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:22:08.795863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:22:08.800534 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:22:08.804400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8020fd9550>]}
[0m20:22:08.806214 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.18s]
[0m20:22:08.807710 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:22:08.809429 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:22:08.810805 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:22:08.814642 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:22:08.815678 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:22:08.822424 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:22:08.823702 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:22:08.856243 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:22:08.857437 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:22:08.858086 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:22:08.858526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:22:08.868272 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m20:22:08.868960 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:22:08.869566 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      
  
    

  create  table "foo"."public"."int_b3_ops"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

  );
  
  
[0m20:22:08.874569 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.004 seconds
[0m20:22:08.876665 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:22:08.877309 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:22:08.878129 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m20:22:08.881784 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m20:22:08.883659 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:22:08.884767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d8c4934-8ba7-430d-b119-9b5c87ab61b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f801e6b1350>]}
[0m20:22:08.886289 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mSELECT 4[0m in 0.07s]
[0m20:22:08.888003 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:22:08.891559 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:08.892157 [debug] [MainThread]: On master: BEGIN
[0m20:22:08.892661 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:08.905115 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:22:08.906169 [debug] [MainThread]: On master: COMMIT
[0m20:22:08.906656 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:08.907038 [debug] [MainThread]: On master: COMMIT
[0m20:22:08.907770 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:22:08.908504 [debug] [MainThread]: On master: Close
[0m20:22:08.909147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:08.909553 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:22:08.909809 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:22:08.910446 [info ] [MainThread]: 
[0m20:22:08.914376 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:22:08.918706 [debug] [MainThread]: Command end result
[0m20:22:08.944406 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:22:08.948476 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:22:08.956072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:22:08.956644 [info ] [MainThread]: 
[0m20:22:08.958062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:08.958778 [info ] [MainThread]: 
[0m20:22:08.959578 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:22:08.961509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8911968, "process_in_blocks": "0", "process_kernel_time": 0.464856, "process_mem_max_rss": "126180", "process_out_blocks": "2608", "process_user_time": 3.013689}
[0m20:22:08.962963 [debug] [MainThread]: Command `dbt run` succeeded at 20:22:08.962673 after 1.89 seconds
[0m20:22:08.963967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8021893750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80255ba490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80255ba250>]}
[0m20:22:08.964716 [debug] [MainThread]: Flushing usage events
[0m20:22:09.642280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:38.671339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f010d2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f011ff090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f010cba90>]}


============================== 20:25:38.678875 | 2ec41c0f-2317-479c-a8b5-0c0ad8d57632 ==============================
[0m20:25:38.678875 [info ] [MainThread]: Running with dbt=1.10.1
[0m20:25:38.683466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:25:39.504920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f011412d0>]}
[0m20:25:39.702800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f039d0f10>]}
[0m20:25:39.704563 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:25:39.871697 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m20:25:40.135951 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:40.136918 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_b3_ops.sql
[0m20:25:41.177927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5effda0850>]}
[0m20:25:41.375444 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:25:41.384845 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:25:41.429191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eff534c50>]}
[0m20:25:41.430953 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m20:25:41.432373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5effd81d90>]}
[0m20:25:41.436775 [info ] [MainThread]: 
[0m20:25:41.438273 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m20:25:41.443381 [info ] [MainThread]: 
[0m20:25:41.445794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:25:41.456443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m20:25:41.643533 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m20:25:41.645215 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m20:25:41.646923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:41.663683 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m20:25:41.666569 [debug] [ThreadPool]: On list_foo: Close
[0m20:25:41.675480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m20:25:41.685558 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:25:41.687752 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m20:25:41.689997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:41.702519 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m20:25:41.703484 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m20:25:41.704580 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:25:41.712499 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:25:41.715801 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m20:25:41.717204 [debug] [ThreadPool]: On list_foo_public: Close
[0m20:25:41.731056 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:41.732224 [debug] [MainThread]: On master: BEGIN
[0m20:25:41.733672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:41.743106 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m20:25:41.745074 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:41.746525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:25:41.753684 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m20:25:41.756391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f0113b550>]}
[0m20:25:41.757653 [debug] [MainThread]: On master: ROLLBACK
[0m20:25:41.759730 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:41.761531 [debug] [MainThread]: On master: BEGIN
[0m20:25:41.766765 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:25:41.767552 [debug] [MainThread]: On master: COMMIT
[0m20:25:41.768351 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:41.769073 [debug] [MainThread]: On master: COMMIT
[0m20:25:41.770747 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m20:25:41.771520 [debug] [MainThread]: On master: Close
[0m20:25:41.782761 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m20:25:41.784265 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m20:25:41.785618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m20:25:41.786803 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m20:25:41.803692 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m20:25:41.808696 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m20:25:41.931627 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m20:25:41.934363 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:41.935737 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m20:25:41.936833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:41.948193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:25:41.949499 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:41.950952 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m20:25:41.969036 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.017 seconds
[0m20:25:41.998916 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:42.000887 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m20:25:42.003997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:42.037902 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:25:42.040619 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:42.044513 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m20:25:42.048182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:42.071002 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m20:25:42.084564 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m20:25:42.085668 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m20:25:42.087349 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m20:25:42.092645 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m20:25:42.103865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5efddae450>]}
[0m20:25:42.105901 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.32s]
[0m20:25:42.108706 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m20:25:42.112389 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m20:25:42.115012 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m20:25:42.117056 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m20:25:42.118452 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m20:25:42.170561 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m20:25:42.172848 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m20:25:42.298852 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m20:25:42.301304 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:42.302558 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m20:25:42.306623 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:25:42.325178 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m20:25:42.329452 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m20:25:42.331720 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      
  
    

  create  table "foo"."public"."int_b3_ops"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(order_date, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

  );
  
  
[0m20:25:42.335133 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "order_date" does not exist
LINE 23: to_date(order_date, 'DD-MM-YYYY') as date_op,
                 ^

[0m20:25:42.337421 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: ROLLBACK
[0m20:25:42.341242 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m20:25:42.355838 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 23: to_date(order_date, 'DD-MM-YYYY') as date_op,
                   ^
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:25:42.358637 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ec41c0f-2317-479c-a8b5-0c0ad8d57632', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5eff543b10>]}
[0m20:25:42.361789 [error] [Thread-3 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.24s]
[0m20:25:42.364327 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m20:25:42.370481 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 23: to_date(order_date, 'DD-MM-YYYY') as date_op,
                   ^
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql.
[0m20:25:42.390558 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:42.391483 [debug] [MainThread]: On master: BEGIN
[0m20:25:42.392444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:42.404109 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m20:25:42.406226 [debug] [MainThread]: On master: COMMIT
[0m20:25:42.407745 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:42.408843 [debug] [MainThread]: On master: COMMIT
[0m20:25:42.435299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:42.436133 [debug] [MainThread]: On master: Close
[0m20:25:42.440212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:42.441516 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m20:25:42.443651 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m20:25:42.446013 [info ] [MainThread]: 
[0m20:25:42.448090 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m20:25:42.453087 [debug] [MainThread]: Command end result
[0m20:25:42.545305 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m20:25:42.549719 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m20:25:42.597902 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m20:25:42.599003 [info ] [MainThread]: 
[0m20:25:42.599883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:42.605153 [info ] [MainThread]: 
[0m20:25:42.621712 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m20:25:42.623274 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 23: to_date(order_date, 'DD-MM-YYYY') as date_op,
                   ^
  compiled code at target/run/b3_new/models/intermediate/int_b3_ops.sql
[0m20:25:42.632485 [info ] [MainThread]: 
[0m20:25:42.646666 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m20:25:42.648285 [info ] [MainThread]: 
[0m20:25:42.649602 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m20:25:42.652491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.1114845, "process_in_blocks": "0", "process_kernel_time": 0.594901, "process_mem_max_rss": "131156", "process_out_blocks": "2608", "process_user_time": 4.455854}
[0m20:25:42.653797 [debug] [MainThread]: Command `dbt run` failed at 20:25:42.653488 after 4.11 seconds
[0m20:25:42.662771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01140a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f01312410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5f050b6110>]}
[0m20:25:42.665124 [debug] [MainThread]: Flushing usage events
[0m20:25:43.383049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:52:51.708050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356875850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23566d3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356875c50>]}


============================== 23:52:51.720832 | b8f820de-892d-47b9-9827-51bb2e4ac81d ==============================
[0m23:52:51.720832 [info ] [MainThread]: Running with dbt=1.10.1
[0m23:52:51.721830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:52:51.998350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23561c8b10>]}
[0m23:52:52.074024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23567adc90>]}
[0m23:52:52.075430 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:52:52.328490 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m23:52:52.491833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:52:52.493082 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m23:52:52.760213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2356de9310>]}
[0m23:52:52.825049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m23:52:52.829114 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m23:52:52.849607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354d52790>]}
[0m23:52:52.850327 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m23:52:52.850842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354d34710>]}
[0m23:52:52.853028 [info ] [MainThread]: 
[0m23:52:52.853687 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m23:52:52.854101 [info ] [MainThread]: 
[0m23:52:52.854854 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:52:52.875923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m23:52:52.933371 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m23:52:52.933915 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m23:52:52.934335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:52.959706 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m23:52:52.961536 [debug] [ThreadPool]: On list_foo: Close
[0m23:52:52.963764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m23:52:52.969839 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m23:52:52.970631 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m23:52:52.971961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:52:52.979268 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:52:52.979797 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m23:52:52.980180 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:52:52.988725 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.008 seconds
[0m23:52:52.990148 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m23:52:52.991435 [debug] [ThreadPool]: On list_foo_public: Close
[0m23:52:52.996563 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:52.997101 [debug] [MainThread]: On master: BEGIN
[0m23:52:52.997414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:52:53.005895 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m23:52:53.006522 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.007244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:52:53.015400 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m23:52:53.017648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354d224d0>]}
[0m23:52:53.018290 [debug] [MainThread]: On master: ROLLBACK
[0m23:52:53.019552 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.020392 [debug] [MainThread]: On master: BEGIN
[0m23:52:53.021674 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:52:53.022175 [debug] [MainThread]: On master: COMMIT
[0m23:52:53.022558 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.022940 [debug] [MainThread]: On master: COMMIT
[0m23:52:53.023871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:52:53.024402 [debug] [MainThread]: On master: Close
[0m23:52:53.028599 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m23:52:53.029289 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m23:52:53.030327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m23:52:53.030821 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m23:52:53.041340 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m23:52:53.042630 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m23:52:53.093274 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m23:52:53.095563 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:52:53.096227 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m23:52:53.096983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:52:53.105423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m23:52:53.106920 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:52:53.108319 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m23:52:53.124701 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.014 seconds
[0m23:52:53.134769 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:52:53.135509 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m23:52:53.136818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:53.142263 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:52:53.142787 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m23:52:53.144035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:52:53.159928 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m23:52:53.160589 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:52:53.161076 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m23:52:53.163391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:52:53.169665 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m23:52:53.179445 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m23:52:53.180214 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m23:52:53.191651 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m23:52:53.194367 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m23:52:53.196579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23551fd790>]}
[0m23:52:53.197548 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.17s]
[0m23:52:53.198610 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m23:52:53.200031 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m23:52:53.200863 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m23:52:53.201545 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m23:52:53.202316 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m23:52:53.207320 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m23:52:53.208735 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m23:52:53.245402 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m23:52:53.246907 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:52:53.247723 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m23:52:53.248486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:52:53.258260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:52:53.258930 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:52:53.260906 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      
  
    

  create  table "foo"."public"."int_b3_ops"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(date_op, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

  );
  
  
[0m23:52:53.268807 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.007 seconds
[0m23:52:53.270639 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m23:52:53.271503 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m23:52:53.271986 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m23:52:53.273884 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:52:53.275105 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m23:52:53.276118 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f820de-892d-47b9-9827-51bb2e4ac81d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2353821f90>]}
[0m23:52:53.277030 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mSELECT 4[0m in 0.07s]
[0m23:52:53.278137 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m23:52:53.281813 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.282312 [debug] [MainThread]: On master: BEGIN
[0m23:52:53.282818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:52:53.292104 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m23:52:53.292721 [debug] [MainThread]: On master: COMMIT
[0m23:52:53.293341 [debug] [MainThread]: Using postgres connection "master"
[0m23:52:53.293916 [debug] [MainThread]: On master: COMMIT
[0m23:52:53.295785 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:52:53.296629 [debug] [MainThread]: On master: Close
[0m23:52:53.299338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:52:53.299884 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m23:52:53.300542 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m23:52:53.300882 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m23:52:53.301343 [info ] [MainThread]: 
[0m23:52:53.302281 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m23:52:53.303569 [debug] [MainThread]: Command end result
[0m23:52:53.407192 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m23:52:53.409633 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m23:52:53.416380 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m23:52:53.417032 [info ] [MainThread]: 
[0m23:52:53.417577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:52:53.418166 [info ] [MainThread]: 
[0m23:52:53.418783 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:52:53.420482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7977988, "process_in_blocks": "0", "process_kernel_time": 1.114184, "process_mem_max_rss": "125328", "process_out_blocks": "2616", "process_user_time": 2.663658}
[0m23:52:53.421126 [debug] [MainThread]: Command `dbt run` succeeded at 23:52:53.421019 after 1.80 seconds
[0m23:52:53.422199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23537da010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235a8b62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235a8b6110>]}
[0m23:52:53.422875 [debug] [MainThread]: Flushing usage events
[0m23:52:55.525012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:07.589483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede22b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede326dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede528e10>]}


============================== 15:00:07.597469 | 33cf09f3-dd54-42c1-8bb3-3a2617270712 ==============================
[0m15:00:07.597469 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:00:07.598670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:07.640541 [info ] [MainThread]: dbt version: 1.10.1
[0m15:00:07.642108 [info ] [MainThread]: python version: 3.11.2
[0m15:00:07.642964 [info ] [MainThread]: python path: /home/syco/.virtualenvs/invest/bin/python3
[0m15:00:07.643690 [info ] [MainThread]: os info: Linux-6.1.0-34-amd64-x86_64-with-glibc2.36
[0m15:00:07.805065 [info ] [MainThread]: Using profiles dir at /home/syco/projects/InvestingR2D2
[0m15:00:07.808379 [info ] [MainThread]: Using profiles.yml file at /home/syco/projects/InvestingR2D2/profiles.yml
[0m15:00:07.809815 [info ] [MainThread]: Using dbt_project.yml file at /home/syco/projects/InvestingR2D2/dbt_project.yml
[0m15:00:07.811259 [info ] [MainThread]: adapter type: postgres
[0m15:00:07.812109 [info ] [MainThread]: adapter version: 1.9.0
[0m15:00:08.049042 [info ] [MainThread]: Configuration:
[0m15:00:08.050330 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:00:08.051194 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:00:08.053379 [info ] [MainThread]: Required dependencies:
[0m15:00:08.054351 [debug] [MainThread]: Executing "git --help"
[0m15:00:08.070256 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:00:08.071189 [debug] [MainThread]: STDERR: "b''"
[0m15:00:08.071957 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:00:08.072847 [info ] [MainThread]: Connection:
[0m15:00:08.074365 [info ] [MainThread]:   host: localhost
[0m15:00:08.075293 [info ] [MainThread]:   port: 5432
[0m15:00:08.076135 [info ] [MainThread]:   user: foo
[0m15:00:08.076837 [info ] [MainThread]:   database: foo
[0m15:00:08.077718 [info ] [MainThread]:   schema: public
[0m15:00:08.078438 [info ] [MainThread]:   connect_timeout: 10
[0m15:00:08.079165 [info ] [MainThread]:   role: None
[0m15:00:08.079961 [info ] [MainThread]:   search_path: None
[0m15:00:08.080746 [info ] [MainThread]:   keepalives_idle: 0
[0m15:00:08.083280 [info ] [MainThread]:   sslmode: None
[0m15:00:08.090596 [info ] [MainThread]:   sslcert: None
[0m15:00:08.091549 [info ] [MainThread]:   sslkey: None
[0m15:00:08.092403 [info ] [MainThread]:   sslrootcert: None
[0m15:00:08.093420 [info ] [MainThread]:   application_name: dbt
[0m15:00:08.094180 [info ] [MainThread]:   retries: 1
[0m15:00:08.095222 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:00:08.947196 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:00:09.104750 [debug] [MainThread]: Using postgres connection "debug"
[0m15:00:09.105825 [debug] [MainThread]: On debug: select 1 as id
[0m15:00:09.106606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:09.136964 [debug] [MainThread]: SQL status: SELECT 1 in 0.030 seconds
[0m15:00:09.139124 [debug] [MainThread]: On debug: Close
[0m15:00:09.141380 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:00:09.143328 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:00:09.146191 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6457242, "process_in_blocks": "104", "process_kernel_time": 0.713821, "process_mem_max_rss": "113204", "process_out_blocks": "24", "process_user_time": 3.394449}
[0m15:00:09.148524 [debug] [MainThread]: Command `dbt debug` succeeded at 15:00:09.148280 after 1.65 seconds
[0m15:00:09.150467 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:00:09.151425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede25ff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede264f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ede4e76d0>]}
[0m15:00:09.152193 [debug] [MainThread]: Flushing usage events
[0m15:00:11.170947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:14.895779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd718e8ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd719146390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd718e8ae90>]}


============================== 15:01:14.907530 | a2860366-f852-430a-8b2c-434c558e2c74 ==============================
[0m15:01:14.907530 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:01:14.909809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:15.327531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71aa59750>]}
[0m15:01:15.497804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71b8c9650>]}
[0m15:01:15.512517 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:16.158412 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:01:16.455441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:16.456437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:16.556587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7189d6010>]}
[0m15:01:16.707339 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:01:16.718746 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:01:16.812779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd718f4da50>]}
[0m15:01:16.814234 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m15:01:16.816726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd717912f90>]}
[0m15:01:16.821394 [info ] [MainThread]: 
[0m15:01:16.822681 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:01:16.828973 [info ] [MainThread]: 
[0m15:01:16.833778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:16.841715 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:01:17.042565 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:01:17.043398 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:01:17.044440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:17.069552 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.025 seconds
[0m15:01:17.071735 [debug] [ThreadPool]: On list_foo: Close
[0m15:01:17.088512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m15:01:17.096347 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:01:17.098309 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m15:01:17.099346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:17.122758 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m15:01:17.123546 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:01:17.132509 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:01:17.152594 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m15:01:17.155507 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m15:01:17.166083 [debug] [ThreadPool]: On list_foo_public: Close
[0m15:01:17.179802 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:17.180910 [debug] [MainThread]: On master: BEGIN
[0m15:01:17.182195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:17.202639 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m15:01:17.203835 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:17.204968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:17.222439 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m15:01:17.242754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71891f090>]}
[0m15:01:17.244548 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:17.246567 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:17.250122 [debug] [MainThread]: On master: BEGIN
[0m15:01:17.252288 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:01:17.255398 [debug] [MainThread]: On master: COMMIT
[0m15:01:17.256783 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:17.264315 [debug] [MainThread]: On master: COMMIT
[0m15:01:17.279864 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m15:01:17.280688 [debug] [MainThread]: On master: Close
[0m15:01:17.298838 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m15:01:17.300810 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m15:01:17.304918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m15:01:17.306233 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m15:01:17.322232 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m15:01:17.324364 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m15:01:17.423321 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m15:01:17.435969 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:01:17.437170 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m15:01:17.440087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:17.498678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m15:01:17.499502 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:01:17.500204 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m15:01:17.524913 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.019 seconds
[0m15:01:17.537131 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:01:17.540105 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m15:01:17.543453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:01:17.548605 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:01:17.550008 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m15:01:17.552245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:17.652187 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:01:17.660999 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:01:17.662844 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:01:17.666592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:01:17.676713 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m15:01:17.690707 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:01:17.692065 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m15:01:17.703431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:01:17.707591 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m15:01:17.724287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7161470d0>]}
[0m15:01:17.726473 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.41s]
[0m15:01:17.730932 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m15:01:17.735670 [debug] [Thread-2 (]: Began running node model.b3_new.int_b3_ops
[0m15:01:17.739371 [info ] [Thread-2 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m15:01:17.741193 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m15:01:17.743964 [debug] [Thread-2 (]: Began compiling node model.b3_new.int_b3_ops
[0m15:01:17.768062 [debug] [Thread-2 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m15:01:17.775791 [debug] [Thread-2 (]: Began executing node model.b3_new.int_b3_ops
[0m15:01:17.845129 [debug] [Thread-2 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:01:17.846593 [debug] [Thread-2 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp150117830348"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(date_op, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m15:01:17.847632 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:01:17.872956 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "order_date" does not exist
LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                       ^

[0m15:01:17.874549 [debug] [Thread-2 (]: On model.b3_new.int_b3_ops: Close
[0m15:01:17.949646 [debug] [Thread-2 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                         ^
[0m15:01:17.950799 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2860366-f852-430a-8b2c-434c558e2c74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7161df850>]}
[0m15:01:17.957030 [error] [Thread-2 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.21s]
[0m15:01:17.963574 [debug] [Thread-2 (]: Finished running node model.b3_new.int_b3_ops
[0m15:01:17.965039 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                         ^.
[0m15:01:17.974571 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:17.980060 [debug] [MainThread]: On master: BEGIN
[0m15:01:17.981040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:18.007117 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m15:01:18.008362 [debug] [MainThread]: On master: COMMIT
[0m15:01:18.009898 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:18.011277 [debug] [MainThread]: On master: COMMIT
[0m15:01:18.012963 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:01:18.014710 [debug] [MainThread]: On master: Close
[0m15:01:18.025700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:18.026923 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m15:01:18.028146 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m15:01:18.029747 [info ] [MainThread]: 
[0m15:01:18.035026 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m15:01:18.042150 [debug] [MainThread]: Command end result
[0m15:01:18.122019 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:01:18.128383 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:01:18.140723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m15:01:18.142101 [info ] [MainThread]: 
[0m15:01:18.144981 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:01:18.148311 [info ] [MainThread]: 
[0m15:01:18.153789 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m15:01:18.163687 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                         ^
[0m15:01:18.167615 [info ] [MainThread]: 
[0m15:01:18.174759 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m15:01:18.183109 [info ] [MainThread]: 
[0m15:01:18.207171 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m15:01:18.216475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.437332, "process_in_blocks": "0", "process_kernel_time": 0.985716, "process_mem_max_rss": "123416", "process_out_blocks": "1768", "process_user_time": 4.16355}
[0m15:01:18.218540 [debug] [MainThread]: Command `dbt run` failed at 15:01:18.218263 after 3.44 seconds
[0m15:01:18.219933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd719053590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71cfba310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd71cfba650>]}
[0m15:01:18.222028 [debug] [MainThread]: Flushing usage events
[0m15:01:18.766209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:32.423060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6161eff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc616063950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6161ef8d0>]}


============================== 15:35:32.429827 | 584a7fc5-81dc-4237-b668-b7ca695b584d ==============================
[0m15:35:32.429827 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:35:32.431595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:32.741151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc615b7df10>]}
[0m15:35:32.818535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc618ac44d0>]}
[0m15:35:32.820698 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:35:33.265911 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:35:33.427058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:35:33.428307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:35:33.464148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614f0a950>]}
[0m15:35:33.580195 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:35:33.589635 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:35:33.642745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614b53950>]}
[0m15:35:33.644911 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m15:35:33.648583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614b0c390>]}
[0m15:35:33.656589 [info ] [MainThread]: 
[0m15:35:33.659864 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:35:33.661123 [info ] [MainThread]: 
[0m15:35:33.663171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:33.687487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:35:33.871514 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:35:33.873164 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:35:33.880511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:33.915499 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.035 seconds
[0m15:35:33.920343 [debug] [ThreadPool]: On list_foo: Close
[0m15:35:33.937405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m15:35:33.979011 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:35:33.982190 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m15:35:33.984126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:34.010700 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m15:35:34.011960 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:35:34.013353 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:35:34.028712 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m15:35:34.031643 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m15:35:34.034342 [debug] [ThreadPool]: On list_foo_public: Close
[0m15:35:34.044869 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:34.049464 [debug] [MainThread]: On master: BEGIN
[0m15:35:34.052261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:35:34.077900 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m15:35:34.079078 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:34.080075 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:35:34.095869 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m15:35:34.098189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc616063190>]}
[0m15:35:34.099507 [debug] [MainThread]: On master: ROLLBACK
[0m15:35:34.102698 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:34.103871 [debug] [MainThread]: On master: BEGIN
[0m15:35:34.106850 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:35:34.108035 [debug] [MainThread]: On master: COMMIT
[0m15:35:34.110772 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:34.114850 [debug] [MainThread]: On master: COMMIT
[0m15:35:34.123527 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m15:35:34.125597 [debug] [MainThread]: On master: Close
[0m15:35:34.149101 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m15:35:34.151237 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m15:35:34.155293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m15:35:34.156419 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m15:35:34.170720 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m15:35:34.174185 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m15:35:34.288825 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m15:35:34.292254 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:35:34.293984 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m15:35:34.295299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:34.322272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m15:35:34.323101 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:35:34.324258 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m15:35:34.337587 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.012 seconds
[0m15:35:34.350725 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:35:34.353050 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m15:35:34.355914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:34.361142 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:35:34.366129 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m15:35:34.380341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:35:34.402023 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:35:34.403328 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:35:34.404459 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:35:34.408373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:35:34.416924 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m15:35:34.440054 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:35:34.440839 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m15:35:34.444842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:35:34.448348 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m15:35:34.454307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6133113d0>]}
[0m15:35:34.455951 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.30s]
[0m15:35:34.460551 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m15:35:34.464268 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m15:35:34.465699 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m15:35:34.467153 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m15:35:34.467917 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m15:35:34.514981 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m15:35:34.519047 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m15:35:34.602690 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:35:34.604181 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp153534594105"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(date_op, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m15:35:34.605688 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:35:34.645024 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "order_date" does not exist
LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                       ^

[0m15:35:34.647053 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m15:35:34.674923 [debug] [Thread-3 (]: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                         ^
[0m15:35:34.676615 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584a7fc5-81dc-4237-b668-b7ca695b584d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61330b510>]}
[0m15:35:34.678574 [error] [Thread-3 (]: 2 of 2 ERROR creating sql incremental model public.int_b3_ops .................. [[31mERROR[0m in 0.21s]
[0m15:35:34.681619 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m15:35:34.687760 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.int_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                         ^.
[0m15:35:34.700450 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:34.701518 [debug] [MainThread]: On master: BEGIN
[0m15:35:34.702244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:34.729952 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m15:35:34.730798 [debug] [MainThread]: On master: COMMIT
[0m15:35:34.731496 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:34.732150 [debug] [MainThread]: On master: COMMIT
[0m15:35:34.734210 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:35:34.735012 [debug] [MainThread]: On master: Close
[0m15:35:34.742762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:34.744410 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m15:35:34.745245 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m15:35:34.746389 [info ] [MainThread]: 
[0m15:35:34.748386 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m15:35:34.751199 [debug] [MainThread]: Command end result
[0m15:35:34.782472 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:35:34.785596 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:35:34.804051 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m15:35:34.814393 [info ] [MainThread]: 
[0m15:35:34.817890 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:34.819067 [info ] [MainThread]: 
[0m15:35:34.820555 [error] [MainThread]: [31mFailure in model int_b3_ops (models/intermediate/int_b3_ops.sql)[0m
[0m15:35:34.822334 [error] [MainThread]:   Database Error in model int_b3_ops (models/intermediate/int_b3_ops.sql)
  column "order_date" does not exist
  LINE 49: WHERE to_date(order_date, 'DD-MM-YYYY') > (SELECT MAX(date_o...
                         ^
[0m15:35:34.836605 [info ] [MainThread]: 
[0m15:35:34.848063 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/intermediate/int_b3_ops.sql
[0m15:35:34.855942 [info ] [MainThread]: 
[0m15:35:34.859399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m15:35:34.865904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.519002, "process_in_blocks": "0", "process_kernel_time": 0.704997, "process_mem_max_rss": "122124", "process_out_blocks": "1768", "process_user_time": 4.058602}
[0m15:35:34.886551 [debug] [MainThread]: Command `dbt run` failed at 15:35:34.886278 after 2.54 seconds
[0m15:35:34.887715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61a1b6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc616063c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61651f550>]}
[0m15:35:34.888842 [debug] [MainThread]: Flushing usage events
[0m15:35:35.439042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:24.416823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5b53e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5b53e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5b4e5c50>]}


============================== 15:36:24.426310 | c7c75570-80bb-4587-b003-707cf05b1131 ==============================
[0m15:36:24.426310 [info ] [MainThread]: Running with dbt=1.10.1
[0m15:36:24.428060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'debug': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:36:24.768913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5b3a43d0>]}
[0m15:36:24.863431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5b414b10>]}
[0m15:36:24.866097 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:36:25.363670 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m15:36:25.563895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:25.564998 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/intermediate/int_b3_ops.sql
[0m15:36:25.962211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5b211d10>]}
[0m15:36:26.129729 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:36:26.138099 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:36:26.191254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b59911ed0>]}
[0m15:36:26.198953 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m15:36:26.202243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5a9173d0>]}
[0m15:36:26.205236 [info ] [MainThread]: 
[0m15:36:26.213841 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:36:26.216566 [info ] [MainThread]: 
[0m15:36:26.239301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:26.360687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m15:36:26.621851 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m15:36:26.622631 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m15:36:26.623219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:26.662383 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.039 seconds
[0m15:36:26.664764 [debug] [ThreadPool]: On list_foo: Close
[0m15:36:26.680939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m15:36:26.688111 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:36:26.688859 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m15:36:26.689659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:26.716902 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m15:36:26.718285 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m15:36:26.719624 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:36:26.736759 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.015 seconds
[0m15:36:26.739151 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m15:36:26.741473 [debug] [ThreadPool]: On list_foo_public: Close
[0m15:36:26.750521 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:26.751724 [debug] [MainThread]: On master: BEGIN
[0m15:36:26.753536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:26.784546 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m15:36:26.785998 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:26.787723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:36:26.812496 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m15:36:26.814451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5a138dd0>]}
[0m15:36:26.815519 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:26.817491 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:26.818262 [debug] [MainThread]: On master: BEGIN
[0m15:36:26.821060 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:36:26.822061 [debug] [MainThread]: On master: COMMIT
[0m15:36:26.822722 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:26.823344 [debug] [MainThread]: On master: COMMIT
[0m15:36:26.825159 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:36:26.826545 [debug] [MainThread]: On master: Close
[0m15:36:26.840904 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m15:36:26.842241 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m15:36:26.844829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m15:36:26.845954 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m15:36:26.862325 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m15:36:26.864375 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m15:36:26.995171 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m15:36:27.000337 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:36:27.001211 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m15:36:27.002221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:27.034287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m15:36:27.035090 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:36:27.038240 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m15:36:27.057892 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.014 seconds
[0m15:36:27.096887 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:36:27.098442 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m15:36:27.101591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:36:27.108687 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:36:27.109993 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m15:36:27.118504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:36:27.138053 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:36:27.139376 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:36:27.140781 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m15:36:27.144551 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:36:27.154959 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m15:36:27.167805 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m15:36:27.170095 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m15:36:27.175278 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:36:27.179721 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m15:36:27.183391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b58563a50>]}
[0m15:36:27.187656 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 4[0m in 0.34s]
[0m15:36:27.189585 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m15:36:27.192732 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m15:36:27.194362 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m15:36:27.198323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m15:36:27.199815 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m15:36:27.210637 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m15:36:27.222938 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m15:36:27.428630 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.430441 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp153627378828"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(date_op, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m15:36:27.440194 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:36:27.511734 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.072 seconds
[0m15:36:27.575575 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.576895 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m15:36:27.583746 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m15:36:27.585042 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.587878 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp153627378828'
        
      order by ordinal_position

  
[0m15:36:27.608777 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.020 seconds
[0m15:36:27.618348 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.620844 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:36:27.632370 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.010 seconds
[0m15:36:27.642769 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.644152 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m15:36:27.654159 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.004 seconds
[0m15:36:27.671828 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m15:36:27.673697 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.674492 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm_id", "asset", "quantity", "pu", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm_id", "asset", "quantity", "pu", "value"
        from "int_b3_ops__dbt_tmp153627378828"
    )


  
[0m15:36:27.676295 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m15:36:27.688525 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m15:36:27.689517 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m15:36:27.690287 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m15:36:27.692551 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:36:27.694202 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m15:36:27.703096 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7c75570-80bb-4587-b003-707cf05b1131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b585af410>]}
[0m15:36:27.706178 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mINSERT 0 0[0m in 0.50s]
[0m15:36:27.710511 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m15:36:27.726326 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:27.727817 [debug] [MainThread]: On master: BEGIN
[0m15:36:27.730218 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:27.768254 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m15:36:27.788605 [debug] [MainThread]: On master: COMMIT
[0m15:36:27.791755 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:27.794266 [debug] [MainThread]: On master: COMMIT
[0m15:36:27.798709 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:36:27.799663 [debug] [MainThread]: On master: Close
[0m15:36:27.813036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:27.814690 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m15:36:27.816629 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m15:36:27.819951 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m15:36:27.823912 [info ] [MainThread]: 
[0m15:36:27.836438 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m15:36:27.865587 [debug] [MainThread]: Command end result
[0m15:36:28.203437 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m15:36:28.206813 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m15:36:28.214716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m15:36:28.215542 [info ] [MainThread]: 
[0m15:36:28.218137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:28.220854 [info ] [MainThread]: 
[0m15:36:28.234570 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:36:28.240589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.899855, "process_in_blocks": "0", "process_kernel_time": 0.923922, "process_mem_max_rss": "125024", "process_out_blocks": "2608", "process_user_time": 4.487623}
[0m15:36:28.241804 [debug] [MainThread]: Command `dbt run` succeeded at 15:36:28.241569 after 3.90 seconds
[0m15:36:28.256933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b585507d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5f4b6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b5f4b6090>]}
[0m15:36:28.263585 [debug] [MainThread]: Flushing usage events
[0m15:36:28.945854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:36.991257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8545562210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8545371650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854531b450>]}


============================== 18:06:37.003808 | 009fdda7-195a-4d52-928b-3d0eead8f952 ==============================
[0m18:06:37.003808 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:06:37.006973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:37.332388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8546db9010>]}
[0m18:06:37.427428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8547c25650>]}
[0m18:06:37.429612 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:06:37.702576 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:06:38.087505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:06:38.088381 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_b3_ops.sql
[0m18:06:38.966851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8544b21150>]}
[0m18:06:39.120635 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:06:39.128248 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:06:39.220860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8543716110>]}
[0m18:06:39.222030 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m18:06:39.223144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8544b2f190>]}
[0m18:06:39.232270 [info ] [MainThread]: 
[0m18:06:39.233091 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:06:39.233786 [info ] [MainThread]: 
[0m18:06:39.234577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:06:39.307797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m18:06:39.584186 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m18:06:39.586811 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m18:06:39.588251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:39.604930 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m18:06:39.614079 [debug] [ThreadPool]: On list_foo: Close
[0m18:06:39.626594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m18:06:39.644606 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:06:39.648918 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m18:06:39.652998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:39.667997 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m18:06:39.668623 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:06:39.671345 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:06:39.692807 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m18:06:39.695603 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m18:06:39.696331 [debug] [ThreadPool]: On list_foo_public: Close
[0m18:06:39.716253 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.716844 [debug] [MainThread]: On master: BEGIN
[0m18:06:39.717434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:39.747867 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m18:06:39.748542 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.749565 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:06:39.766922 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m18:06:39.768437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8543b9dc90>]}
[0m18:06:39.769214 [debug] [MainThread]: On master: ROLLBACK
[0m18:06:39.770133 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.770619 [debug] [MainThread]: On master: BEGIN
[0m18:06:39.771469 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:06:39.772037 [debug] [MainThread]: On master: COMMIT
[0m18:06:39.772466 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:39.772839 [debug] [MainThread]: On master: COMMIT
[0m18:06:39.773569 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:06:39.774236 [debug] [MainThread]: On master: Close
[0m18:06:39.865656 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m18:06:39.866455 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public.stg_b3_ops ........................... [RUN]
[0m18:06:39.867827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m18:06:39.868352 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m18:06:39.882894 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m18:06:39.884153 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m18:06:40.120357 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:06:40.121400 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

    
  
    

  create temporary table "stg_b3_ops__dbt_tmp180640011676"
  
  
    as
  
  (
    


with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final

WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."stg_b3_ops" )

  );
  
  
[0m18:06:40.122355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:40.133434 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date_op" does not exist
LINE 33: WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) ...
                       ^

[0m18:06:40.152092 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m18:06:40.204455 [debug] [Thread-1 (]: Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  column "date_op" does not exist
  LINE 33: WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) ...
                         ^
[0m18:06:40.229313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '009fdda7-195a-4d52-928b-3d0eead8f952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854500cd90>]}
[0m18:06:40.233533 [error] [Thread-1 (]: 1 of 2 ERROR creating sql incremental model public.stg_b3_ops .................. [[31mERROR[0m in 0.34s]
[0m18:06:40.239409 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m18:06:40.243320 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  column "date_op" does not exist
  LINE 33: WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) ...
                         ^.
[0m18:06:40.245034 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m18:06:40.246504 [info ] [Thread-3 (]: 2 of 2 SKIP relation public.int_b3_ops ......................................... [[33mSKIP[0m]
[0m18:06:40.259476 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m18:06:40.270451 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:40.271191 [debug] [MainThread]: On master: BEGIN
[0m18:06:40.271615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:40.277715 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:06:40.278652 [debug] [MainThread]: On master: COMMIT
[0m18:06:40.279720 [debug] [MainThread]: Using postgres connection "master"
[0m18:06:40.286974 [debug] [MainThread]: On master: COMMIT
[0m18:06:40.289460 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:06:40.294108 [debug] [MainThread]: On master: Close
[0m18:06:40.297693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:40.308480 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m18:06:40.309332 [info ] [MainThread]: 
[0m18:06:40.310149 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m18:06:40.312388 [debug] [MainThread]: Command end result
[0m18:06:40.408992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:06:40.415137 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:06:40.425594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m18:06:40.426388 [info ] [MainThread]: 
[0m18:06:40.427102 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:06:40.428950 [info ] [MainThread]: 
[0m18:06:40.430255 [error] [MainThread]: [31mFailure in model stg_b3_ops (models/staging/stg_b3_ops.sql)[0m
[0m18:06:40.431117 [error] [MainThread]:   Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  column "date_op" does not exist
  LINE 33: WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) ...
                         ^
[0m18:06:40.431771 [info ] [MainThread]: 
[0m18:06:40.432832 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/staging/stg_b3_ops.sql
[0m18:06:40.433433 [info ] [MainThread]: 
[0m18:06:40.435610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m18:06:40.441030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.548874, "process_in_blocks": "60976", "process_kernel_time": 1.124982, "process_mem_max_rss": "127660", "process_out_blocks": "2568", "process_user_time": 2.89931}
[0m18:06:40.442940 [debug] [MainThread]: Command `dbt run` failed at 18:06:40.442808 after 3.55 seconds
[0m18:06:40.443428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85451963d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854935a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8545562990>]}
[0m18:06:40.449931 [debug] [MainThread]: Flushing usage events
[0m18:06:42.413300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:28.815707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd6bb6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd6deea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd6a19fd0>]}


============================== 18:07:28.819775 | 2e723099-8a45-4e7a-b76d-c46bb6cfa152 ==============================
[0m18:07:28.819775 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:07:28.820530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:07:28.974796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd8581190>]}
[0m18:07:29.032495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd9439c10>]}
[0m18:07:29.033623 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:07:29.097066 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:07:29.186387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:29.187175 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_b3_ops.sql
[0m18:07:29.442991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd61061d0>]}
[0m18:07:29.506677 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:07:29.510219 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:07:29.523025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd4d16110>]}
[0m18:07:29.523885 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m18:07:29.524439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd5156290>]}
[0m18:07:29.526447 [info ] [MainThread]: 
[0m18:07:29.527119 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:07:29.527880 [info ] [MainThread]: 
[0m18:07:29.528607 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:07:29.552104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m18:07:29.584085 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m18:07:29.584626 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m18:07:29.584948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:29.592579 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m18:07:29.594314 [debug] [ThreadPool]: On list_foo: Close
[0m18:07:29.598586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m18:07:29.605155 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:07:29.605823 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m18:07:29.606193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:29.613768 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:07:29.614389 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:07:29.614896 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:07:29.618200 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m18:07:29.620343 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m18:07:29.621230 [debug] [ThreadPool]: On list_foo_public: Close
[0m18:07:29.628948 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:29.629486 [debug] [MainThread]: On master: BEGIN
[0m18:07:29.629999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:29.635542 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:07:29.636078 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:29.636513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:07:29.640745 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:07:29.642336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd55ad950>]}
[0m18:07:29.643022 [debug] [MainThread]: On master: ROLLBACK
[0m18:07:29.643640 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:29.644059 [debug] [MainThread]: On master: BEGIN
[0m18:07:29.644668 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:07:29.645088 [debug] [MainThread]: On master: COMMIT
[0m18:07:29.645455 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:29.646054 [debug] [MainThread]: On master: COMMIT
[0m18:07:29.646664 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:07:29.647103 [debug] [MainThread]: On master: Close
[0m18:07:29.654502 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m18:07:29.655144 [info ] [Thread-1 (]: 1 of 2 START sql incremental model public.stg_b3_ops ........................... [RUN]
[0m18:07:29.656309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m18:07:29.656703 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m18:07:29.671686 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m18:07:29.673050 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m18:07:29.734910 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:07:29.735538 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

    
  
    

  create temporary table "stg_b3_ops__dbt_tmp180729707898"
  
  
    as
  
  (
    


with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final

WHERE to_date("Data do Negócio", 'DD-MM-YYYY') > (SELECT MAX("Data do Negócio") from "foo"."public"."stg_b3_ops" )

  );
  
  
[0m18:07:29.735983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:29.747636 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in WHERE
LINE 33: ...o_date("Data do Negócio", 'DD-MM-YYYY') > (SELECT MAX("Data ...
                                                              ^

[0m18:07:29.749533 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m18:07:29.754681 [debug] [Thread-1 (]: Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  aggregate functions are not allowed in WHERE
  LINE 33: ...o_date("Data do Negócio", 'DD-MM-YYYY') > (SELECT MAX("Data ...
                                                                ^
[0m18:07:29.756440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e723099-8a45-4e7a-b76d-c46bb6cfa152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd3c3b5d0>]}
[0m18:07:29.757269 [error] [Thread-1 (]: 1 of 2 ERROR creating sql incremental model public.stg_b3_ops .................. [[31mERROR[0m in 0.10s]
[0m18:07:29.758430 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m18:07:29.759449 [debug] [Thread-7 (]: Marking all children of 'model.b3_new.stg_b3_ops' to be skipped because of status 'error'.  Reason: Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  aggregate functions are not allowed in WHERE
  LINE 33: ...o_date("Data do Negócio", 'DD-MM-YYYY') > (SELECT MAX("Data ...
                                                                ^.
[0m18:07:29.760854 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m18:07:29.761416 [info ] [Thread-3 (]: 2 of 2 SKIP relation public.int_b3_ops ......................................... [[33mSKIP[0m]
[0m18:07:29.762793 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m18:07:29.765578 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:29.766052 [debug] [MainThread]: On master: BEGIN
[0m18:07:29.766387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:29.772698 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:07:29.773719 [debug] [MainThread]: On master: COMMIT
[0m18:07:29.774582 [debug] [MainThread]: Using postgres connection "master"
[0m18:07:29.775390 [debug] [MainThread]: On master: COMMIT
[0m18:07:29.776176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:07:29.776957 [debug] [MainThread]: On master: Close
[0m18:07:29.779400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:29.779910 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m18:07:29.780199 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m18:07:29.780682 [info ] [MainThread]: 
[0m18:07:29.781566 [info ] [MainThread]: Finished running 2 incremental models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:07:29.782567 [debug] [MainThread]: Command end result
[0m18:07:29.811760 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:07:29.814308 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:07:29.820833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m18:07:29.821732 [info ] [MainThread]: 
[0m18:07:29.822296 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:07:29.822871 [info ] [MainThread]: 
[0m18:07:29.823469 [error] [MainThread]: [31mFailure in model stg_b3_ops (models/staging/stg_b3_ops.sql)[0m
[0m18:07:29.824254 [error] [MainThread]:   Database Error in model stg_b3_ops (models/staging/stg_b3_ops.sql)
  aggregate functions are not allowed in WHERE
  LINE 33: ...o_date("Data do Negócio", 'DD-MM-YYYY') > (SELECT MAX("Data ...
                                                                ^
[0m18:07:29.825058 [info ] [MainThread]: 
[0m18:07:29.826160 [info ] [MainThread]:   compiled code at target/compiled/b3_new/models/staging/stg_b3_ops.sql
[0m18:07:29.827039 [info ] [MainThread]: 
[0m18:07:29.827952 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m18:07:29.829513 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0656399, "process_in_blocks": "0", "process_kernel_time": 0.2541, "process_mem_max_rss": "124576", "process_out_blocks": "2576", "process_user_time": 2.032806}
[0m18:07:29.830402 [debug] [MainThread]: Command `dbt run` failed at 18:07:29.830221 after 1.07 seconds
[0m18:07:29.830957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd7882610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd6a1af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cd6a19fd0>]}
[0m18:07:29.831410 [debug] [MainThread]: Flushing usage events
[0m18:07:30.515277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:06.435705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c239a17d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c239fa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c239fbf90>]}


============================== 18:08:06.439019 | 8c71ad4f-ef41-4f01-a3b6-03afd8904435 ==============================
[0m18:08:06.439019 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:08:06.439839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:06.600609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c232db910>]}
[0m18:08:06.658276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c2624cf90>]}
[0m18:08:06.659329 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:08:06.726161 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:08:06.815257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:08:06.816055 [debug] [MainThread]: Partial parsing: updated file: b3_new://models/staging/stg_b3_ops.sql
[0m18:08:07.067579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c223fd690>]}
[0m18:08:07.132789 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:08:07.135978 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:08:07.151540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c21b30d10>]}
[0m18:08:07.152488 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m18:08:07.153062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c247577d0>]}
[0m18:08:07.155317 [info ] [MainThread]: 
[0m18:08:07.156237 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:08:07.156829 [info ] [MainThread]: 
[0m18:08:07.158154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:08:07.163915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m18:08:07.211804 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m18:08:07.212435 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m18:08:07.212872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:07.220526 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m18:08:07.222024 [debug] [ThreadPool]: On list_foo: Close
[0m18:08:07.226538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo_public'
[0m18:08:07.232357 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:08:07.232898 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m18:08:07.233422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:07.238841 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:08:07.239363 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:08:07.239694 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:08:07.242676 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m18:08:07.244320 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m18:08:07.245468 [debug] [ThreadPool]: On list_foo_public: Close
[0m18:08:07.253105 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.253778 [debug] [MainThread]: On master: BEGIN
[0m18:08:07.254205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:07.259860 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:08:07.260396 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.260836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:08:07.265207 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:08:07.267080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c223fd510>]}
[0m18:08:07.267737 [debug] [MainThread]: On master: ROLLBACK
[0m18:08:07.268815 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.269907 [debug] [MainThread]: On master: BEGIN
[0m18:08:07.270993 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:08:07.271575 [debug] [MainThread]: On master: COMMIT
[0m18:08:07.272045 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.272518 [debug] [MainThread]: On master: COMMIT
[0m18:08:07.273619 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:08:07.274967 [debug] [MainThread]: On master: Close
[0m18:08:07.280172 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m18:08:07.280983 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m18:08:07.282545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m18:08:07.283288 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m18:08:07.294319 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m18:08:07.295971 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m18:08:07.351517 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m18:08:07.352819 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:08:07.353460 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m18:08:07.353950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:07.361067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:08:07.362348 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:08:07.362937 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m18:08:07.382808 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.019 seconds
[0m18:08:07.392339 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:08:07.392894 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m18:08:07.394168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:08:07.398221 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:08:07.398735 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m18:08:07.399548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:08:07.414000 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m18:08:07.414568 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:08:07.414980 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m18:08:07.416695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:07.425416 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m18:08:07.431574 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:08:07.432123 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m18:08:07.435761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:08:07.438424 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m18:08:07.442239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c21f644d0>]}
[0m18:08:07.443104 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 6[0m in 0.16s]
[0m18:08:07.443909 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m18:08:07.445233 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m18:08:07.446174 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m18:08:07.446998 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m18:08:07.447515 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m18:08:07.468550 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m18:08:07.469878 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m18:08:07.508224 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.509273 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp180807501779"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(date_op, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m18:08:07.510043 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:08:07.522831 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.013 seconds
[0m18:08:07.535560 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.536190 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m18:08:07.537753 [debug] [Thread-3 (]: SQL status: BEGIN in 0.001 seconds
[0m18:08:07.538487 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.538848 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp180807501779'
        
      order by ordinal_position

  
[0m18:08:07.553532 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.014 seconds
[0m18:08:07.559383 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.559946 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:07.566721 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:08:07.573802 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.574401 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:08:07.577822 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m18:08:07.590352 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m18:08:07.591778 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.592392 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm_id", "asset", "quantity", "pu", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm_id", "asset", "quantity", "pu", "value"
        from "int_b3_ops__dbt_tmp180807501779"
    )


  
[0m18:08:07.593778 [debug] [Thread-3 (]: SQL status: INSERT 0 2 in 0.001 seconds
[0m18:08:07.596629 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m18:08:07.597468 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:08:07.597975 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m18:08:07.599451 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:08:07.600527 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m18:08:07.604439 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c71ad4f-ef41-4f01-a3b6-03afd8904435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c205a6210>]}
[0m18:08:07.605430 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mINSERT 0 2[0m in 0.16s]
[0m18:08:07.606294 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m18:08:07.608992 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.609624 [debug] [MainThread]: On master: BEGIN
[0m18:08:07.610129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:07.617490 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:08:07.618093 [debug] [MainThread]: On master: COMMIT
[0m18:08:07.618756 [debug] [MainThread]: Using postgres connection "master"
[0m18:08:07.619454 [debug] [MainThread]: On master: COMMIT
[0m18:08:07.620066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:08:07.620512 [debug] [MainThread]: On master: Close
[0m18:08:07.622498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:07.623056 [debug] [MainThread]: Connection 'list_foo' was properly closed.
[0m18:08:07.623396 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m18:08:07.623781 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m18:08:07.624147 [info ] [MainThread]: 
[0m18:08:07.624800 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m18:08:07.632541 [debug] [MainThread]: Command end result
[0m18:08:07.750672 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:08:07.753346 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:08:07.759624 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m18:08:07.760356 [info ] [MainThread]: 
[0m18:08:07.760894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:07.761706 [info ] [MainThread]: 
[0m18:08:07.763300 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:08:07.765541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3836812, "process_in_blocks": "240", "process_kernel_time": 0.319311, "process_mem_max_rss": "127140", "process_out_blocks": "2616", "process_user_time": 2.192343}
[0m18:08:07.772798 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:07.772490 after 1.39 seconds
[0m18:08:07.773612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c279ba3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c279ba210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c279ba390>]}
[0m18:08:07.774201 [debug] [MainThread]: Flushing usage events
[0m18:08:08.454716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:59.229162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456de17ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456ebc7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456dc8a750>]}


============================== 18:48:59.233380 | af52d3df-92ab-475a-902b-5a4279ed6874 ==============================
[0m18:48:59.233380 [info ] [MainThread]: Running with dbt=1.10.1
[0m18:48:59.234547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/syco/projects/InvestingR2D2', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/syco/projects/InvestingR2D2/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:59.460020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456d7c2a50>]}
[0m18:48:59.548403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45706c9710>]}
[0m18:48:59.549785 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:59.651811 [debug] [MainThread]: checksum: 2c026f85d539c10c69b093157526ce33d0bf5533489eafb07fe5172434ec7740, vars: {}, profile: , target: , version: 1.10.1
[0m18:48:59.761917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:59.762518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:59.806384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456e516610>]}
[0m18:48:59.892225 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:48:59.895872 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:48:59.914211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456c763bd0>]}
[0m18:48:59.915062 [info ] [MainThread]: Found 2 models, 1 source, 433 macros
[0m18:48:59.916133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456d756110>]}
[0m18:48:59.918929 [info ] [MainThread]: 
[0m18:48:59.919854 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:59.920524 [info ] [MainThread]: 
[0m18:48:59.922138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:59.929737 [debug] [ThreadPool]: Acquiring new postgres connection 'list_foo'
[0m18:49:00.040262 [debug] [ThreadPool]: Using postgres connection "list_foo"
[0m18:49:00.042220 [debug] [ThreadPool]: On list_foo: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo"} */

    select distinct nspname from pg_namespace
  
[0m18:49:00.043687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:00.051930 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m18:49:00.053728 [debug] [ThreadPool]: On list_foo: Close
[0m18:49:00.059461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_foo, now list_foo_public)
[0m18:49:00.067021 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:49:00.067553 [debug] [ThreadPool]: On list_foo_public: BEGIN
[0m18:49:00.067940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:00.074837 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:49:00.075434 [debug] [ThreadPool]: Using postgres connection "list_foo_public"
[0m18:49:00.076235 [debug] [ThreadPool]: On list_foo_public: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "list_foo_public"} */
select
      'foo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'foo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:49:00.080647 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m18:49:00.082872 [debug] [ThreadPool]: On list_foo_public: ROLLBACK
[0m18:49:00.084236 [debug] [ThreadPool]: On list_foo_public: Close
[0m18:49:00.090125 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:00.090756 [debug] [MainThread]: On master: BEGIN
[0m18:49:00.091218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:00.098626 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:49:00.099223 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:00.099745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:49:00.104748 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m18:49:00.107422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456c7dca10>]}
[0m18:49:00.108427 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:00.109903 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:00.110913 [debug] [MainThread]: On master: BEGIN
[0m18:49:00.112968 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:49:00.115087 [debug] [MainThread]: On master: COMMIT
[0m18:49:00.115764 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:00.116210 [debug] [MainThread]: On master: COMMIT
[0m18:49:00.117014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:49:00.118448 [debug] [MainThread]: On master: Close
[0m18:49:00.124795 [debug] [Thread-1 (]: Began running node model.b3_new.stg_b3_ops
[0m18:49:00.126080 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_b3_ops ................................. [RUN]
[0m18:49:00.127209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_foo_public, now model.b3_new.stg_b3_ops)
[0m18:49:00.127967 [debug] [Thread-1 (]: Began compiling node model.b3_new.stg_b3_ops
[0m18:49:00.140541 [debug] [Thread-1 (]: Writing injected SQL for node "model.b3_new.stg_b3_ops"
[0m18:49:00.142969 [debug] [Thread-1 (]: Began executing node model.b3_new.stg_b3_ops
[0m18:49:00.219646 [debug] [Thread-1 (]: Writing runtime sql for node "model.b3_new.stg_b3_ops"
[0m18:49:00.221943 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:49:00.222906 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: BEGIN
[0m18:49:00.223796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:00.232025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:49:00.232897 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:49:00.234015 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */

  
    

  create  table "foo"."public"."stg_b3_ops__dbt_tmp"
  
  
    as
  
  (
    with final as (
    SELECT * FROM "foo"."public"."b3_raw_ops"
)

SELECT 
"Data do Negócio" as date_op,
"id",
"Tipo de Movimentação" as movement,
"Mercado" as market,
"Prazo/Vencimento" as expire_date,
"Instituição" as brokerage_firm,
"Código de Negociação" as asset,
"Quantidade" as quantity, 
"Preço" as pu,
"Valor" as value 
FROM final
  );
  
[0m18:49:00.240759 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:49:00.252484 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:49:00.253547 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops" rename to "stg_b3_ops__dbt_backup"
[0m18:49:00.255669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:49:00.259938 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:49:00.260641 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
alter table "foo"."public"."stg_b3_ops__dbt_tmp" rename to "stg_b3_ops"
[0m18:49:00.262297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:49:00.283467 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m18:49:00.284091 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:49:00.284450 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: COMMIT
[0m18:49:00.286971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:49:00.294815 [debug] [Thread-1 (]: Applying DROP to: "foo"."public"."stg_b3_ops__dbt_backup"
[0m18:49:00.301816 [debug] [Thread-1 (]: Using postgres connection "model.b3_new.stg_b3_ops"
[0m18:49:00.302445 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.stg_b3_ops"} */
drop table if exists "foo"."public"."stg_b3_ops__dbt_backup" cascade
[0m18:49:00.305602 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:49:00.309242 [debug] [Thread-1 (]: On model.b3_new.stg_b3_ops: Close
[0m18:49:00.314111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f457058cf50>]}
[0m18:49:00.315607 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_b3_ops ............................ [[32mSELECT 6[0m in 0.18s]
[0m18:49:00.317346 [debug] [Thread-1 (]: Finished running node model.b3_new.stg_b3_ops
[0m18:49:00.319809 [debug] [Thread-3 (]: Began running node model.b3_new.int_b3_ops
[0m18:49:00.320616 [info ] [Thread-3 (]: 2 of 2 START sql incremental model public.int_b3_ops ........................... [RUN]
[0m18:49:00.322807 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.b3_new.int_b3_ops'
[0m18:49:00.323811 [debug] [Thread-3 (]: Began compiling node model.b3_new.int_b3_ops
[0m18:49:00.336723 [debug] [Thread-3 (]: Writing injected SQL for node "model.b3_new.int_b3_ops"
[0m18:49:00.338337 [debug] [Thread-3 (]: Began executing node model.b3_new.int_b3_ops
[0m18:49:00.393557 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.394534 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

    
  
    

  create temporary table "int_b3_ops__dbt_tmp184900385609"
  
  
    as
  
  (
    


WITH final as (
    SELECT *
    FROM 
    "foo"."public"."stg_b3_ops"
)

select
to_date(date_op, 'DD-MM-YYYY') as date_op,
id,
movement,
market,
to_date(
	case
		when expire_date = '-' then '31-12-2099'
		else expire_date
		end, 
	'DD-MM-YYYY') as date_expiration,
CASE 
	when brokerage_firm = 'XP INVESTIMENTOS CCTVM S/A'
	THEN 1
	WHEN brokerage_firm = 'C6 CORRETORA DE TITULOS E VALORES MOBILIARIOS LTDA'
	THEN 2
	END as brokerage_firm_id,
case
	when market = 'Mercado Fracionário'
	then SUBSTRING(asset, 1, length(asset)-1)
	else asset
	END	as asset,
quantity::numeric,
pu::numeric(6,2),
value::numeric(9,2)
from stg_b3_ops

WHERE to_date(date_op, 'DD-MM-YYYY') > (SELECT MAX(date_op) from "foo"."public"."int_b3_ops" )

  );
  
  
[0m18:49:00.395375 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:49:00.406980 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m18:49:00.422830 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.423565 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: BEGIN
[0m18:49:00.424583 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m18:49:00.425374 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.425988 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops__dbt_tmp184900385609'
        
      order by ordinal_position

  
[0m18:49:00.436432 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.010 seconds
[0m18:49:00.443528 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.444518 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:49:00.450401 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.005 seconds
[0m18:49:00.461187 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.462344 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "foo".INFORMATION_SCHEMA.columns
      where table_name = 'int_b3_ops'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:49:00.468753 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:49:00.490242 [debug] [Thread-3 (]: Writing runtime sql for node "model.b3_new.int_b3_ops"
[0m18:49:00.492480 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.493330 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: /* {"app": "dbt", "dbt_version": "1.10.1", "profile_name": "investment_wallet", "target_name": "local", "node_id": "model.b3_new.int_b3_ops"} */

      insert into "foo"."public"."int_b3_ops" ("date_op", "id", "movement", "market", "date_expiration", "brokerage_firm_id", "asset", "quantity", "pu", "value")
    (
        select "date_op", "id", "movement", "market", "date_expiration", "brokerage_firm_id", "asset", "quantity", "pu", "value"
        from "int_b3_ops__dbt_tmp184900385609"
    )


  
[0m18:49:00.495399 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m18:49:00.497157 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m18:49:00.498233 [debug] [Thread-3 (]: Using postgres connection "model.b3_new.int_b3_ops"
[0m18:49:00.499240 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: COMMIT
[0m18:49:00.500888 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:49:00.502716 [debug] [Thread-3 (]: On model.b3_new.int_b3_ops: Close
[0m18:49:00.503767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af52d3df-92ab-475a-902b-5a4279ed6874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45686616d0>]}
[0m18:49:00.504908 [info ] [Thread-3 (]: 2 of 2 OK created sql incremental model public.int_b3_ops ...................... [[32mINSERT 0 0[0m in 0.18s]
[0m18:49:00.506655 [debug] [Thread-3 (]: Finished running node model.b3_new.int_b3_ops
[0m18:49:00.510533 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:00.511699 [debug] [MainThread]: On master: BEGIN
[0m18:49:00.512489 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:00.524565 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m18:49:00.525614 [debug] [MainThread]: On master: COMMIT
[0m18:49:00.526131 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:00.526635 [debug] [MainThread]: On master: COMMIT
[0m18:49:00.527401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:49:00.528459 [debug] [MainThread]: On master: Close
[0m18:49:00.530917 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:00.532498 [debug] [MainThread]: Connection 'model.b3_new.stg_b3_ops' was properly closed.
[0m18:49:00.538115 [debug] [MainThread]: Connection 'model.b3_new.int_b3_ops' was properly closed.
[0m18:49:00.539757 [info ] [MainThread]: 
[0m18:49:00.542891 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m18:49:00.545715 [debug] [MainThread]: Command end result
[0m18:49:00.581909 [debug] [MainThread]: Wrote artifact WritableManifest to /home/syco/projects/InvestingR2D2/target/manifest.json
[0m18:49:00.593107 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/syco/projects/InvestingR2D2/target/semantic_manifest.json
[0m18:49:00.612468 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/syco/projects/InvestingR2D2/target/run_results.json
[0m18:49:00.613054 [info ] [MainThread]: 
[0m18:49:00.615340 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:00.616689 [info ] [MainThread]: 
[0m18:49:00.617645 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:49:00.619773 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4596945, "process_in_blocks": "0", "process_kernel_time": 0.359768, "process_mem_max_rss": "123220", "process_out_blocks": "1776", "process_user_time": 2.690272}
[0m18:49:00.621660 [debug] [MainThread]: Command `dbt run` succeeded at 18:49:00.621145 after 1.46 seconds
[0m18:49:00.622560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456e147790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4571dba150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4571db9890>]}
[0m18:49:00.623214 [debug] [MainThread]: Flushing usage events
[0m18:49:01.341077 [debug] [MainThread]: An error was encountered while trying to flush usage events
